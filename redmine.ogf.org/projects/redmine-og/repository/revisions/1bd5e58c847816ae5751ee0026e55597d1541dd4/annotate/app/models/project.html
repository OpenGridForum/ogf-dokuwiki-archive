<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/annotate/app/models/project.rb by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 13 Oct 2022 17:42:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>/app/models/project.rb - Annotate - Redmine - Open Grid Forum</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token"/>
<meta name="csrf-token" content="rsvo5Uvs/OHqzq9AZjxgQ/1mtk/oY58g0kQJMlDTftw="/>
<link rel='shortcut icon' href='https://redmine.ogf.org/favicon.ico?1425381960' />
<link href="https://redmine.ogf.org/themes/ogf_redmine/stylesheets/application.css?1425381960" media="all" rel="stylesheet" type="text/css" />

<script src="https://redmine.ogf.org/javascripts/prototype.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/effects.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/dragdrop.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/controls.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/application.js?1425381960" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
Event.observe(window, 'load', function(){ new WarnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<!--[if IE 6]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1425381960);}
    </style>
<![endif]-->
<link href="https://redmine.ogf.org/plugin_assets/extended_fields/stylesheets/extended_fields.css?1425381960" media="screen" rel="stylesheet" type="text/css" /> <link href="https://redmine.ogf.org/plugin_assets/wiking/stylesheets/wiking.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
<!-- page specific tags -->

  <script src="https://redmine.ogf.org/javascripts/repository_navigation.js?1425381960" type="text/javascript"></script>

<link href="https://redmine.ogf.org/stylesheets/scm.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="theme-Ogf redmine controller-repositories action-annotate">
<div id="wrapper">
<div id="wrapper2">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="https://redmine.ogf.org/login" class="login">Login</a></li>
<li><a href="https://redmine.ogf.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="https://redmine.ogf.org/" class="home">Home</a></li>
<li><a href="https://redmine.ogf.org/projects" class="projects">Projects</a></li>
<li><a href="http://www.redmine.org/guide" class="help">Help</a></li></ul></div>

<div id="header">
    
    <div id="quick-search">
        <form action="https://redmine.ogf.org/search/index/redmine-og" method="get">
        <input name="changesets" type="hidden" value="1" />
        <label for='q'>
          <a href="https://redmine.ogf.org/search/index/redmine-og" accesskey="4">Search</a>:
        </label>
        <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
        </form>
        
    </div>
    

    <h1><a href="https://redmine.ogf.org/projects/operations?jump=repository" class="root">Operations</a> » <a href="https://redmine.ogf.org/projects/it-og?jump=repository" class="ancestor">IT</a> » Redmine</h1>

    
    <div id="main-menu">
        <ul><li><a href="https://redmine.ogf.org/projects/redmine-og" class="overview">Overview</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/issues" class="issues">Issues</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/issues/calendar" class="calendar">Calendar</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/news" class="news">News</a></li>
<li><a href="https://redmine.ogf.org/dmsf/redmine-og" class="dmsf">Documents</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/wiki" class="wiki">Wiki</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/files" class="files">Files</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/repository" class="repository selected">Repository</a></li></ul>
    </div>
    
</div>

<div class="nosidebar" id="main">
    <div id="sidebar">
        
        
  
  


    </div>

    <div id="content">
        
        

<div class="contextual">
  

<a href="https://redmine.ogf.org/projects/redmine-og/repository/statistics" class="icon icon-stats">Statistics</a>

<form action="https://redmine.ogf.org/projects/redmine-og/repository/annotate/app/models/project.rb?rev=" id="revision_selector" method="get">  <!-- Branches Dropdown -->
      | Branch: 
    <select id="branch" name="branch"><option value=""></option>
<option value="1.3-stable">1.3-stable</option>
<option value="devel">devel</option>
<option value="master">master</option></select>
  
  
  | Revision: 
  <input id="rev" name="rev" size="8" type="text" value="1bd5e58c847816ae5751ee0026e55597d1541dd4" />
</form>
</div>

<h2><a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/show">root</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/show/app">app</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/show/app/models">models</a>


    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/changes/app/models/project.rb">project.rb</a>


@ 1bd5e58c

</h2>

<p>

<p>
<a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/changes/app/models/project.rb">History</a> |

    <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/entry/app/models/project.rb">View</a> |


    Annotate |

<a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/raw/app/models/project.rb">Download</a>
(32.3 kB)
</p>


</p>



<div class="autoscroll">
<table class="filecontent annotate syntaxhl">
  <tbody>
    
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L1"><a href="#L1">1</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># Redmine - project management software</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L2"><a href="#L2">2</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># Copyright (C) 2006-2011  Jean-Philippe Lang</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L3"><a href="#L3">3</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L4"><a href="#L4">4</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># This program is free software; you can redistribute it and/or</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L5"><a href="#L5">5</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># modify it under the terms of the GNU General Public License</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L6"><a href="#L6">6</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># as published by the Free Software Foundation; either version 2</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L7"><a href="#L7">7</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># of the License, or (at your option) any later version.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L8"><a href="#L8">8</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre><span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L9"><a href="#L9">9</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># This program is distributed in the hope that it will be useful,</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L10"><a href="#L10">10</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L11"><a href="#L11">11</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L12"><a href="#L12">12</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># GNU General Public License for more details.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L13"><a href="#L13">13</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre><span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L14"><a href="#L14">14</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># You should have received a copy of the GNU General Public License</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L15"><a href="#L15">15</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># along with this program; if not, write to the Free Software</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L16"><a href="#L16">16</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="comment"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L17"><a href="#L17">17</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L18"><a href="#L18">18</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="keyword">class</span> <span class="class">Project</span> &lt; <span class="constant">ActiveRecord</span>::<span class="constant">Base</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L19"><a href="#L19">19</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  include <span class="constant">Redmine</span>::<span class="constant">SafeAttributes</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L20"><a href="#L20">20</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L21"><a href="#L21">21</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Project statuses</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L22"><a href="#L22">22</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="constant">STATUS_ACTIVE</span>     = <span class="integer">1</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L23"><a href="#L23">23</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="constant">STATUS_ARCHIVED</span>   = <span class="integer">9</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L24"><a href="#L24">24</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L25"><a href="#L25">25</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8ef06826c31b3042f6720c249199504a49e08c01" title="Revision 8ef06826">8ef06826</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Maximum length for project identifiers</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L26"><a href="#L26">26</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8ef06826c31b3042f6720c249199504a49e08c01" title="Revision 8ef06826">8ef06826</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="constant">IDENTIFIER_MAX_LENGTH</span> = <span class="integer">100</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L27"><a href="#L27">27</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L28"><a href="#L28">28</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Specific overidden Activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L29"><a href="#L29">29</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d8c5549168f3fe7e9f2b1633e70928178665773a" title="Revision d8c55491">d8c55491</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:time_entry_activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L30"><a href="#L30">30</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d73fb1fab89634b5e6d5aaf0ac012333c3db6c42" title="Revision d73fb1fa">d73fb1fa</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:members</span>, <span class="symbol">:include</span> =&gt; [<span class="symbol">:user</span>, <span class="symbol">:roles</span>], <span class="symbol">:conditions</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">User</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.type='User' AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">User</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status=</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">User</span>::<span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L31"><a href="#L31">31</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:memberships</span>, <span class="symbol">:class_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">Member</span><span class="delimiter">'</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L32"><a href="#L32">32</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:member_principals</span>, <span class="symbol">:class_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">Member</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L33"><a href="#L33">33</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7707457145442d6177ce57c956dbe09af65df1b4" title="Revision 77074571">77074571</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                               <span class="symbol">:include</span> =&gt; <span class="symbol">:principal</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L34"><a href="#L34">34</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7707457145442d6177ce57c956dbe09af65df1b4" title="Revision 77074571">77074571</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                               <span class="symbol">:conditions</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Principal</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.type='Group' OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Principal</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.type='User' AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Principal</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status=</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">User</span>::<span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="content">)</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L35"><a href="#L35">35</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:users</span>, <span class="symbol">:through</span> =&gt; <span class="symbol">:members</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L36"><a href="#L36">36</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7707457145442d6177ce57c956dbe09af65df1b4" title="Revision 77074571">77074571</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:principals</span>, <span class="symbol">:through</span> =&gt; <span class="symbol">:member_principals</span>, <span class="symbol">:source</span> =&gt; <span class="symbol">:principal</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L37"><a href="#L37">37</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L38"><a href="#L38">38</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:enabled_modules</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:delete_all</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L39"><a href="#L39">39</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8d91afc33e3b5e7ef491fb30fb5ccbda35a1d02d" title="Revision 8d91afc3">8d91afc3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_and_belongs_to_many <span class="symbol">:trackers</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Tracker</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.position</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L40"><a href="#L40">40</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e6f58e4dcc2f7552109da139857a19b81c6f1fe1" title="Revision e6f58e4d">e6f58e4d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:issues</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Issue</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.created_on DESC</span><span class="delimiter">&quot;</span></span>, <span class="symbol">:include</span> =&gt; [<span class="symbol">:status</span>, <span class="symbol">:tracker</span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L41"><a href="#L41">41</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/2f0edb0b61aa6f52d9bf1cb9b16e8561d132e46a" title="Revision 2f0edb0b">2f0edb0b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:issue_changes</span>, <span class="symbol">:through</span> =&gt; <span class="symbol">:issues</span>, <span class="symbol">:source</span> =&gt; <span class="symbol">:journals</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L42"><a href="#L42">42</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7eb3b186c4f23f17965efb713c24edd88788e6c8" title="Revision 7eb3b186">7eb3b186</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:versions</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.effective_date DESC, </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.name DESC</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L43"><a href="#L43">43</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8d54d9700746636849bd104f4d18db479492505e" title="Revision 8d54d970">8d54d970</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:time_entries</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:delete_all</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L44"><a href="#L44">44</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:queries</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:delete_all</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L45"><a href="#L45">45</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:documents</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L46"><a href="#L46">46</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0b3f2bc65004ab83c66e4239f8f912c940344daa" title="Revision 0b3f2bc6">0b3f2bc6</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:news</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>, <span class="symbol">:include</span> =&gt; <span class="symbol">:author</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L47"><a href="#L47">47</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e6f58e4dcc2f7552109da139857a19b81c6f1fe1" title="Revision e6f58e4d">e6f58e4d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:issue_categories</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:delete_all</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">IssueCategory</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L48"><a href="#L48">48</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80a5ad7ff344b9c5047a1990f6af19f97c4bd680" title="Revision 80a5ad7f">80a5ad7f</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:boards</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">position ASC</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L49"><a href="#L49">49</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4" title="Revision 1bd5e58c">1bd5e58c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_one <span class="symbol">:repository</span>, <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="content">is_default = ?</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">true</span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L50"><a href="#L50">50</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4" title="Revision 1bd5e58c">1bd5e58c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:repositories</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L51"><a href="#L51">51</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fdf842a4c458b9f40c233bda221ff241df8eb108" title="Revision fdf842a4">fdf842a4</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_many <span class="symbol">:changesets</span>, <span class="symbol">:through</span> =&gt; <span class="symbol">:repository</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L52"><a href="#L52">52</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  has_one <span class="symbol">:wiki</span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L53"><a href="#L53">53</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5944696b6d4307de0166ba74c514aae25779abb9" title="Revision 5944696b">5944696b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Custom field for the project issues</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L54"><a href="#L54">54</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  has_and_belongs_to_many <span class="symbol">:issue_custom_fields</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L55"><a href="#L55">55</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5944696b6d4307de0166ba74c514aae25779abb9" title="Revision 5944696b">5944696b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                          <span class="symbol">:class_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">IssueCustomField</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L56"><a href="#L56">56</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5944696b6d4307de0166ba74c514aae25779abb9" title="Revision 5944696b">5944696b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                          <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">CustomField</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.position</span><span class="delimiter">&quot;</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L57"><a href="#L57">57</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5944696b6d4307de0166ba74c514aae25779abb9" title="Revision 5944696b">5944696b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                          <span class="symbol">:join_table</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>table_name_prefix<span class="inline-delimiter">}</span></span><span class="content">custom_fields_projects</span><span class="inline"><span class="inline-delimiter">#{</span>table_name_suffix<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L58"><a href="#L58">58</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5944696b6d4307de0166ba74c514aae25779abb9" title="Revision 5944696b">5944696b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                          <span class="symbol">:association_foreign_key</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">custom_field_id</span><span class="delimiter">'</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L59"><a href="#L59">59</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L60"><a href="#L60">60</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/50cb77cfbb09750dad7809f46914b8f81dc0c13a" title="Revision 50cb77cf">50cb77cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  acts_as_nested_set <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="symbol">:dependent</span> =&gt; <span class="symbol">:destroy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L61"><a href="#L61">61</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/66ff4cb7de55328ee6d9ea08d26caeb3d0a19d80" title="Revision 66ff4cb7">66ff4cb7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  acts_as_attachable <span class="symbol">:view_permission</span> =&gt; <span class="symbol">:view_files</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L62"><a href="#L62">62</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/66ff4cb7de55328ee6d9ea08d26caeb3d0a19d80" title="Revision 66ff4cb7">66ff4cb7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                     <span class="symbol">:delete_permission</span> =&gt; <span class="symbol">:manage_files</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L63"><a href="#L63">63</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a96421019f3a813b93798e4ec8099edd09f8a661" title="Revision a9642101">a9642101</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L64"><a href="#L64">64</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce6cf66f6c3af26383cd25ed012d908be4b40bae" title="Revision ce6cf66f">ce6cf66f</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  acts_as_customizable
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L65"><a href="#L65">65</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b2dee55e72f48c67235e3eb0f407aab96cf68421" title="Revision b2dee55e">b2dee55e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  acts_as_searchable <span class="symbol">:columns</span> =&gt; [<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">identifier</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">description</span><span class="delimiter">'</span></span>], <span class="symbol">:project_key</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>, <span class="symbol">:permission</span> =&gt; <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L66"><a href="#L66">66</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a96421019f3a813b93798e4ec8099edd09f8a661" title="Revision a9642101">a9642101</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  acts_as_event <span class="symbol">:title</span> =&gt; <span class="constant">Proc</span>.new {|o| <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>l(<span class="symbol">:label_project</span>)<span class="inline-delimiter">}</span></span><span class="content">: </span><span class="inline"><span class="inline-delimiter">#{</span>o.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>},
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L67"><a href="#L67">67</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/46ecc488a9971a998973dfe52998135ad9dd2ff7" title="Revision 46ecc488">46ecc488</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                <span class="symbol">:url</span> =&gt; <span class="constant">Proc</span>.new {|o| {<span class="symbol">:controller</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">projects</span><span class="delimiter">'</span></span>, <span class="symbol">:action</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">show</span><span class="delimiter">'</span></span>, <span class="symbol">:id</span> =&gt; o}},
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L68"><a href="#L68">68</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b5444b5fcd84008a67a5486e373813dec1a371c8" title="Revision b5444b5f">b5444b5f</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                <span class="symbol">:author</span> =&gt; <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L69"><a href="#L69">69</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a96421019f3a813b93798e4ec8099edd09f8a661" title="Revision a9642101">a9642101</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L70"><a href="#L70">70</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9fb770ba503b3dfe1fe48794e1b7042c5e26d8d7" title="Revision 9fb770ba">9fb770ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  attr_protected <span class="symbol">:status</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L71"><a href="#L71">71</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L72"><a href="#L72">72</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_presence_of <span class="symbol">:name</span>, <span class="symbol">:identifier</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L73"><a href="#L73">73</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa3d71bed9520de811998a83c33b6ce3b9ffed00" title="Revision fa3d71be">fa3d71be</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_uniqueness_of <span class="symbol">:identifier</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L74"><a href="#L74">74</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_associated <span class="symbol">:repository</span>, <span class="symbol">:wiki</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L75"><a href="#L75">75</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8ef06826c31b3042f6720c249199504a49e08c01" title="Revision 8ef06826">8ef06826</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_length_of <span class="symbol">:name</span>, <span class="symbol">:maximum</span> =&gt; <span class="integer">255</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L76"><a href="#L76">76</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dfcc8e1492dc4a30b1cddf600aed105f3284528d" title="Revision dfcc8e14">dfcc8e14</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_length_of <span class="symbol">:homepage</span>, <span class="symbol">:maximum</span> =&gt; <span class="integer">255</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L77"><a href="#L77">77</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8ef06826c31b3042f6720c249199504a49e08c01" title="Revision 8ef06826">8ef06826</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_length_of <span class="symbol">:identifier</span>, <span class="symbol">:in</span> =&gt; <span class="integer">1</span>..<span class="constant">IDENTIFIER_MAX_LENGTH</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L78"><a href="#L78">78</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bd42b7cd9e69e85b3b983e6f51092b9374913520" title="Revision bd42b7cd">bd42b7cd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># donwcase letters, digits, dashes but not digits only</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L79"><a href="#L79">79</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bd42b7cd9e69e85b3b983e6f51092b9374913520" title="Revision bd42b7cd">bd42b7cd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_format_of <span class="symbol">:identifier</span>, <span class="symbol">:with</span> =&gt; <span class="regexp"><span class="delimiter">/</span><span class="content">^(?!</span><span class="char">\d</span><span class="content">+$)[a-z0-9</span><span class="char">\-</span><span class="content">]*$</span><span class="delimiter">/</span></span>, <span class="symbol">:if</span> =&gt; <span class="constant">Proc</span>.new { |p| p.identifier_changed? }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L80"><a href="#L80">80</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/36d8f3519246898c402683a1b1575660f52de260" title="Revision 36d8f351">36d8f351</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># reserved words</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L81"><a href="#L81">81</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/36d8f3519246898c402683a1b1575660f52de260" title="Revision 36d8f351">36d8f351</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  validates_exclusion_of <span class="symbol">:identifier</span>, <span class="symbol">:in</span> =&gt; <span class="string"><span class="delimiter">%w(</span><span class="content"> new </span><span class="delimiter">)</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L82"><a href="#L82">82</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/36d8f3519246898c402683a1b1575660f52de260" title="Revision 36d8f351">36d8f351</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L83"><a href="#L83">83</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/50cb77cfbb09750dad7809f46914b8f81dc0c13a" title="Revision 50cb77cf">50cb77cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  before_destroy <span class="symbol">:delete_all_members</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L84"><a href="#L84">84</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cc643ce932b2abdc56c4d1933c02806ca57ddefa" title="Revision cc643ce9">cc643ce9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L85"><a href="#L85">85</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cc643ce932b2abdc56c4d1933c02806ca57ddefa" title="Revision cc643ce9">cc643ce9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:has_module</span>, lambda { |mod| { <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id IN (SELECT em.project_id FROM </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">EnabledModule</span>.table_name<span class="inline-delimiter">}</span></span><span class="content"> em WHERE em.name=?)</span><span class="delimiter">&quot;</span></span>, mod.to_s] } }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L86"><a href="#L86">86</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:active</span>, { <span class="symbol">:conditions</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status = </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L87"><a href="#L87">87</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:status</span>, lambda {|arg| arg.blank? ? {} : {<span class="symbol">:conditions</span> =&gt; {<span class="symbol">:status</span> =&gt; arg.to_i}} }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L88"><a href="#L88">88</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d40756d61122ac31c16c41f1bb5ab4d0a9e507c6" title="Revision d40756d6">d40756d6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:all_public</span>, { <span class="symbol">:conditions</span> =&gt; { <span class="symbol">:is_public</span> =&gt; <span class="predefined-constant">true</span> } }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L89"><a href="#L89">89</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:visible</span>, lambda {|*args| {<span class="symbol">:conditions</span> =&gt; <span class="constant">Project</span>.visible_condition(args.shift || <span class="constant">User</span>.current, *args) }}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L90"><a href="#L90">90</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  named_scope <span class="symbol">:like</span>, lambda {|arg|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L91"><a href="#L91">91</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> arg.blank?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L92"><a href="#L92">92</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      {}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L93"><a href="#L93">93</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L94"><a href="#L94">94</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      pattern = <span class="string"><span class="delimiter">&quot;</span><span class="content">%</span><span class="inline"><span class="inline-delimiter">#{</span>arg.to_s.strip.downcase<span class="inline-delimiter">}</span></span><span class="content">%</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L95"><a href="#L95">95</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      {<span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="content">LOWER(identifier) LIKE :p OR LOWER(name) LIKE :p</span><span class="delimiter">&quot;</span></span>, {<span class="symbol">:p</span> =&gt; pattern}]}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L96"><a href="#L96">96</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L97"><a href="#L97">97</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ff0f141126e4f196deebf74e74e6eb16e8e72e5f" title="Revision ff0f1411">ff0f1411</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L98"><a href="#L98">98</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L99"><a href="#L99">99</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/062fbeae80477b8e5a95b2e5222f98b7e94c70b7" title="Revision 062fbeae">062fbeae</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">initialize</span>(attributes=<span class="predefined-constant">nil</span>, *args)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L100"><a href="#L100">100</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">super</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L101"><a href="#L101">101</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L102"><a href="#L102">102</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    initialized = (attributes || {}).stringify_keys
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L103"><a href="#L103">103</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> !initialized.key?(<span class="string"><span class="delimiter">'</span><span class="content">identifier</span><span class="delimiter">'</span></span>) &amp;&amp; <span class="constant">Setting</span>.sequential_project_identifiers?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L104"><a href="#L104">104</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.identifier = <span class="constant">Project</span>.next_identifier
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L105"><a href="#L105">105</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L106"><a href="#L106">106</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> !initialized.key?(<span class="string"><span class="delimiter">'</span><span class="content">is_public</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L107"><a href="#L107">107</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.is_public = <span class="constant">Setting</span>.default_projects_public?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L108"><a href="#L108">108</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L109"><a href="#L109">109</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> !initialized.key?(<span class="string"><span class="delimiter">'</span><span class="content">enabled_module_names</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L110"><a href="#L110">110</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.enabled_module_names = <span class="constant">Setting</span>.default_projects_modules
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L111"><a href="#L111">111</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L112"><a href="#L112">112</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> !initialized.key?(<span class="string"><span class="delimiter">'</span><span class="content">trackers</span><span class="delimiter">'</span></span>) &amp;&amp; !initialized.key?(<span class="string"><span class="delimiter">'</span><span class="content">tracker_ids</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L113"><a href="#L113">113</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.trackers = <span class="constant">Tracker</span>.all
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L114"><a href="#L114">114</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L115"><a href="#L115">115</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L116"><a href="#L116">116</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L117"><a href="#L117">117</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">identifier=</span>(identifier)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L118"><a href="#L118">118</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">super</span> <span class="keyword">unless</span> identifier_frozen?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L119"><a href="#L119">119</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L120"><a href="#L120">120</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L121"><a href="#L121">121</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">identifier_frozen?</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L122"><a href="#L122">122</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    errors[<span class="symbol">:identifier</span>].nil? &amp;&amp; !(new_record? || identifier.blank?)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L123"><a href="#L123">123</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4ff8386e3dfee800591e7f856a26ccc700149b02" title="Revision 4ff8386e">4ff8386e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L124"><a href="#L124">124</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa95501fe5e8c97de4f5960c4eeecfe70d4455f2" title="Revision fa95501f">fa95501f</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L125"><a href="#L125">125</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># returns latest created projects</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L126"><a href="#L126">126</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># non public projects will be returned only if user is a member of those</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L127"><a href="#L127">127</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">latest</span>(user=<span class="predefined-constant">nil</span>, count=<span class="integer">5</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L128"><a href="#L128">128</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    visible(user).find(<span class="symbol">:all</span>, <span class="symbol">:limit</span> =&gt; count, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on DESC</span><span class="delimiter">&quot;</span></span>)        
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L129"><a href="#L129">129</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>        
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L130"><a href="#L130">130</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L131"><a href="#L131">131</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/3c2ebd7aa2bd4663b0c4a4ab06906cd1554ed095" title="Revision 3c2ebd7a">3c2ebd7a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns true if the project is visible to +user+ or to the current user.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L132"><a href="#L132">132</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/3c2ebd7aa2bd4663b0c4a4ab06906cd1554ed095" title="Revision 3c2ebd7a">3c2ebd7a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">visible?</span>(user=<span class="constant">User</span>.current)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L133"><a href="#L133">133</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/3c2ebd7aa2bd4663b0c4a4ab06906cd1554ed095" title="Revision 3c2ebd7a">3c2ebd7a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    user.allowed_to?(<span class="symbol">:view_project</span>, <span class="predefined-constant">self</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L134"><a href="#L134">134</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/3c2ebd7aa2bd4663b0c4a4ab06906cd1554ed095" title="Revision 3c2ebd7a">3c2ebd7a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L135"><a href="#L135">135</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L136"><a href="#L136">136</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a SQL conditions string used to find all projects visible by the specified user.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L137"><a href="#L137">137</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L138"><a href="#L138">138</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Examples:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L139"><a href="#L139">139</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   Project.visible_condition(admin)        =&gt; &quot;projects.status = 1&quot;</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L140"><a href="#L140">140</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   Project.visible_condition(normal_user)  =&gt; &quot;((projects.status = 1) AND (projects.is_public = 1 OR projects.id IN (1,3,4)))&quot;</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L141"><a href="#L141">141</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   Project.visible_condition(anonymous)    =&gt; &quot;((projects.status = 1) AND (projects.is_public = 1))&quot;</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L142"><a href="#L142">142</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">visible_condition</span>(user, options={})
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L143"><a href="#L143">143</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    allowed_to_condition(user, <span class="symbol">:view_project</span>, options)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L144"><a href="#L144">144</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L145"><a href="#L145">145</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L146"><a href="#L146">146</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a SQL conditions string used to find all projects for which +user+ has the given +permission+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L147"><a href="#L147">147</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L148"><a href="#L148">148</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Valid options:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L149"><a href="#L149">149</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * :project =&gt; limit the condition to project</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L150"><a href="#L150">150</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * :with_subprojects =&gt; limit the condition to project and its subprojects</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L151"><a href="#L151">151</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/405fc07e90730c550f1e690a446eda872fd8732d" title="Revision 405fc07e">405fc07e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * :member =&gt; limit the condition to the user projects</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L152"><a href="#L152">152</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">allowed_to_condition</span>(user, permission, options={})
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L153"><a href="#L153">153</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    base_statement = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status=</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>::<span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L154"><a href="#L154">154</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/394fc9c10945e6890bad1e5627a7e78a33c3612b" title="Revision 394fc9c1">394fc9c1</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> perm = <span class="constant">Redmine</span>::<span class="constant">AccessControl</span>.permission(permission)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L155"><a href="#L155">155</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/394fc9c10945e6890bad1e5627a7e78a33c3612b" title="Revision 394fc9c1">394fc9c1</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">unless</span> perm.project_module.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L156"><a href="#L156">156</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/394fc9c10945e6890bad1e5627a7e78a33c3612b" title="Revision 394fc9c1">394fc9c1</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="comment"># If the permission belongs to a project module, make sure the module is enabled</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L157"><a href="#L157">157</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/041277235bd243dbf37c4b2a18ae467667395765" title="Revision 04127723">04127723</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        base_statement &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id IN (SELECT em.project_id FROM </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">EnabledModule</span>.table_name<span class="inline-delimiter">}</span></span><span class="content"> em WHERE em.name='</span><span class="inline"><span class="inline-delimiter">#{</span>perm.project_module<span class="inline-delimiter">}</span></span><span class="content">')</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L158"><a href="#L158">158</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/394fc9c10945e6890bad1e5627a7e78a33c3612b" title="Revision 394fc9c1">394fc9c1</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L159"><a href="#L159">159</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/394fc9c10945e6890bad1e5627a7e78a33c3612b" title="Revision 394fc9c1">394fc9c1</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L160"><a href="#L160">160</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> options[<span class="symbol">:project</span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L161"><a href="#L161">161</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project_statement = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id = </span><span class="inline"><span class="inline-delimiter">#{</span>options[<span class="symbol">:project</span>].id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L162"><a href="#L162">162</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project_statement &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt; </span><span class="inline"><span class="inline-delimiter">#{</span>options[<span class="symbol">:project</span>].lft<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt; </span><span class="inline"><span class="inline-delimiter">#{</span>options[<span class="symbol">:project</span>].rgt<span class="inline-delimiter">}</span></span><span class="content">)</span><span class="delimiter">&quot;</span></span> <span class="keyword">if</span> options[<span class="symbol">:with_subprojects</span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L163"><a href="#L163">163</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      base_statement = <span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="inline"><span class="inline-delimiter">#{</span>project_statement<span class="inline-delimiter">}</span></span><span class="content">) AND (</span><span class="inline"><span class="inline-delimiter">#{</span>base_statement<span class="inline-delimiter">}</span></span><span class="content">)</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L164"><a href="#L164">164</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/624723d0cef9bd8a9528745f4b75ee22f6b1ad2e" title="Revision 624723d0">624723d0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L165"><a href="#L165">165</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L166"><a href="#L166">166</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/200842ba5e753f342940d7df0f1cc342ae8485d4" title="Revision 200842ba">200842ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> user.admin?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L167"><a href="#L167">167</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      base_statement
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L168"><a href="#L168">168</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/200842ba5e753f342940d7df0f1cc342ae8485d4" title="Revision 200842ba">200842ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L169"><a href="#L169">169</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      statement_by_role = {}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L170"><a href="#L170">170</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">unless</span> options[<span class="symbol">:member</span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L171"><a href="#L171">171</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        role = user.logged? ? <span class="constant">Role</span>.non_member : <span class="constant">Role</span>.anonymous
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L172"><a href="#L172">172</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> role.allowed_to?(permission)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L173"><a href="#L173">173</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          statement_by_role[role] = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.is_public = </span><span class="inline"><span class="inline-delimiter">#{</span>connection.quoted_true<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L174"><a href="#L174">174</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L175"><a href="#L175">175</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L176"><a href="#L176">176</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/80e2eed70291d4ec81bc2e21e47a717bfaba1b1d" title="Revision 80e2eed7">80e2eed7</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> user.logged?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L177"><a href="#L177">177</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        user.projects_by_role.each <span class="keyword">do</span> |role, projects|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L178"><a href="#L178">178</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          <span class="keyword">if</span> role.allowed_to?(permission)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L179"><a href="#L179">179</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>            statement_by_role[role] = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id IN (</span><span class="inline"><span class="inline-delimiter">#{</span>projects.collect(&amp;<span class="symbol">:id</span>).join(<span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span>)<span class="inline-delimiter">}</span></span><span class="content">)</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L180"><a href="#L180">180</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L181"><a href="#L181">181</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L182"><a href="#L182">182</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/be4cc2f99e34316be4b8beb2e9040c5ea967a736" title="Revision be4cc2f9">be4cc2f9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L183"><a href="#L183">183</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> statement_by_role.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L184"><a href="#L184">184</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="string"><span class="delimiter">&quot;</span><span class="content">1=0</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L185"><a href="#L185">185</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L186"><a href="#L186">186</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> block_given?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L187"><a href="#L187">187</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          statement_by_role.each <span class="keyword">do</span> |role, statement|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L188"><a href="#L188">188</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>            <span class="keyword">if</span> s = <span class="keyword">yield</span>(role, user)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L189"><a href="#L189">189</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>              statement_by_role[role] = <span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="inline"><span class="inline-delimiter">#{</span>statement<span class="inline-delimiter">}</span></span><span class="content"> AND (</span><span class="inline"><span class="inline-delimiter">#{</span>s<span class="inline-delimiter">}</span></span><span class="content">))</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L190"><a href="#L190">190</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>            <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L191"><a href="#L191">191</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L192"><a href="#L192">192</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/aa0d01b3d9f5ae5634eda73e1becd75cc4668f3e" title="Revision aa0d01b3">aa0d01b3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L193"><a href="#L193">193</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="string"><span class="delimiter">&quot;</span><span class="content">((</span><span class="inline"><span class="inline-delimiter">#{</span>base_statement<span class="inline-delimiter">}</span></span><span class="content">) AND (</span><span class="inline"><span class="inline-delimiter">#{</span>statement_by_role.values.join(<span class="string"><span class="delimiter">'</span><span class="content"> OR </span><span class="delimiter">'</span></span>)<span class="inline-delimiter">}</span></span><span class="content">))</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L194"><a href="#L194">194</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f889932b6ce810707867e3c55cf9da438fe3518" title="Revision 5f889932">5f889932</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L195"><a href="#L195">195</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/200842ba5e753f342940d7df0f1cc342ae8485d4" title="Revision 200842ba">200842ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L196"><a href="#L196">196</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/200842ba5e753f342940d7df0f1cc342ae8485d4" title="Revision 200842ba">200842ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L197"><a href="#L197">197</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L198"><a href="#L198">198</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns the Systemwide and project specific activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L199"><a href="#L199">199</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">activities</span>(include_inactive=<span class="predefined-constant">false</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L200"><a href="#L200">200</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> include_inactive
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L201"><a href="#L201">201</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> all_activities
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L202"><a href="#L202">202</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L203"><a href="#L203">203</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> active_activities
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L204"><a href="#L204">204</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L205"><a href="#L205">205</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L206"><a href="#L206">206</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L207"><a href="#L207">207</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Will create a new Project specific Activity or update an existing one</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L208"><a href="#L208">208</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L209"><a href="#L209">209</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># This will raise a ActiveRecord::Rollback if the TimeEntryActivity</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L210"><a href="#L210">210</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># does not successfully save.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L211"><a href="#L211">211</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">update_or_create_time_entry_activity</span>(id, activity_hash)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L212"><a href="#L212">212</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> activity_hash.respond_to?(<span class="symbol">:has_key?</span>) &amp;&amp; activity_hash.has_key?(<span class="string"><span class="delimiter">'</span><span class="content">parent_id</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L213"><a href="#L213">213</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.create_time_entry_activity_if_needed(activity_hash)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L214"><a href="#L214">214</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L215"><a href="#L215">215</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      activity = project.time_entry_activities.find_by_id(id.to_i)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L216"><a href="#L216">216</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      activity.update_attributes(activity_hash) <span class="keyword">if</span> activity
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L217"><a href="#L217">217</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L218"><a href="#L218">218</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L219"><a href="#L219">219</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L220"><a href="#L220">220</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Create a new TimeEntryActivity if it overrides a system TimeEntryActivity</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L221"><a href="#L221">221</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L222"><a href="#L222">222</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># This will raise a ActiveRecord::Rollback if the TimeEntryActivity</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L223"><a href="#L223">223</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># does not successfully save.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L224"><a href="#L224">224</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">create_time_entry_activity_if_needed</span>(activity)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L225"><a href="#L225">225</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> activity[<span class="string"><span class="delimiter">'</span><span class="content">parent_id</span><span class="delimiter">'</span></span>]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L226"><a href="#L226">226</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L227"><a href="#L227">227</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      parent_activity = <span class="constant">TimeEntryActivity</span>.find(activity[<span class="string"><span class="delimiter">'</span><span class="content">parent_id</span><span class="delimiter">'</span></span>])
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L228"><a href="#L228">228</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      activity[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>] = parent_activity.name
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L229"><a href="#L229">229</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      activity[<span class="string"><span class="delimiter">'</span><span class="content">position</span><span class="delimiter">'</span></span>] = parent_activity.position
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L230"><a href="#L230">230</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L231"><a href="#L231">231</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> <span class="constant">Enumeration</span>.overridding_change?(activity, parent_activity)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L232"><a href="#L232">232</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        project_activity = <span class="predefined-constant">self</span>.time_entry_activities.create(activity)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L233"><a href="#L233">233</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L234"><a href="#L234">234</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> project_activity.new_record?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L235"><a href="#L235">235</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>          raise <span class="constant">ActiveRecord</span>::<span class="constant">Rollback</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Overridding TimeEntryActivity was not successfully saved</span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L236"><a href="#L236">236</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L237"><a href="#L237">237</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>          <span class="predefined-constant">self</span>.time_entries.update_all(<span class="string"><span class="delimiter">&quot;</span><span class="content">activity_id = </span><span class="inline"><span class="inline-delimiter">#{</span>project_activity.id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, [<span class="string"><span class="delimiter">&quot;</span><span class="content">activity_id = ?</span><span class="delimiter">&quot;</span></span>, parent_activity.id])
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L238"><a href="#L238">238</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/37d401ac58c36fc060ba795d1f3a3f36fa1dc4dc" title="Revision 37d401ac">37d401ac</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L239"><a href="#L239">239</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L240"><a href="#L240">240</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L241"><a href="#L241">241</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L242"><a href="#L242">242</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L243"><a href="#L243">243</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a :conditions SQL string that can be used to find the issues associated with this project.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L244"><a href="#L244">244</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L245"><a href="#L245">245</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Examples:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L246"><a href="#L246">246</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#   project.project_condition(true)  =&gt; &quot;(projects.id = 1 OR (projects.lft &gt; 1 AND projects.rgt &lt; 10))&quot;</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L247"><a href="#L247">247</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#   project.project_condition(false) =&gt; &quot;projects.id = 1&quot;</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L248"><a href="#L248">248</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/89602004098de22c59e668ad814969f5f12cd80b" title="Revision 89602004">89602004</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">project_condition</span>(with_subprojects)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L249"><a href="#L249">249</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/89602004098de22c59e668ad814969f5f12cd80b" title="Revision 89602004">89602004</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    cond = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id = </span><span class="inline"><span class="inline-delimiter">#{</span>id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L250"><a href="#L250">250</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    cond = <span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="inline"><span class="inline-delimiter">#{</span>cond<span class="inline-delimiter">}</span></span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt; </span><span class="inline"><span class="inline-delimiter">#{</span>lft<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt; </span><span class="inline"><span class="inline-delimiter">#{</span>rgt<span class="inline-delimiter">}</span></span><span class="content">))</span><span class="delimiter">&quot;</span></span> <span class="keyword">if</span> with_subprojects
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L251"><a href="#L251">251</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/89602004098de22c59e668ad814969f5f12cd80b" title="Revision 89602004">89602004</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    cond
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L252"><a href="#L252">252</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/89602004098de22c59e668ad814969f5f12cd80b" title="Revision 89602004">89602004</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L253"><a href="#L253">253</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L254"><a href="#L254">254</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">find</span>(*args)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L255"><a href="#L255">255</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> args.first &amp;&amp; args.first.is_a?(<span class="constant">String</span>) &amp;&amp; !args.first.match(<span class="regexp"><span class="delimiter">/</span><span class="content">^</span><span class="char">\d</span><span class="content">*$</span><span class="delimiter">/</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L256"><a href="#L256">256</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project = find_by_identifier(*args)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L257"><a href="#L257">257</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      raise <span class="constant">ActiveRecord</span>::<span class="constant">RecordNotFound</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Couldn't find Project with identifier=</span><span class="inline"><span class="inline-delimiter">#{</span>args.first<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span> <span class="keyword">if</span> project.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L258"><a href="#L258">258</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L259"><a href="#L259">259</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L260"><a href="#L260">260</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">super</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L261"><a href="#L261">261</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L262"><a href="#L262">262</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L263"><a href="#L263">263</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L264"><a href="#L264">264</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">to_param</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L265"><a href="#L265">265</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/39216f327c632fd9c2ed74294b0753e610235d68" title="Revision 39216f32">39216f32</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># id is used for projects with a numeric identifier (compatibility)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L266"><a href="#L266">266</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/39216f327c632fd9c2ed74294b0753e610235d68" title="Revision 39216f32">39216f32</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@to_param</span> ||= (identifier.to_s =~ <span class="regexp"><span class="delimiter">%r{</span><span class="content">^</span><span class="char">\d</span><span class="content">*$</span><span class="delimiter">}</span></span> ? id : identifier)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L267"><a href="#L267">267</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/524cd689cf8743c389aab6a767a09383891dc5c6" title="Revision 524cd689">524cd689</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L268"><a href="#L268">268</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L269"><a href="#L269">269</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">active?</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L270"><a href="#L270">270</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="predefined-constant">self</span>.status == <span class="constant">STATUS_ACTIVE</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L271"><a href="#L271">271</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L272"><a href="#L272">272</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L273"><a href="#L273">273</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/eea456ed84d159289bdc8826439923d365816fa8" title="Revision eea456ed">eea456ed</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">archived?</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L274"><a href="#L274">274</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/eea456ed84d159289bdc8826439923d365816fa8" title="Revision eea456ed">eea456ed</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="predefined-constant">self</span>.status == <span class="constant">STATUS_ARCHIVED</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L275"><a href="#L275">275</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/eea456ed84d159289bdc8826439923d365816fa8" title="Revision eea456ed">eea456ed</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L276"><a href="#L276">276</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L277"><a href="#L277">277</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Archives the project and its descendants</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L278"><a href="#L278">278</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">archive</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L279"><a href="#L279">279</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># Check that there is no issue of a non descendant project that is assigned</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L280"><a href="#L280">280</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># to one of the project or descendant versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L281"><a href="#L281">281</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    v_ids = self_and_descendants.collect {|p| p.version_ids}.flatten
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L282"><a href="#L282">282</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> v_ids.any? &amp;&amp; <span class="constant">Issue</span>.find(<span class="symbol">:first</span>, <span class="symbol">:include</span> =&gt; <span class="symbol">:project</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L283"><a href="#L283">283</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                        <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="content">(</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &lt; ? OR </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &gt; ?)</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L284"><a href="#L284">284</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                                        <span class="string"><span class="delimiter">&quot;</span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Issue</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.fixed_version_id IN (?)</span><span class="delimiter">&quot;</span></span>, lft, rgt, v_ids])
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L285"><a href="#L285">285</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="predefined-constant">false</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L286"><a href="#L286">286</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L287"><a href="#L287">287</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="constant">Project</span>.transaction <span class="keyword">do</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L288"><a href="#L288">288</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      archive!
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L289"><a href="#L289">289</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L290"><a href="#L290">290</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="predefined-constant">true</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L291"><a href="#L291">291</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L292"><a href="#L292">292</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L293"><a href="#L293">293</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Unarchives the project</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L294"><a href="#L294">294</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># All its ancestors must be active</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L295"><a href="#L295">295</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">unarchive</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L296"><a href="#L296">296</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">return</span> <span class="predefined-constant">false</span> <span class="keyword">if</span> ancestors.detect {|a| !a.active?}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L297"><a href="#L297">297</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    update_attribute <span class="symbol">:status</span>, <span class="constant">STATUS_ACTIVE</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L298"><a href="#L298">298</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/413247ee5b1643dff7923687711c77a5d90d41f5" title="Revision 413247ee">413247ee</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L299"><a href="#L299">299</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L300"><a href="#L300">300</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of projects the project can be moved to</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L301"><a href="#L301">301</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># by the current user</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L302"><a href="#L302">302</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">allowed_parents</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L303"><a href="#L303">303</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">return</span> <span class="instance-variable">@allowed_parents</span> <span class="keyword">if</span> <span class="instance-variable">@allowed_parents</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L304"><a href="#L304">304</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/62c83bdd2e1b06fcd873ba6d638c0bf59e390958" title="Revision 62c83bdd">62c83bdd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@allowed_parents</span> = <span class="constant">Project</span>.find(<span class="symbol">:all</span>, <span class="symbol">:conditions</span> =&gt; <span class="constant">Project</span>.allowed_to_condition(<span class="constant">User</span>.current, <span class="symbol">:add_subprojects</span>))
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L305"><a href="#L305">305</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/62c83bdd2e1b06fcd873ba6d638c0bf59e390958" title="Revision 62c83bdd">62c83bdd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@allowed_parents</span> = <span class="instance-variable">@allowed_parents</span> - self_and_descendants
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L306"><a href="#L306">306</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d02ddefff4f1d3800f7bdccb35c520a1155cccc5" title="Revision d02ddeff">d02ddeff</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> <span class="constant">User</span>.current.allowed_to?(<span class="symbol">:add_project</span>, <span class="predefined-constant">nil</span>, <span class="symbol">:global</span> =&gt; <span class="predefined-constant">true</span>) || (!new_record? &amp;&amp; parent.nil?)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L307"><a href="#L307">307</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/62c83bdd2e1b06fcd873ba6d638c0bf59e390958" title="Revision 62c83bdd">62c83bdd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="instance-variable">@allowed_parents</span> &lt;&lt; <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L308"><a href="#L308">308</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/62c83bdd2e1b06fcd873ba6d638c0bf59e390958" title="Revision 62c83bdd">62c83bdd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L309"><a href="#L309">309</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">unless</span> parent.nil? || <span class="instance-variable">@allowed_parents</span>.empty? || <span class="instance-variable">@allowed_parents</span>.include?(parent)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L310"><a href="#L310">310</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="instance-variable">@allowed_parents</span> &lt;&lt; parent
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L311"><a href="#L311">311</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L312"><a href="#L312">312</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@allowed_parents</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L313"><a href="#L313">313</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L314"><a href="#L314">314</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L315"><a href="#L315">315</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Sets the parent of the project with authorization check</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L316"><a href="#L316">316</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">set_allowed_parent!</span>(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L317"><a href="#L317">317</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">unless</span> p.nil? || p.is_a?(<span class="constant">Project</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L318"><a href="#L318">318</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> p.to_s.blank?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L319"><a href="#L319">319</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        p = <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L320"><a href="#L320">320</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L321"><a href="#L321">321</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        p = <span class="constant">Project</span>.find_by_id(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L322"><a href="#L322">322</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">return</span> <span class="predefined-constant">false</span> <span class="keyword">unless</span> p
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L323"><a href="#L323">323</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L324"><a href="#L324">324</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L325"><a href="#L325">325</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> p.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L326"><a href="#L326">326</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> !new_record? &amp;&amp; allowed_parents.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L327"><a href="#L327">327</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">return</span> <span class="predefined-constant">false</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L328"><a href="#L328">328</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L329"><a href="#L329">329</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">elsif</span> !allowed_parents.include?(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L330"><a href="#L330">330</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="predefined-constant">false</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L331"><a href="#L331">331</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L332"><a href="#L332">332</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/534ce51154c55078a611a098b225b6d0c9f8653f" title="Revision 534ce511">534ce511</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    set_parent!(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L333"><a href="#L333">333</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L334"><a href="#L334">334</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L335"><a href="#L335">335</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Sets the parent of the project</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L336"><a href="#L336">336</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Argument can be either a Project, a String, a Fixnum or nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L337"><a href="#L337">337</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">set_parent!</span>(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L338"><a href="#L338">338</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">unless</span> p.nil? || p.is_a?(<span class="constant">Project</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L339"><a href="#L339">339</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> p.to_s.blank?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L340"><a href="#L340">340</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        p = <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L341"><a href="#L341">341</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L342"><a href="#L342">342</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        p = <span class="constant">Project</span>.find_by_id(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L343"><a href="#L343">343</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">return</span> <span class="predefined-constant">false</span> <span class="keyword">unless</span> p
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L344"><a href="#L344">344</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L345"><a href="#L345">345</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L346"><a href="#L346">346</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> p == parent &amp;&amp; !p.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L347"><a href="#L347">347</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Nothing to do</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L348"><a href="#L348">348</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">true</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L349"><a href="#L349">349</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">elsif</span> p.nil? || (p.active? &amp;&amp; move_possible?(p))
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L350"><a href="#L350">350</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Insert the project so that target's children or root projects stay alphabetically sorted</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L351"><a href="#L351">351</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      sibs = (p.nil? ? <span class="predefined-constant">self</span>.class.roots : p.children)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L352"><a href="#L352">352</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      to_be_inserted_before = sibs.detect {|c| c.name.to_s.downcase &gt; name.to_s.downcase }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L353"><a href="#L353">353</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> to_be_inserted_before
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L354"><a href="#L354">354</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        move_to_left_of(to_be_inserted_before)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L355"><a href="#L355">355</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">elsif</span> p.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L356"><a href="#L356">356</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> sibs.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L357"><a href="#L357">357</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          <span class="comment"># move_to_root adds the project in first (ie. left) position</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L358"><a href="#L358">358</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          move_to_root
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L359"><a href="#L359">359</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L360"><a href="#L360">360</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          move_to_right_of(sibs.last) <span class="keyword">unless</span> <span class="predefined-constant">self</span> == sibs.last
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L361"><a href="#L361">361</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L362"><a href="#L362">362</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L363"><a href="#L363">363</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="comment"># move_to_child_of adds the project in last (ie.right) position</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L364"><a href="#L364">364</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        move_to_child_of(p)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L365"><a href="#L365">365</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L366"><a href="#L366">366</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0fe389b8417fe9ad17682a39cdd7c183005f5a5e" title="Revision 0fe389b8">0fe389b8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="constant">Issue</span>.update_versions_from_hierarchy_change(<span class="predefined-constant">self</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L367"><a href="#L367">367</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">true</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L368"><a href="#L368">368</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L369"><a href="#L369">369</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Can not move to the given target</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L370"><a href="#L370">370</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">false</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L371"><a href="#L371">371</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L372"><a href="#L372">372</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L373"><a href="#L373">373</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L374"><a href="#L374">374</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/90c742e4f193642211c39c0ba862c9f8cf1875e8" title="Revision 90c742e4">90c742e4</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of the trackers used by the project and its active sub projects</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L375"><a href="#L375">375</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/049051103b02efdef64f4119959d95d23d45e392" title="Revision 04905110">04905110</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">rolled_up_trackers</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L376"><a href="#L376">376</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/049051103b02efdef64f4119959d95d23d45e392" title="Revision 04905110">04905110</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@rolled_up_trackers</span> ||=
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L377"><a href="#L377">377</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8cd93159d68c5a94d0e625c6304fe96eb909e9c5" title="Revision 8cd93159">8cd93159</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="constant">Tracker</span>.find(<span class="symbol">:all</span>, <span class="symbol">:joins</span> =&gt; <span class="symbol">:projects</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L378"><a href="#L378">378</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/049051103b02efdef64f4119959d95d23d45e392" title="Revision 04905110">04905110</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                         <span class="symbol">:select</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">DISTINCT </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Tracker</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.*</span><span class="delimiter">&quot;</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L379"><a href="#L379">379</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/90c742e4f193642211c39c0ba862c9f8cf1875e8" title="Revision 90c742e4">90c742e4</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                         <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt;= ? AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt;= ? AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status = </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, lft, rgt],
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L380"><a href="#L380">380</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/049051103b02efdef64f4119959d95d23d45e392" title="Revision 04905110">04905110</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                         <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Tracker</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.position</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L381"><a href="#L381">381</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/049051103b02efdef64f4119959d95d23d45e392" title="Revision 04905110">04905110</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L382"><a href="#L382">382</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L383"><a href="#L383">383</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Closes open and locked project versions that are completed</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L384"><a href="#L384">384</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">close_completed_versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L385"><a href="#L385">385</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="constant">Version</span>.transaction <span class="keyword">do</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L386"><a href="#L386">386</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      versions.find(<span class="symbol">:all</span>, <span class="symbol">:conditions</span> =&gt; {<span class="symbol">:status</span> =&gt; <span class="string"><span class="delimiter">%w(</span><span class="content">open locked</span><span class="delimiter">)</span></span>}).each <span class="keyword">do</span> |version|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L387"><a href="#L387">387</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> version.completed?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L388"><a href="#L388">388</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          version.update_attribute(<span class="symbol">:status</span>, <span class="string"><span class="delimiter">'</span><span class="content">closed</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L389"><a href="#L389">389</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L390"><a href="#L390">390</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L391"><a href="#L391">391</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L392"><a href="#L392">392</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8f40750ad7f7ad512fd816757f072c42fae20e66" title="Revision 8f40750a">8f40750a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L393"><a href="#L393">393</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L394"><a href="#L394">394</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a scope of the Versions on subprojects</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L395"><a href="#L395">395</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">rolled_up_versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L396"><a href="#L396">396</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="instance-variable">@rolled_up_versions</span> ||=
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L397"><a href="#L397">397</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="constant">Version</span>.scoped(<span class="symbol">:include</span> =&gt; <span class="symbol">:project</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L398"><a href="#L398">398</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>                     <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt;= ? AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt;= ? AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status = </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, lft, rgt])
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L399"><a href="#L399">399</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/f3cc84b3437a1f5c26748f75bb5cc8b8bca2d719" title="Revision f3cc84b3">f3cc84b3</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L400"><a href="#L400">400</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L401"><a href="#L401">401</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a scope of the Versions used by the project</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L402"><a href="#L402">402</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">shared_versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L403"><a href="#L403">403</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1c03b418e193638205a17b95e056844b74f22b0e" title="Revision 1c03b418">1c03b418</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@shared_versions</span> ||= <span class="keyword">begin</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L404"><a href="#L404">404</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1c03b418e193638205a17b95e056844b74f22b0e" title="Revision 1c03b418">1c03b418</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      r = root? ? <span class="predefined-constant">self</span> : root
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L405"><a href="#L405">405</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="constant">Version</span>.scoped(<span class="symbol">:include</span> =&gt; <span class="symbol">:project</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L406"><a href="#L406">406</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                     <span class="symbol">:conditions</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.id = </span><span class="inline"><span class="inline-delimiter">#{</span>id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L407"><a href="#L407">407</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                    <span class="string"><span class="delimiter">&quot;</span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.status = </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>::<span class="constant">STATUS_ACTIVE</span><span class="inline-delimiter">}</span></span><span class="content"> AND (</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L408"><a href="#L408">408</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                          <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.sharing = 'system'</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L409"><a href="#L409">409</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1c03b418e193638205a17b95e056844b74f22b0e" title="Revision 1c03b418">1c03b418</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                          <span class="string"><span class="delimiter">&quot;</span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt;= </span><span class="inline"><span class="inline-delimiter">#{</span>r.lft<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt;= </span><span class="inline"><span class="inline-delimiter">#{</span>r.rgt<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.sharing = 'tree')</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L410"><a href="#L410">410</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5266e328c029405ab132f4fb99a5ba9bc1d6ba67" title="Revision 5266e328">5266e328</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                          <span class="string"><span class="delimiter">&quot;</span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &lt; </span><span class="inline"><span class="inline-delimiter">#{</span>lft<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &gt; </span><span class="inline"><span class="inline-delimiter">#{</span>rgt<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.sharing IN ('hierarchy', 'descendants'))</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L411"><a href="#L411">411</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5266e328c029405ab132f4fb99a5ba9bc1d6ba67" title="Revision 5266e328">5266e328</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                          <span class="string"><span class="delimiter">&quot;</span><span class="content"> OR (</span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.lft &gt; </span><span class="inline"><span class="inline-delimiter">#{</span>lft<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Project</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.rgt &lt; </span><span class="inline"><span class="inline-delimiter">#{</span>rgt<span class="inline-delimiter">}</span></span><span class="content"> AND </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">Version</span>.table_name<span class="inline-delimiter">}</span></span><span class="content">.sharing = 'hierarchy')</span><span class="delimiter">&quot;</span></span> +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L412"><a href="#L412">412</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>                                          <span class="string"><span class="delimiter">&quot;</span><span class="content">))</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L413"><a href="#L413">413</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/1c03b418e193638205a17b95e056844b74f22b0e" title="Revision 1c03b418">1c03b418</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L414"><a href="#L414">414</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L415"><a href="#L415">415</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L416"><a href="#L416">416</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a hash of project users grouped by role</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L417"><a href="#L417">417</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">users_by_role</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L418"><a href="#L418">418</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    members.find(<span class="symbol">:all</span>, <span class="symbol">:include</span> =&gt; [<span class="symbol">:user</span>, <span class="symbol">:roles</span>]).inject({}) <span class="keyword">do</span> |h, m|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L419"><a href="#L419">419</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      m.roles.each <span class="keyword">do</span> |r|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L420"><a href="#L420">420</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        h[r] ||= []
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L421"><a href="#L421">421</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        h[r] &lt;&lt; m.user
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L422"><a href="#L422">422</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L423"><a href="#L423">423</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      h
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L424"><a href="#L424">424</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L425"><a href="#L425">425</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/da2854cf750b2a848a250491aac17751cb596182" title="Revision da2854cf">da2854cf</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L426"><a href="#L426">426</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L427"><a href="#L427">427</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6d9490ddcc9c501d31a8b403146cd4ba6d8cc5b5" title="Revision 6d9490dd">6d9490dd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Deletes all project's members</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L428"><a href="#L428">428</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6d9490ddcc9c501d31a8b403146cd4ba6d8cc5b5" title="Revision 6d9490dd">6d9490dd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">delete_all_members</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L429"><a href="#L429">429</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7dccf9fda6f30d8f4b0c5eaad9f6e2a1e67cd643" title="Revision 7dccf9fd">7dccf9fd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    me, mr = <span class="constant">Member</span>.table_name, <span class="constant">MemberRole</span>.table_name
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L430"><a href="#L430">430</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/7dccf9fda6f30d8f4b0c5eaad9f6e2a1e67cd643" title="Revision 7dccf9fd">7dccf9fd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    connection.delete(<span class="string"><span class="delimiter">&quot;</span><span class="content">DELETE FROM </span><span class="inline"><span class="inline-delimiter">#{</span>mr<span class="inline-delimiter">}</span></span><span class="content"> WHERE </span><span class="inline"><span class="inline-delimiter">#{</span>mr<span class="inline-delimiter">}</span></span><span class="content">.member_id IN (SELECT </span><span class="inline"><span class="inline-delimiter">#{</span>me<span class="inline-delimiter">}</span></span><span class="content">.id FROM </span><span class="inline"><span class="inline-delimiter">#{</span>me<span class="inline-delimiter">}</span></span><span class="content"> WHERE </span><span class="inline"><span class="inline-delimiter">#{</span>me<span class="inline-delimiter">}</span></span><span class="content">.project_id = </span><span class="inline"><span class="inline-delimiter">#{</span>id<span class="inline-delimiter">}</span></span><span class="content">)</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L431"><a href="#L431">431</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6d9490ddcc9c501d31a8b403146cd4ba6d8cc5b5" title="Revision 6d9490dd">6d9490dd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="constant">Member</span>.delete_all([<span class="string"><span class="delimiter">'</span><span class="content">project_id = ?</span><span class="delimiter">'</span></span>, id])
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L432"><a href="#L432">432</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6d9490ddcc9c501d31a8b403146cd4ba6d8cc5b5" title="Revision 6d9490dd">6d9490dd</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L433"><a href="#L433">433</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L434"><a href="#L434">434</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/578fdc62f26c23951b2d2c2b9be0040c7ade0634" title="Revision 578fdc62">578fdc62</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Users/groups issues can be assigned to</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L435"><a href="#L435">435</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/2c4647f8c6d23c999ae959a047104eef49d00993" title="Revision 2c4647f8">2c4647f8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">assignable_users</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L436"><a href="#L436">436</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/578fdc62f26c23951b2d2c2b9be0040c7ade0634" title="Revision 578fdc62">578fdc62</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    assignable = <span class="constant">Setting</span>.issue_group_assignment? ? member_principals : members
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L437"><a href="#L437">437</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/578fdc62f26c23951b2d2c2b9be0040c7ade0634" title="Revision 578fdc62">578fdc62</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    assignable.select {|m| m.roles.detect {|role| role.assignable?}}.collect {|m| m.principal}.sort
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L438"><a href="#L438">438</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/2c4647f8c6d23c999ae959a047104eef49d00993" title="Revision 2c4647f8">2c4647f8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L439"><a href="#L439">439</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L440"><a href="#L440">440</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/90d33c3e518f9e05d9e2893907ebd157062d33de" title="Revision 90d33c3e">90d33c3e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns the mail adresses of users that should be always notified on project events</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L441"><a href="#L441">441</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/90d33c3e518f9e05d9e2893907ebd157062d33de" title="Revision 90d33c3e">90d33c3e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">recipients</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L442"><a href="#L442">442</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/700c302fca1ef401eff2744ffc5d955406136b17" title="Revision 700c302f">700c302f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    notified_users.collect {|user| user.mail}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L443"><a href="#L443">443</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/90d33c3e518f9e05d9e2893907ebd157062d33de" title="Revision 90d33c3e">90d33c3e</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L444"><a href="#L444">444</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L445"><a href="#L445">445</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c870a7b9ef35ed457911638b7a98e7681cfe6d3a" title="Revision c870a7b9">c870a7b9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns the users that should be notified on project events</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L446"><a href="#L446">446</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c870a7b9ef35ed457911638b7a98e7681cfe6d3a" title="Revision c870a7b9">c870a7b9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">notified_users</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L447"><a href="#L447">447</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/700c302fca1ef401eff2744ffc5d955406136b17" title="Revision 700c302f">700c302f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="comment"># TODO: User part should be extracted to User#notify_about?</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L448"><a href="#L448">448</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/700c302fca1ef401eff2744ffc5d955406136b17" title="Revision 700c302f">700c302f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    members.select {|m| m.mail_notification? || m.user.mail_notification == <span class="string"><span class="delimiter">'</span><span class="content">all</span><span class="delimiter">'</span></span>}.collect {|m| m.user}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L449"><a href="#L449">449</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c870a7b9ef35ed457911638b7a98e7681cfe6d3a" title="Revision c870a7b9">c870a7b9</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L450"><a href="#L450">450</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L451"><a href="#L451">451</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of all custom fields enabled for project issues</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L452"><a href="#L452">452</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># (explictly associated custom fields and custom fields enabled for all projects)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L453"><a href="#L453">453</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce6cf66f6c3af26383cd25ed012d908be4b40bae" title="Revision ce6cf66f">ce6cf66f</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">all_issue_custom_fields</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L454"><a href="#L454">454</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/237a3f52a2d9d269b56f5cdb022f0ff4f8197100" title="Revision 237a3f52">237a3f52</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@all_issue_custom_fields</span> ||= (<span class="constant">IssueCustomField</span>.for_all + issue_custom_fields).uniq.sort
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L455"><a href="#L455">455</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L456"><a href="#L456">456</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L457"><a href="#L457">457</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of all custom fields enabled for project time entries</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L458"><a href="#L458">458</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  <span class="comment"># (explictly associated custom fields and custom fields enabled for all projects)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L459"><a href="#L459">459</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">all_time_entry_custom_fields</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L460"><a href="#L460">460</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>    <span class="instance-variable">@all_time_entry_custom_fields</span> ||= (<span class="constant">TimeEntryCustomField</span>.for_all + time_entry_custom_fields).uniq.sort
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L461"><a href="#L461">461</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8a3151728875f0fc542f0fe7e32e728fe28cd657" title="Revision 8a315172">8a315172</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L462"><a href="#L462">462</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L463"><a href="#L463">463</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/073818f8bc46580e118a7550f1faaa55b3be13d9" title="Revision 073818f8">073818f8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">project</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L464"><a href="#L464">464</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/073818f8bc46580e118a7550f1faaa55b3be13d9" title="Revision 073818f8">073818f8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="predefined-constant">self</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L465"><a href="#L465">465</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/073818f8bc46580e118a7550f1faaa55b3be13d9" title="Revision 073818f8">073818f8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L466"><a href="#L466">466</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L467"><a href="#L467">467</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a19a0d7b9278ae8666971e5f004013ecaa3a9cf8" title="Revision a19a0d7b">a19a0d7b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">&lt;=&gt;</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L468"><a href="#L468">468</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/deb182337d14872c5481059382459f5c21502162" title="Revision deb18233">deb18233</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    name.downcase &lt;=&gt; project.name.downcase
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L469"><a href="#L469">469</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a19a0d7b9278ae8666971e5f004013ecaa3a9cf8" title="Revision a19a0d7b">a19a0d7b</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L470"><a href="#L470">470</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L471"><a href="#L471">471</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">to_s</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L472"><a href="#L472">472</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    name
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L473"><a href="#L473">473</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L474"><a href="#L474">474</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L475"><a href="#L475">475</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns a short description of the projects (first lines)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L476"><a href="#L476">476</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">short_description</span>(length = <span class="integer">255</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L477"><a href="#L477">477</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c9906480d3f279977720dc3f61534f4a5b77d1d2" title="Revision c9906480">c9906480</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    description.gsub(<span class="regexp"><span class="delimiter">/</span><span class="content">^(.{</span><span class="inline"><span class="inline-delimiter">#{</span>length<span class="inline-delimiter">}</span></span><span class="content">}[^</span><span class="char">\n</span><span class="char">\r</span><span class="content">]*).*$</span><span class="delimiter">/</span><span class="modifier">m</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">\1</span><span class="content">...</span><span class="delimiter">'</span></span>).strip <span class="keyword">if</span> description
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L478"><a href="#L478">478</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df99d8f30801792560fc955ac36c2801e6aa5ff5" title="Revision df99d8f3">df99d8f3</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L479"><a href="#L479">479</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L480"><a href="#L480">480</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">css_classes</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L481"><a href="#L481">481</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    s = <span class="string"><span class="delimiter">'</span><span class="content">project</span><span class="delimiter">'</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L482"><a href="#L482">482</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    s &lt;&lt; <span class="string"><span class="delimiter">'</span><span class="content"> root</span><span class="delimiter">'</span></span> <span class="keyword">if</span> root?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L483"><a href="#L483">483</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    s &lt;&lt; <span class="string"><span class="delimiter">'</span><span class="content"> child</span><span class="delimiter">'</span></span> <span class="keyword">if</span> child?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L484"><a href="#L484">484</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    s &lt;&lt; (leaf? ? <span class="string"><span class="delimiter">'</span><span class="content"> leaf</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="content"> parent</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L485"><a href="#L485">485</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    s
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L486"><a href="#L486">486</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L487"><a href="#L487">487</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/878bb555227628d983997d96320a99ebb53adc7b" title="Revision 878bb555">878bb555</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L488"><a href="#L488">488</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># The earliest start date of a project, based on it's issues and versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L489"><a href="#L489">489</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">start_date</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L490"><a href="#L490">490</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    [
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L491"><a href="#L491">491</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     issues.minimum(<span class="string"><span class="delimiter">'</span><span class="content">start_date</span><span class="delimiter">'</span></span>),
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L492"><a href="#L492">492</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     shared_versions.collect(&amp;<span class="symbol">:effective_date</span>),
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L493"><a href="#L493">493</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df9ea24136059b502d156cb69c8bb2b9b6d952e1" title="Revision df9ea241">df9ea241</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     shared_versions.collect(&amp;<span class="symbol">:start_date</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L494"><a href="#L494">494</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    ].flatten.compact.min
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L495"><a href="#L495">495</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L496"><a href="#L496">496</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L497"><a href="#L497">497</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/83bfb8cd2b0a877f89102ec5d2fe1bf481e7d9a3" title="Revision 83bfb8cd">83bfb8cd</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># The latest due date of an issue or version</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L498"><a href="#L498">498</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">due_date</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L499"><a href="#L499">499</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    [
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L500"><a href="#L500">500</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     issues.maximum(<span class="string"><span class="delimiter">'</span><span class="content">due_date</span><span class="delimiter">'</span></span>),
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L501"><a href="#L501">501</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     shared_versions.collect(&amp;<span class="symbol">:effective_date</span>),
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L502"><a href="#L502">502</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>     shared_versions.collect {|v| v.fixed_issues.maximum(<span class="string"><span class="delimiter">'</span><span class="content">due_date</span><span class="delimiter">'</span></span>)}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L503"><a href="#L503">503</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b8982008036624581c1eaa8f92adaa383fafd04e" title="Revision b8982008">b8982008</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    ].flatten.compact.max
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L504"><a href="#L504">504</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L505"><a href="#L505">505</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L506"><a href="#L506">506</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">overdue?</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L507"><a href="#L507">507</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    active? &amp;&amp; !due_date.nil? &amp;&amp; (due_date &lt; <span class="constant">Date</span>.today)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L508"><a href="#L508">508</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L509"><a href="#L509">509</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L510"><a href="#L510">510</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns the percent completed for this project, based on the</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L511"><a href="#L511">511</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># progress on it's versions.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L512"><a href="#L512">512</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">completed_percent</span>(options={<span class="symbol">:include_subprojects</span> =&gt; <span class="predefined-constant">false</span>})
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L513"><a href="#L513">513</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> options.delete(<span class="symbol">:include_subprojects</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L514"><a href="#L514">514</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      total = self_and_descendants.collect(&amp;<span class="symbol">:completed_percent</span>).sum
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L515"><a href="#L515">515</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L516"><a href="#L516">516</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      total / self_and_descendants.count
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L517"><a href="#L517">517</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L518"><a href="#L518">518</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> versions.count &gt; <span class="integer">0</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L519"><a href="#L519">519</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        total = versions.collect(&amp;<span class="symbol">:completed_pourcent</span>).sum
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L520"><a href="#L520">520</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L521"><a href="#L521">521</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        total / versions.count
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L522"><a href="#L522">522</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L523"><a href="#L523">523</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="integer">100</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L524"><a href="#L524">524</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L525"><a href="#L525">525</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L526"><a href="#L526">526</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/bdb3937e0f4c8faceb463e23cb28676930ddbd9e" title="Revision bdb3937e">bdb3937e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L527"><a href="#L527">527</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L528"><a href="#L528">528</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Return true if this project is allowed to do the specified action.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L529"><a href="#L529">529</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># action can be:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L530"><a href="#L530">530</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># * a parameter-like Hash (eg. :controller =&gt; 'projects', :action =&gt; 'edit')</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L531"><a href="#L531">531</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2dfffd7f267b2064bb51d46aac6fb1429b37132" title="Revision c2dfffd7">c2dfffd7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># * a permission Symbol (eg. :edit_project)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L532"><a href="#L532">532</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">allows_to?</span>(action)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L533"><a href="#L533">533</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> action.is_a? <span class="constant">Hash</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L534"><a href="#L534">534</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      allowed_actions.include? <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>action[<span class="symbol">:controller</span>]<span class="inline-delimiter">}</span></span><span class="content">/</span><span class="inline"><span class="inline-delimiter">#{</span>action[<span class="symbol">:action</span>]<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L535"><a href="#L535">535</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L536"><a href="#L536">536</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      allowed_permissions.include? action
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L537"><a href="#L537">537</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L538"><a href="#L538">538</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L539"><a href="#L539">539</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L540"><a href="#L540">540</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">module_enabled?</span>(module_name)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L541"><a href="#L541">541</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    module_name = module_name.to_s
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L542"><a href="#L542">542</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    enabled_modules.detect {|m| m.name == module_name}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L543"><a href="#L543">543</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L544"><a href="#L544">544</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L545"><a href="#L545">545</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">enabled_module_names=</span>(module_names)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L546"><a href="#L546">546</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b05ed594a08611267886942d2f10a52de6b08e44" title="Revision b05ed594">b05ed594</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> module_names &amp;&amp; module_names.is_a?(<span class="constant">Array</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L547"><a href="#L547">547</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      module_names = module_names.collect(&amp;<span class="symbol">:to_s</span>).reject(&amp;<span class="symbol">:blank?</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L548"><a href="#L548">548</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8b39f62a4ce7852dc1fc5b65b307af643b9d0593" title="Revision 8b39f62a">8b39f62a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.enabled_modules = module_names.collect {|name| enabled_modules.detect {|mod| mod.name == name} || <span class="constant">EnabledModule</span>.new(<span class="symbol">:name</span> =&gt; name)}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L549"><a href="#L549">549</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b05ed594a08611267886942d2f10a52de6b08e44" title="Revision b05ed594">b05ed594</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L550"><a href="#L550">550</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/b05ed594a08611267886942d2f10a52de6b08e44" title="Revision b05ed594">b05ed594</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      enabled_modules.clear
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L551"><a href="#L551">551</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L552"><a href="#L552">552</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L553"><a href="#L553">553</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L554"><a href="#L554">554</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of the enabled modules names</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L555"><a href="#L555">555</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">enabled_module_names</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L556"><a href="#L556">556</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    enabled_modules.collect(&amp;<span class="symbol">:name</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L557"><a href="#L557">557</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9284a32c9ac7b932feb72cf0d2d5fb1626ec7862" title="Revision 9284a32c">9284a32c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L558"><a href="#L558">558</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L559"><a href="#L559">559</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment"># Enable a specific module</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L560"><a href="#L560">560</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L561"><a href="#L561">561</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment"># Examples:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L562"><a href="#L562">562</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#   project.enable_module!(:issue_tracking)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L563"><a href="#L563">563</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#   project.enable_module!(&quot;issue_tracking&quot;)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L564"><a href="#L564">564</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">enable_module!</span>(name)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L565"><a href="#L565">565</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>    enabled_modules &lt;&lt; <span class="constant">EnabledModule</span>.new(<span class="symbol">:name</span> =&gt; name.to_s) <span class="keyword">unless</span> module_enabled?(name)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L566"><a href="#L566">566</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L567"><a href="#L567">567</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L568"><a href="#L568">568</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment"># Disable a module if it exists</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L569"><a href="#L569">569</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L570"><a href="#L570">570</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment"># Examples:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L571"><a href="#L571">571</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#   project.disable_module!(:issue_tracking)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L572"><a href="#L572">572</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#   project.disable_module!(&quot;issue_tracking&quot;)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L573"><a href="#L573">573</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="comment">#   project.disable_module!(project.enabled_modules.first)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L574"><a href="#L574">574</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">disable_module!</span>(target)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L575"><a href="#L575">575</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>    target = enabled_modules.detect{|mod| target.to_s == mod.name} <span class="keyword">unless</span> enabled_modules.include?(target)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L576"><a href="#L576">576</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>    target.destroy <span class="keyword">unless</span> target.blank?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L577"><a href="#L577">577</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L578"><a href="#L578">578</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/88bd76b0e49485fd0f34decb51ea2f0d6c8a129c" title="Revision 88bd76b0">88bd76b0</a></td>
        <td class="author">Jean-Baptiste Barth</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L579"><a href="#L579">579</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  safe_attributes <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L580"><a href="#L580">580</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">description</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L581"><a href="#L581">581</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">homepage</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L582"><a href="#L582">582</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">is_public</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L583"><a href="#L583">583</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">identifier</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L584"><a href="#L584">584</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">custom_field_values</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L585"><a href="#L585">585</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a4d7a99c22d9aac89a38c1cb411158777b72bb9d" title="Revision a4d7a99c">a4d7a99c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">custom_fields</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L586"><a href="#L586">586</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df88dc117ff9676e1a4b38944d2388c029203353" title="Revision df88dc11">df88dc11</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">tracker_ids</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L587"><a href="#L587">587</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/df88dc117ff9676e1a4b38944d2388c029203353" title="Revision df88dc11">df88dc11</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="string"><span class="delimiter">'</span><span class="content">issue_custom_field_ids</span><span class="delimiter">'</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L588"><a href="#L588">588</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L589"><a href="#L589">589</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9fb770ba503b3dfe1fe48794e1b7042c5e26d8d7" title="Revision 9fb770ba">9fb770ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  safe_attributes <span class="string"><span class="delimiter">'</span><span class="content">enabled_module_names</span><span class="delimiter">'</span></span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L590"><a href="#L590">590</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9fb770ba503b3dfe1fe48794e1b7042c5e26d8d7" title="Revision 9fb770ba">9fb770ba</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="symbol">:if</span> =&gt; lambda {|project, user| project.new_record? || user.allowed_to?(<span class="symbol">:select_project_modules</span>, project) }
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L591"><a href="#L591">591</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L592"><a href="#L592">592</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an array of projects that are in this project's hierarchy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L593"><a href="#L593">593</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L594"><a href="#L594">594</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Example: parents, children, siblings</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L595"><a href="#L595">595</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">hierarchy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L596"><a href="#L596">596</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    parents = project.self_and_ancestors || []
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L597"><a href="#L597">597</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    descendants = project.descendants || []
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L598"><a href="#L598">598</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    project_hierarchy = parents | descendants <span class="comment"># Set union</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L599"><a href="#L599">599</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cdfc57d5442f72d62437f52af480049c943ecbf8" title="Revision cdfc57d5">cdfc57d5</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L600"><a href="#L600">600</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L601"><a href="#L601">601</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dbad26c87db8247c0d635c993981d4277e165978" title="Revision dbad26c8">dbad26c8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Returns an auto-generated project identifier based on the last identifier used</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L602"><a href="#L602">602</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dbad26c87db8247c0d635c993981d4277e165978" title="Revision dbad26c8">dbad26c8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">next_identifier</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L603"><a href="#L603">603</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dbad26c87db8247c0d635c993981d4277e165978" title="Revision dbad26c8">dbad26c8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    p = <span class="constant">Project</span>.find(<span class="symbol">:first</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">created_on DESC</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L604"><a href="#L604">604</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dbad26c87db8247c0d635c993981d4277e165978" title="Revision dbad26c8">dbad26c8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    p.nil? ? <span class="predefined-constant">nil</span> : p.identifier.to_s.succ
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L605"><a href="#L605">605</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/dbad26c87db8247c0d635c993981d4277e165978" title="Revision dbad26c8">dbad26c8</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L606"><a href="#L606">606</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/027bf93849e82ef3c60e4a3024db49d65f0fb3c9" title="Revision 027bf938">027bf938</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L607"><a href="#L607">607</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Copies and saves the Project instance based on the +project+.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L608"><a href="#L608">608</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Duplicates the source project's:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L609"><a href="#L609">609</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * Wiki</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L610"><a href="#L610">610</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * Versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L611"><a href="#L611">611</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># * Categories</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L612"><a href="#L612">612</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># * Issues</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L613"><a href="#L613">613</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># * Members</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L614"><a href="#L614">614</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># * Queries</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L615"><a href="#L615">615</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L616"><a href="#L616">616</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Accepts an +options+ argument to specify what to copy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L617"><a href="#L617">617</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L618"><a href="#L618">618</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Examples:</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L619"><a href="#L619">619</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   project.copy(1)                                    # =&gt; copies everything</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L620"><a href="#L620">620</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   project.copy(1, :only =&gt; 'members')                # =&gt; copies members only</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L621"><a href="#L621">621</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment">#   project.copy(1, :only =&gt; ['members', 'versions'])  # =&gt; copies members and versions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L622"><a href="#L622">622</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy</span>(project, options={})
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L623"><a href="#L623">623</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    project = project.is_a?(<span class="constant">Project</span>) ? project : <span class="constant">Project</span>.find(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L624"><a href="#L624">624</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L625"><a href="#L625">625</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    to_be_copied = <span class="string"><span class="delimiter">%w(</span><span class="content">wiki versions issue_categories issues members queries boards</span><span class="delimiter">)</span></span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L626"><a href="#L626">626</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    to_be_copied = to_be_copied &amp; options[<span class="symbol">:only</span>].to_a <span class="keyword">unless</span> options[<span class="symbol">:only</span>].nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L627"><a href="#L627">627</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L628"><a href="#L628">628</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="constant">Project</span>.transaction <span class="keyword">do</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L629"><a href="#L629">629</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> save
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L630"><a href="#L630">630</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        reload
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L631"><a href="#L631">631</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        to_be_copied.each <span class="keyword">do</span> |name|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L632"><a href="#L632">632</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          send <span class="string"><span class="delimiter">&quot;</span><span class="content">copy_</span><span class="inline"><span class="inline-delimiter">#{</span>name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, project
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L633"><a href="#L633">633</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L634"><a href="#L634">634</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="constant">Redmine</span>::<span class="constant">Hook</span>.call_hook(<span class="symbol">:model_project_copy_before_save</span>, <span class="symbol">:source_project</span> =&gt; project, <span class="symbol">:destination_project</span> =&gt; <span class="predefined-constant">self</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L635"><a href="#L635">635</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        save
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L636"><a href="#L636">636</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L637"><a href="#L637">637</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L638"><a href="#L638">638</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L639"><a href="#L639">639</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L640"><a href="#L640">640</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L641"><a href="#L641">641</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Copies +project+ and returns the new instance.  This will not save</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L642"><a href="#L642">642</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># the copy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L643"><a href="#L643">643</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">copy_from</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L644"><a href="#L644">644</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">begin</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L645"><a href="#L645">645</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      project = project.is_a?(<span class="constant">Project</span>) ? project : <span class="constant">Project</span>.find(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L646"><a href="#L646">646</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> project
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L647"><a href="#L647">647</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="comment"># clear unique attributes</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L648"><a href="#L648">648</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a18676b6693356f3cea4786e3280149ecfd3f7e6" title="Revision a18676b6">a18676b6</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        attributes = project.attributes.dup.except(<span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">identifier</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">status</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">parent_id</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">lft</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">rgt</span><span class="delimiter">'</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L649"><a href="#L649">649</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        copy = <span class="constant">Project</span>.new(attributes)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L650"><a href="#L650">650</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        copy.enabled_modules = project.enabled_modules
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L651"><a href="#L651">651</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        copy.trackers = project.trackers
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L652"><a href="#L652">652</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        copy.custom_values = project.custom_values.collect {|v| v.clone}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L653"><a href="#L653">653</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6531c3f88721c083f32c3e313efec6b40708382a" title="Revision 6531c3f8">6531c3f8</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        copy.issue_custom_fields = project.issue_custom_fields
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L654"><a href="#L654">654</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">return</span> copy
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L655"><a href="#L655">655</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L656"><a href="#L656">656</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">return</span> <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L657"><a href="#L657">657</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L658"><a href="#L658">658</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">rescue</span> <span class="constant">ActiveRecord</span>::<span class="constant">RecordNotFound</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L659"><a href="#L659">659</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="predefined-constant">nil</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L660"><a href="#L660">660</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L661"><a href="#L661">661</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/fa7bd1c71dca1e9c74e6d83277336321393dac9f" title="Revision fa7bd1c7">fa7bd1c7</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L662"><a href="#L662">662</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L663"><a href="#L663">663</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Yields the given block for each project with its level in the tree</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L664"><a href="#L664">664</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">project_tree</span>(projects, &amp;block)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L665"><a href="#L665">665</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    ancestors = []
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L666"><a href="#L666">666</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    projects.sort_by(&amp;<span class="symbol">:lft</span>).each <span class="keyword">do</span> |project|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L667"><a href="#L667">667</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>      <span class="keyword">while</span> (ancestors.any? &amp;&amp; !project.is_descendant_of?(ancestors.last))
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L668"><a href="#L668">668</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        ancestors.pop
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L669"><a href="#L669">669</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L670"><a href="#L670">670</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">yield</span> project, ancestors.size
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L671"><a href="#L671">671</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      ancestors &lt;&lt; project
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L672"><a href="#L672">672</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L673"><a href="#L673">673</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/0ca74df6040371e448bcb3c718b84cdb635f07ee" title="Revision 0ca74df6">0ca74df6</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L674"><a href="#L674">674</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L675"><a href="#L675">675</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  private
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L676"><a href="#L676">676</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L677"><a href="#L677">677</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies wiki from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L678"><a href="#L678">678</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_wiki</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L679"><a href="#L679">679</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># Check that the source project has a wiki first</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L680"><a href="#L680">680</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">unless</span> project.wiki.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L681"><a href="#L681">681</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.wiki ||= <span class="constant">Wiki</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L682"><a href="#L682">682</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/875eb47ad1e4e845c1983242c4cf644beb3f922b" title="Revision 875eb47a">875eb47a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      wiki.attributes = project.wiki.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L683"><a href="#L683">683</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      wiki_pages_map = {}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L684"><a href="#L684">684</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project.wiki.pages.each <span class="keyword">do</span> |page|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L685"><a href="#L685">685</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="comment"># Skip pages without content</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L686"><a href="#L686">686</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">next</span> <span class="keyword">if</span> page.content.nil?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L687"><a href="#L687">687</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4e73685af7fa45723ccc26c2692cac668835bda3" title="Revision 4e73685a">4e73685a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        new_wiki_content = <span class="constant">WikiContent</span>.new(page.content.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">page_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">updated_on</span><span class="delimiter">&quot;</span></span>))
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L688"><a href="#L688">688</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4e73685af7fa45723ccc26c2692cac668835bda3" title="Revision 4e73685a">4e73685a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        new_wiki_page = <span class="constant">WikiPage</span>.new(page.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">wiki_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">parent_id</span><span class="delimiter">&quot;</span></span>))
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L689"><a href="#L689">689</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        new_wiki_page.content = new_wiki_content
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L690"><a href="#L690">690</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        wiki.pages &lt;&lt; new_wiki_page
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L691"><a href="#L691">691</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        wiki_pages_map[page.id] = new_wiki_page
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L692"><a href="#L692">692</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L693"><a href="#L693">693</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      wiki.save
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L694"><a href="#L694">694</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Reproduce page hierarchy</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L695"><a href="#L695">695</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      project.wiki.pages.each <span class="keyword">do</span> |page|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L696"><a href="#L696">696</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> page.parent_id &amp;&amp; wiki_pages_map[page.id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L697"><a href="#L697">697</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          wiki_pages_map[page.id].parent = wiki_pages_map[page.parent_id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L698"><a href="#L698">698</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          wiki_pages_map[page.id].save
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L699"><a href="#L699">699</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/541d830d2a968f36d73add2b1e3693eab09136ed" title="Revision 541d830d">541d830d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L700"><a href="#L700">700</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a9fb11c0f570336ffe39abddfec1241d052ea76d" title="Revision a9fb11c0">a9fb11c0</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L701"><a href="#L701">701</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L702"><a href="#L702">702</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L703"><a href="#L703">703</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L704"><a href="#L704">704</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies versions from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L705"><a href="#L705">705</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_versions</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L706"><a href="#L706">706</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    project.versions.each <span class="keyword">do</span> |version|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L707"><a href="#L707">707</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_version = <span class="constant">Version</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L708"><a href="#L708">708</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4e73685af7fa45723ccc26c2692cac668835bda3" title="Revision 4e73685a">4e73685a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_version.attributes = version.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">updated_on</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L709"><a href="#L709">709</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.versions &lt;&lt; new_version
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L710"><a href="#L710">710</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L711"><a href="#L711">711</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L712"><a href="#L712">712</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L713"><a href="#L713">713</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies issue categories from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L714"><a href="#L714">714</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_issue_categories</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L715"><a href="#L715">715</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    project.issue_categories.each <span class="keyword">do</span> |issue_category|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L716"><a href="#L716">716</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_issue_category = <span class="constant">IssueCategory</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L717"><a href="#L717">717</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/875eb47ad1e4e845c1983242c4cf644beb3f922b" title="Revision 875eb47a">875eb47a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_issue_category.attributes = issue_category.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L718"><a href="#L718">718</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.issue_categories &lt;&lt; new_issue_category
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L719"><a href="#L719">719</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L720"><a href="#L720">720</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L721"><a href="#L721">721</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L722"><a href="#L722">722</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies issues from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L723"><a href="#L723">723</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/c2d2761caaf08df3b5e867cbb60622b79706dd37" title="Revision c2d2761c">c2d2761c</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Note: issues assigned to a closed version won't be copied due to validation rules</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L724"><a href="#L724">724</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_issues</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L725"><a href="#L725">725</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="comment"># Stores the source issue id as a key and the copied issues as the</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L726"><a href="#L726">726</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="comment"># value.  Used to map the two togeather for issue relations.</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L727"><a href="#L727">727</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    issues_map = {}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L728"><a href="#L728">728</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L729"><a href="#L729">729</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># Get issues sorted by root_id, lft so that parent issues</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L730"><a href="#L730">730</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># get copied before their children</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L731"><a href="#L731">731</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    project.issues.find(<span class="symbol">:all</span>, <span class="symbol">:order</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">root_id, lft</span><span class="delimiter">'</span></span>).each <span class="keyword">do</span> |issue|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L732"><a href="#L732">732</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_issue = <span class="constant">Issue</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L733"><a href="#L733">733</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_issue.copy_from(issue)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L734"><a href="#L734">734</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_issue.project = <span class="predefined-constant">self</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L735"><a href="#L735">735</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Reassign fixed_versions by name, since names are unique per</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L736"><a href="#L736">736</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># project and the versions for self are not yet saved</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L737"><a href="#L737">737</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> issue.fixed_version
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L738"><a href="#L738">738</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        new_issue.fixed_version = <span class="predefined-constant">self</span>.versions.select {|v| v.name == issue.fixed_version.name}.first
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L739"><a href="#L739">739</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L740"><a href="#L740">740</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Reassign the category by name, since names are unique per</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L741"><a href="#L741">741</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># project and the categories for self are not yet saved</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L742"><a href="#L742">742</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> issue.category
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L743"><a href="#L743">743</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        new_issue.category = <span class="predefined-constant">self</span>.issue_categories.select {|c| c.name == issue.category.name}.first
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L744"><a href="#L744">744</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L745"><a href="#L745">745</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># Parent issue</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L746"><a href="#L746">746</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> issue.parent_id
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L747"><a href="#L747">747</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> copied_parent = issues_map[issue.parent_id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L748"><a href="#L748">748</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>          new_issue.parent_issue_id = copied_parent.id
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L749"><a href="#L749">749</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L750"><a href="#L750">750</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/8e3d1b694ab47317638b474082cb70e08a8d02e7" title="Revision 8e3d1b69">8e3d1b69</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L751"><a href="#L751">751</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L752"><a href="#L752">752</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.issues &lt;&lt; new_issue
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L753"><a href="#L753">753</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">if</span> new_issue.new_record?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L754"><a href="#L754">754</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        logger.info <span class="string"><span class="delimiter">&quot;</span><span class="content">Project#copy_issues: issue #</span><span class="inline"><span class="inline-delimiter">#{</span>issue.id<span class="inline-delimiter">}</span></span><span class="content"> could not be copied: </span><span class="inline"><span class="inline-delimiter">#{</span>new_issue.errors.full_messages<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span> <span class="keyword">if</span> logger &amp;&amp; logger.info
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L755"><a href="#L755">755</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L756"><a href="#L756">756</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        issues_map[issue.id] = new_issue <span class="keyword">unless</span> new_issue.new_record?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L757"><a href="#L757">757</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L758"><a href="#L758">758</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L759"><a href="#L759">759</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L760"><a href="#L760">760</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="comment"># Relations after in case issues related each other</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L761"><a href="#L761">761</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    project.issues.each <span class="keyword">do</span> |issue|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L762"><a href="#L762">762</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      new_issue = issues_map[issue.id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L763"><a href="#L763">763</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">unless</span> new_issue
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L764"><a href="#L764">764</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="comment"># Issue was not copied</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L765"><a href="#L765">765</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>        <span class="keyword">next</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L766"><a href="#L766">766</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/cd71c1cc0ad732af55e9665cfc742c066647536f" title="Revision cd71c1cc">cd71c1cc</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L767"><a href="#L767">767</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L768"><a href="#L768">768</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="comment"># Relations</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L769"><a href="#L769">769</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      issue.relations_from.each <span class="keyword">do</span> |source_relation|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L770"><a href="#L770">770</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation = <span class="constant">IssueRelation</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L771"><a href="#L771">771</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation.attributes = source_relation.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">issue_from_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">issue_to_id</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L772"><a href="#L772">772</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation.issue_to = issues_map[source_relation.issue_to_id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L773"><a href="#L773">773</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> new_issue_relation.issue_to.nil? &amp;&amp; <span class="constant">Setting</span>.cross_project_issue_relations?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L774"><a href="#L774">774</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>          new_issue_relation.issue_to = source_relation.issue_to
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L775"><a href="#L775">775</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L776"><a href="#L776">776</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue.relations_from &lt;&lt; new_issue_relation
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L777"><a href="#L777">777</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L778"><a href="#L778">778</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L779"><a href="#L779">779</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      issue.relations_to.each <span class="keyword">do</span> |source_relation|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L780"><a href="#L780">780</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation = <span class="constant">IssueRelation</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L781"><a href="#L781">781</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation.attributes = source_relation.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">issue_from_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">issue_to_id</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L782"><a href="#L782">782</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue_relation.issue_from = issues_map[source_relation.issue_from_id]
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L783"><a href="#L783">783</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">if</span> new_issue_relation.issue_from.nil? &amp;&amp; <span class="constant">Setting</span>.cross_project_issue_relations?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L784"><a href="#L784">784</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>          new_issue_relation.issue_from = source_relation.issue_from
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L785"><a href="#L785">785</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L786"><a href="#L786">786</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        new_issue.relations_to &lt;&lt; new_issue_relation
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-10">
        <th class="line-num" id="L787"><a href="#L787">787</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/17512e7efdb2ef03cae94a2697a72d79205a9b2b" title="Revision 17512e7e">17512e7e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L788"><a href="#L788">788</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L789"><a href="#L789">789</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L790"><a href="#L790">790</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L791"><a href="#L791">791</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies members from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L792"><a href="#L792">792</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_members</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L793"><a href="#L793">793</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce8113dea2a73eff5286bfbc31a2042693943471" title="Revision ce8113de">ce8113de</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="comment"># Copy users first, then groups to handle members with inherited and given roles</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L794"><a href="#L794">794</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce8113dea2a73eff5286bfbc31a2042693943471" title="Revision ce8113de">ce8113de</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    members_to_copy = []
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L795"><a href="#L795">795</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce8113dea2a73eff5286bfbc31a2042693943471" title="Revision ce8113de">ce8113de</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    members_to_copy += project.memberships.select {|m| m.principal.is_a?(<span class="constant">User</span>)}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L796"><a href="#L796">796</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce8113dea2a73eff5286bfbc31a2042693943471" title="Revision ce8113de">ce8113de</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    members_to_copy += project.memberships.select {|m| !m.principal.is_a?(<span class="constant">User</span>)}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L797"><a href="#L797">797</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L798"><a href="#L798">798</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/ce8113dea2a73eff5286bfbc31a2042693943471" title="Revision ce8113de">ce8113de</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    members_to_copy.each <span class="keyword">do</span> |member|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L799"><a href="#L799">799</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_member = <span class="constant">Member</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-8">
        <th class="line-num" id="L800"><a href="#L800">800</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/4e73685af7fa45723ccc26c2692cac668835bda3" title="Revision 4e73685a">4e73685a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_member.attributes = member.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L801"><a href="#L801">801</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># only copy non inherited roles</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L802"><a href="#L802">802</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="comment"># inherited roles will be added when copying the group membership</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L803"><a href="#L803">803</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      role_ids = member.member_roles.reject(&amp;<span class="symbol">:inherited?</span>).collect(&amp;<span class="symbol">:role_id</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L804"><a href="#L804">804</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">next</span> <span class="keyword">if</span> role_ids.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-9">
        <th class="line-num" id="L805"><a href="#L805">805</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/04455783a76e1a34e35c575fe3e7839bc1aa0609" title="Revision 04455783">04455783</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_member.role_ids = role_ids
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L806"><a href="#L806">806</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_member.project = <span class="predefined-constant">self</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L807"><a href="#L807">807</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.members &lt;&lt; new_member
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L808"><a href="#L808">808</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L809"><a href="#L809">809</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L810"><a href="#L810">810</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L811"><a href="#L811">811</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies queries from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L812"><a href="#L812">812</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_queries</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L813"><a href="#L813">813</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    project.queries.each <span class="keyword">do</span> |query|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L814"><a href="#L814">814</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/a03432cbe690467ed161923b7888e0a771cd968f" title="Revision a03432cb">a03432cb</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_query = ::<span class="constant">Query</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L815"><a href="#L815">815</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/875eb47ad1e4e845c1983242c4cf644beb3f922b" title="Revision 875eb47a">875eb47a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_query.attributes = query.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sort_criteria</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L816"><a href="#L816">816</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_query.sort_criteria = query.sort_criteria <span class="keyword">if</span> query.sort_criteria
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L817"><a href="#L817">817</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_query.project = <span class="predefined-constant">self</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-3">
        <th class="line-num" id="L818"><a href="#L818">818</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/3da92d7da7a25b39ccf171ef350277e599f2f785" title="Revision 3da92d7d">3da92d7d</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_query.user_id = query.user_id
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L819"><a href="#L819">819</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.queries &lt;&lt; new_query
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L820"><a href="#L820">820</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L821"><a href="#L821">821</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5b787785b47634a00e77f7a375bfc4c8cf5f0009" title="Revision 5b787785">5b787785</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L822"><a href="#L822">822</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L823"><a href="#L823">823</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Copies boards from +project+</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L824"><a href="#L824">824</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">copy_boards</span>(project)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L825"><a href="#L825">825</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    project.boards.each <span class="keyword">do</span> |board|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L826"><a href="#L826">826</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_board = <span class="constant">Board</span>.new
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L827"><a href="#L827">827</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_board.attributes = board.attributes.dup.except(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">project_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">topics_count</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">messages_count</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last_message_id</span><span class="delimiter">&quot;</span></span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L828"><a href="#L828">828</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      new_board.project = <span class="predefined-constant">self</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L829"><a href="#L829">829</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="predefined-constant">self</span>.boards &lt;&lt; new_board
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L830"><a href="#L830">830</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-1">
        <th class="line-num" id="L831"><a href="#L831">831</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6fedbf60d5a9bb2747b1e250ffc9f5f4947676f6" title="Revision 6fedbf60">6fedbf60</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L832"><a href="#L832">832</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L833"><a href="#L833">833</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">allowed_permissions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L834"><a href="#L834">834</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@allowed_permissions</span> ||= <span class="keyword">begin</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-4">
        <th class="line-num" id="L835"><a href="#L835">835</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/39c97279ca6fe8864d44f6892f8769f656cba487" title="Revision 39c97279">39c97279</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      module_names = enabled_modules.all(<span class="symbol">:select</span> =&gt; <span class="symbol">:name</span>).collect {|m| m.name}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L836"><a href="#L836">836</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="constant">Redmine</span>::<span class="constant">AccessControl</span>.modules_permissions(module_names).collect {|p| p.name}
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L837"><a href="#L837">837</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L838"><a href="#L838">838</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L839"><a href="#L839">839</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L840"><a href="#L840">840</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">allowed_actions</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L841"><a href="#L841">841</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="instance-variable">@actions_allowed</span> ||= allowed_permissions.inject([]) { |actions, permission| actions += <span class="constant">Redmine</span>::<span class="constant">AccessControl</span>.allowed_actions(permission) }.flatten
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-11">
        <th class="line-num" id="L842"><a href="#L842">842</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/21c97c6a1376a38a3951c57069317c17c81029f8" title="Revision 21c97c6a">21c97c6a</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L843"><a href="#L843">843</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L844"><a href="#L844">844</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns all the active Systemwide and project specific activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L845"><a href="#L845">845</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">active_activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L846"><a href="#L846">846</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9fb40b1a2f700ce6e5bd31438fe9c9ef737555ab" title="Revision 9fb40b1a">9fb40b1a</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    overridden_activity_ids = <span class="predefined-constant">self</span>.time_entry_activities.collect(&amp;<span class="symbol">:parent_id</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L847"><a href="#L847">847</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L848"><a href="#L848">848</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> overridden_activity_ids.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L849"><a href="#L849">849</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d8c5549168f3fe7e9f2b1633e70928178665773a" title="Revision d8c55491">d8c55491</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="constant">TimeEntryActivity</span>.shared.active
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L850"><a href="#L850">850</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L851"><a href="#L851">851</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> system_activities_and_project_overrides
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L852"><a href="#L852">852</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L853"><a href="#L853">853</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L854"><a href="#L854">854</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L855"><a href="#L855">855</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns all the Systemwide and project specific activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L856"><a href="#L856">856</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># (inactive and active)</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L857"><a href="#L857">857</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">all_activities</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L858"><a href="#L858">858</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    overridden_activity_ids = <span class="predefined-constant">self</span>.time_entry_activities.collect(&amp;<span class="symbol">:parent_id</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L859"><a href="#L859">859</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L860"><a href="#L860">860</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> overridden_activity_ids.empty?
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L861"><a href="#L861">861</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d8c5549168f3fe7e9f2b1633e70928178665773a" title="Revision d8c55491">d8c55491</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="constant">TimeEntryActivity</span>.shared
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L862"><a href="#L862">862</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L863"><a href="#L863">863</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> system_activities_and_project_overrides(<span class="predefined-constant">true</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L864"><a href="#L864">864</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L865"><a href="#L865">865</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L866"><a href="#L866">866</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L867"><a href="#L867">867</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="comment"># Returns the systemwide active activities merged with the project specific overrides</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L868"><a href="#L868">868</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">system_activities_and_project_overrides</span>(include_inactive=<span class="predefined-constant">false</span>)
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L869"><a href="#L869">869</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">if</span> include_inactive
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L870"><a href="#L870">870</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d8c5549168f3fe7e9f2b1633e70928178665773a" title="Revision d8c55491">d8c55491</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="constant">TimeEntryActivity</span>.shared.
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L871"><a href="#L871">871</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        find(<span class="symbol">:all</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L872"><a href="#L872">872</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>             <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="content">id NOT IN (?)</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">self</span>.time_entry_activities.collect(&amp;<span class="symbol">:parent_id</span>)]) +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L873"><a href="#L873">873</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="predefined-constant">self</span>.time_entry_activities
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L874"><a href="#L874">874</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">else</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-7">
        <th class="line-num" id="L875"><a href="#L875">875</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/d8c5549168f3fe7e9f2b1633e70928178665773a" title="Revision d8c55491">d8c55491</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      <span class="keyword">return</span> <span class="constant">TimeEntryActivity</span>.shared.active.
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L876"><a href="#L876">876</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        find(<span class="symbol">:all</span>,
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-5">
        <th class="line-num" id="L877"><a href="#L877">877</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/9fb40b1a2f700ce6e5bd31438fe9c9ef737555ab" title="Revision 9fb40b1a">9fb40b1a</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>             <span class="symbol">:conditions</span> =&gt; [<span class="string"><span class="delimiter">&quot;</span><span class="content">id NOT IN (?)</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">self</span>.time_entry_activities.collect(&amp;<span class="symbol">:parent_id</span>)]) +
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L878"><a href="#L878">878</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>        <span class="predefined-constant">self</span>.time_entry_activities.active
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L879"><a href="#L879">879</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5833ba9f81f0384e5b7f5a9d322adb1c5199e3d8" title="Revision 5833ba9f">5833ba9f</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L880"><a href="#L880">880</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e615266e9a036811c7f73a471ba48b5bbe27adfe" title="Revision e615266e">e615266e</a></td>
        <td class="author">Eric Davis</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-2">
        <th class="line-num" id="L881"><a href="#L881">881</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/44147ee8f290c6e353e15b8a60fafad202e66bcd" title="Revision 44147ee8">44147ee8</a></td>
        <td class="author">Toshi MARUYAMA</td>
        <td class="line-code"><pre>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L882"><a href="#L882">882</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="comment"># Archives subprojects recursively</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L883"><a href="#L883">883</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">def</span> <span class="function">archive!</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L884"><a href="#L884">884</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    children.each <span class="keyword">do</span> |subproject|
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L885"><a href="#L885">885</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>      subproject.send <span class="symbol">:archive!</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L886"><a href="#L886">886</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L887"><a href="#L887">887</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>    update_attribute <span class="symbol">:status</span>, <span class="constant">STATUS_ARCHIVED</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-0">
        <th class="line-num" id="L888"><a href="#L888">888</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/5f8e9d71182040473d4072241ce81fcadada497f" title="Revision 5f8e9d71">5f8e9d71</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre>  <span class="keyword">end</span>
</pre></td>
      </tr>
      
    
      
      <tr class="bloc-6">
        <th class="line-num" id="L889"><a href="#L889">889</a></th>
        <td class="revision">
        <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/6b7650e2f03156ea1e3985b30c1995e44c317e3d" title="Revision 6b7650e2">6b7650e2</a></td>
        <td class="author">Jean-Philippe Lang</td>
        <td class="line-code"><pre><span class="keyword">end</span></pre></td>
      </tr>
      
    
  </tbody>
</table>
</div>




        
        <div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>

<!-- Mirrored from redmine.ogf.org/projects/redmine-og/repository/revisions/1bd5e58c847816ae5751ee0026e55597d1541dd4/annotate/app/models/project.rb by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 13 Oct 2022 17:42:34 GMT -->
</html>
