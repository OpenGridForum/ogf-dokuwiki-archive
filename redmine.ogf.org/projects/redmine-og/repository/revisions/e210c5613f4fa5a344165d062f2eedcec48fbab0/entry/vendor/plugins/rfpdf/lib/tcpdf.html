<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/entry/vendor/plugins/rfpdf/lib/tcpdf.rb by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 13 Oct 2022 17:43:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>/vendor/plugins/rfpdf/lib/tcpdf.rb - Redmine - Open Grid Forum</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token"/>
<meta name="csrf-token" content="rsvo5Uvs/OHqzq9AZjxgQ/1mtk/oY58g0kQJMlDTftw="/>
<link rel='shortcut icon' href='https://redmine.ogf.org/favicon.ico?1425381960' />
<link href="https://redmine.ogf.org/themes/ogf_redmine/stylesheets/application.css?1425381960" media="all" rel="stylesheet" type="text/css" />

<script src="https://redmine.ogf.org/javascripts/prototype.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/effects.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/dragdrop.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/controls.js?1425381960" type="text/javascript"></script>
<script src="https://redmine.ogf.org/javascripts/application.js?1425381960" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
Event.observe(window, 'load', function(){ new WarnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<!--[if IE 6]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1425381960);}
    </style>
<![endif]-->
<link href="https://redmine.ogf.org/plugin_assets/extended_fields/stylesheets/extended_fields.css?1425381960" media="screen" rel="stylesheet" type="text/css" /> <link href="https://redmine.ogf.org/plugin_assets/wiking/stylesheets/wiking.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
<!-- page specific tags -->

  <script src="https://redmine.ogf.org/javascripts/repository_navigation.js?1425381960" type="text/javascript"></script>

<link href="https://redmine.ogf.org/stylesheets/scm.css?1425381960" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="theme-Ogf redmine controller-repositories action-entry">
<div id="wrapper">
<div id="wrapper2">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="https://redmine.ogf.org/login" class="login">Login</a></li>
<li><a href="https://redmine.ogf.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="https://redmine.ogf.org/" class="home">Home</a></li>
<li><a href="https://redmine.ogf.org/projects" class="projects">Projects</a></li>
<li><a href="http://www.redmine.org/guide" class="help">Help</a></li></ul></div>

<div id="header">
    
    <div id="quick-search">
        <form action="https://redmine.ogf.org/search/index/redmine-og" method="get">
        <input name="changesets" type="hidden" value="1" />
        <label for='q'>
          <a href="https://redmine.ogf.org/search/index/redmine-og" accesskey="4">Search</a>:
        </label>
        <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
        </form>
        
    </div>
    

    <h1><a href="https://redmine.ogf.org/projects/operations?jump=repository" class="root">Operations</a> » <a href="https://redmine.ogf.org/projects/it-og?jump=repository" class="ancestor">IT</a> » Redmine</h1>

    
    <div id="main-menu">
        <ul><li><a href="https://redmine.ogf.org/projects/redmine-og" class="overview">Overview</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/issues" class="issues">Issues</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/issues/calendar" class="calendar">Calendar</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/news" class="news">News</a></li>
<li><a href="https://redmine.ogf.org/dmsf/redmine-og" class="dmsf">Documents</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/wiki" class="wiki">Wiki</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/files" class="files">Files</a></li>
<li><a href="https://redmine.ogf.org/projects/redmine-og/repository" class="repository selected">Repository</a></li></ul>
    </div>
    
</div>

<div class="nosidebar" id="main">
    <div id="sidebar">
        
        
  
  


    </div>

    <div id="content">
        
        

<div class="contextual">
  

<a href="https://redmine.ogf.org/projects/redmine-og/repository/statistics" class="icon icon-stats">Statistics</a>

<form action="https://redmine.ogf.org/projects/redmine-og/repository/entry/vendor/plugins/rfpdf/lib/tcpdf.rb?rev=" id="revision_selector" method="get">  <!-- Branches Dropdown -->
      | Branch: 
    <select id="branch" name="branch"><option value=""></option>
<option value="1.3-stable">1.3-stable</option>
<option value="devel">devel</option>
<option value="master">master</option></select>
  
  
  | Revision: 
  <input id="rev" name="rev" size="8" type="text" value="e210c5613f4fa5a344165d062f2eedcec48fbab0" />
</form>
</div>

<h2><a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/show">root</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/show/vendor">vendor</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/show/vendor/plugins">plugins</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/show/vendor/plugins/rfpdf">rfpdf</a>

    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/show/vendor/plugins/rfpdf/lib">lib</a>


    / <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/changes/vendor/plugins/rfpdf/lib/tcpdf.rb">tcpdf.rb</a>


@ e210c561

</h2>

<p>

<p>
<a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/changes/vendor/plugins/rfpdf/lib/tcpdf.rb">History</a> |

    View |


    <a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/annotate/vendor/plugins/rfpdf/lib/tcpdf.rb">Annotate</a> |

<a href="https://redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/raw/vendor/plugins/rfpdf/lib/tcpdf.rb">Download</a>
(121.8 kB)
</p>


</p>

<div class="autoscroll">
<table class="filecontent syntaxhl">
<tbody>


  <tr>
    <th class="line-num" id="L1">
      <a href="#L1">1</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#============================================================+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2">
      <a href="#L2">2</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># File name   : tcpdf.rb</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3">
      <a href="#L3">3</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Begin       : 2002-08-03</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4">
      <a href="#L4">4</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Last Update : 2007-03-20</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L5">
      <a href="#L5">5</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Author      : Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L6">
      <a href="#L6">6</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Version     : 1.53.0.TC031</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L7">
      <a href="#L7">7</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># License     : GNU LGPL (http://www.gnu.org/copyleft/lesser.html)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L8">
      <a href="#L8">8</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L9">
      <a href="#L9">9</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Description : This is a Ruby class for generating PDF files </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L10">
      <a href="#L10">10</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#               on-the-fly without requiring external </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L11">
      <a href="#L11">11</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#               extensions.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L12">
      <a href="#L12">12</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L13">
      <a href="#L13">13</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># IMPORTANT:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L14">
      <a href="#L14">14</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># This class is an extension and improvement of the Public Domain </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L15">
      <a href="#L15">15</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># FPDF class by Olivier Plathey (http://www.fpdf.org).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L16">
      <a href="#L16">16</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L17">
      <a href="#L17">17</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Main changes by Nicola Asuni:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L18">
      <a href="#L18">18</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    Ruby porting;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L19">
      <a href="#L19">19</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    UTF-8 Unicode support;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L20">
      <a href="#L20">20</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    code refactoring;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L21">
      <a href="#L21">21</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    source code clean up;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L22">
      <a href="#L22">22</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    code style and formatting;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L23">
      <a href="#L23">23</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    source code documentation using phpDocumentor (www.phpdoc.org);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L24">
      <a href="#L24">24</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    All ISO page formats were included;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L25">
      <a href="#L25">25</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    image scale factor;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L26">
      <a href="#L26">26</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    includes methods to parse and printsome XHTML code, supporting the following elements: h1, h2, h3, h4, h5, h6, b, u, i, a, img, p, br, strong, em, font, blockquote, li, ul, ol, hr, td, th, tr, table, sup, sub, small;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L27">
      <a href="#L27">27</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    includes a method to print various barcode formats using an improved version of &quot;Generic Barcode Render Class&quot; by Karim Mribti (http://www.mribti.com/barcode/) (require GD library: http://www.boutell.com/gd/);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L28">
      <a href="#L28">28</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#    defines standard Header() and Footer() methods.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L29">
      <a href="#L29">29</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L30">
      <a href="#L30">30</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#   Ported to Ruby by Ed Moss 2007-08-06</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L31">
      <a href="#L31">31</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L32">
      <a href="#L32">32</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#============================================================+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L33">
      <a href="#L33">33</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L34">
      <a href="#L34">34</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L35">
      <a href="#L35">35</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># TCPDF Class.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L36">
      <a href="#L36">36</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @package com.tecnick.tcpdf</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L37">
      <a href="#L37">37</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L38">
      <a href="#L38">38</a>
    </th>
    <td class="line-code">
      <pre> 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L39">
      <a href="#L39">39</a>
    </th>
    <td class="line-code">
      <pre><span class="class-variable">@@version</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1.53.0.TC031</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L40">
      <a href="#L40">40</a>
    </th>
    <td class="line-code">
      <pre><span class="class-variable">@@fpdf_charwidths</span> = {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L41">
      <a href="#L41">41</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L42">
      <a href="#L42">42</a>
    </th>
    <td class="line-code">
      <pre><span class="constant">PDF_PRODUCER</span> = <span class="string"><span class="delimiter">'</span><span class="content">TCPDF via RFPDF 1.53.0.TC031 (http://tcpdf.sourceforge.net)</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L43">
      <a href="#L43">43</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L44">
      <a href="#L44">44</a>
    </th>
    <td class="line-code">
      <pre><span class="keyword">module</span> <span class="class">TCPDFFontDescriptor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L45">
      <a href="#L45">45</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@descriptors</span> = { <span class="string"><span class="delimiter">'</span><span class="content">freesans</span><span class="delimiter">'</span></span> =&gt; {} }
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L46">
      <a href="#L46">46</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@font_name</span> = <span class="string"><span class="delimiter">'</span><span class="content">freesans</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L47">
      <a href="#L47">47</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L48">
      <a href="#L48">48</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">font</span>(font_name)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L49">
      <a href="#L49">49</a>
    </th>
    <td class="line-code">
      <pre>    <span class="class-variable">@@descriptors</span>[font_name.gsub(<span class="string"><span class="delimiter">&quot;</span><span class="content">.rb</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L50">
      <a href="#L50">50</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L51">
      <a href="#L51">51</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L52">
      <a href="#L52">52</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">define</span>(font_name = <span class="string"><span class="delimiter">'</span><span class="content">freesans</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L53">
      <a href="#L53">53</a>
    </th>
    <td class="line-code">
      <pre>    <span class="class-variable">@@descriptors</span>[font_name] ||= {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L54">
      <a href="#L54">54</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">yield</span> <span class="class-variable">@@descriptors</span>[font_name]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L55">
      <a href="#L55">55</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L56">
      <a href="#L56">56</a>
    </th>
    <td class="line-code">
      <pre><span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L57">
      <a href="#L57">57</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L58">
      <a href="#L58">58</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># This is a Ruby class for generating PDF files on-the-fly without requiring external extensions.&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L59">
      <a href="#L59">59</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># This class is an extension and improvement of the FPDF class by Olivier Plathey (http://www.fpdf.org).&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L60">
      <a href="#L60">60</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># This version contains some changes: [porting to Ruby, support for UTF-8 Unicode, code style and formatting, php documentation (www.phpdoc.org), ISO page formats, minor improvements, image scale factor]&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L61">
      <a href="#L61">61</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># TCPDF project (http://tcpdf.sourceforge.net) is based on the Public Domain FPDF class by Olivier Plathey (http://www.fpdf.org).&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L62">
      <a href="#L62">62</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># To add your own TTF fonts please read /fonts/README.TXT</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L63">
      <a href="#L63">63</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @name TCPDF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L64">
      <a href="#L64">64</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @package com.tecnick.tcpdf</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L65">
      <a href="#L65">65</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @@version 1.53.0.TC031</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L66">
      <a href="#L66">66</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L67">
      <a href="#L67">67</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @link http://tcpdf.sourceforge.net</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L68">
      <a href="#L68">68</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># @license http://www.gnu.org/copyleft/lesser.html LGPL</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L69">
      <a href="#L69">69</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L70">
      <a href="#L70">70</a>
    </th>
    <td class="line-code">
      <pre><span class="keyword">class</span> <span class="class">TCPDF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L71">
      <a href="#L71">71</a>
    </th>
    <td class="line-code">
      <pre>  include <span class="constant">RFPDF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L72">
      <a href="#L72">72</a>
    </th>
    <td class="line-code">
      <pre>  include <span class="constant">Core</span>::<span class="constant">RFPDF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L73">
      <a href="#L73">73</a>
    </th>
    <td class="line-code">
      <pre>  include <span class="constant">RFPDF</span>::<span class="constant">Math</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L74">
      <a href="#L74">74</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L75">
      <a href="#L75">75</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="function">logger</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L76">
      <a href="#L76">76</a>
    </th>
    <td class="line-code">
      <pre>    <span class="constant">Rails</span>.logger
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L77">
      <a href="#L77">77</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L78">
      <a href="#L78">78</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L79">
      <a href="#L79">79</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:k_cell_height_ratio</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L80">
      <a href="#L80">80</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@k_cell_height_ratio</span> = <span class="float">1.25</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L81">
      <a href="#L81">81</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L82">
      <a href="#L82">82</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:k_blank_image</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L83">
      <a href="#L83">83</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@k_blank_image</span> = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L84">
      <a href="#L84">84</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L85">
      <a href="#L85">85</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:k_small_ratio</span>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L86">
      <a href="#L86">86</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@k_small_ratio</span> = <span class="integer">2</span>/<span class="float">3.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L87">
      <a href="#L87">87</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L88">
      <a href="#L88">88</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:k_path_cache</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L89">
      <a href="#L89">89</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@k_path_cache</span> = <span class="constant">Rails</span>.root.join(<span class="string"><span class="delimiter">'</span><span class="content">tmp</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L90">
      <a href="#L90">90</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L91">
      <a href="#L91">91</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:k_path_url_cache</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L92">
      <a href="#L92">92</a>
    </th>
    <td class="line-code">
      <pre>  <span class="class-variable">@@k_path_url_cache</span> = <span class="constant">Rails</span>.root.join(<span class="string"><span class="delimiter">'</span><span class="content">tmp</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L93">
      <a href="#L93">93</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L94">
      <a href="#L94">94</a>
    </th>
    <td class="line-code">
      <pre>  cattr_accessor <span class="symbol">:decoder</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L95">
      <a href="#L95">95</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L96">
      <a href="#L96">96</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:barcode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L97">
      <a href="#L97">97</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L98">
      <a href="#L98">98</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:buffer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L99">
      <a href="#L99">99</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L100">
      <a href="#L100">100</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:diffs</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L101">
      <a href="#L101">101</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L102">
      <a href="#L102">102</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:color_flag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L103">
      <a href="#L103">103</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L104">
      <a href="#L104">104</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:default_table_columns</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L105">
      <a href="#L105">105</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L106">
      <a href="#L106">106</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:max_table_columns</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L107">
      <a href="#L107">107</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L108">
      <a href="#L108">108</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:default_font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L109">
      <a href="#L109">109</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L110">
      <a href="#L110">110</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:draw_color</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L111">
      <a href="#L111">111</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L112">
      <a href="#L112">112</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:encoding</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L113">
      <a href="#L113">113</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L114">
      <a href="#L114">114</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:fill_color</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L115">
      <a href="#L115">115</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L116">
      <a href="#L116">116</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:fonts</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L117">
      <a href="#L117">117</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L118">
      <a href="#L118">118</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:font_family</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L119">
      <a href="#L119">119</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L120">
      <a href="#L120">120</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:font_files</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L121">
      <a href="#L121">121</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L122">
      <a href="#L122">122</a>
    </th>
    <td class="line-code">
      <pre>        cattr_accessor <span class="symbol">:font_path</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L123">
      <a href="#L123">123</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L124">
      <a href="#L124">124</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:font_style</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L125">
      <a href="#L125">125</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L126">
      <a href="#L126">126</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:font_size_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L127">
      <a href="#L127">127</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L128">
      <a href="#L128">128</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:header_width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L129">
      <a href="#L129">129</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L130">
      <a href="#L130">130</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:header_logo</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L131">
      <a href="#L131">131</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L132">
      <a href="#L132">132</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:header_logo_width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L133">
      <a href="#L133">133</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L134">
      <a href="#L134">134</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:header_title</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L135">
      <a href="#L135">135</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L136">
      <a href="#L136">136</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:header_string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L137">
      <a href="#L137">137</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L138">
      <a href="#L138">138</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:images</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L139">
      <a href="#L139">139</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L140">
      <a href="#L140">140</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:img_scale</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L141">
      <a href="#L141">141</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L142">
      <a href="#L142">142</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:in_footer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L143">
      <a href="#L143">143</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L144">
      <a href="#L144">144</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:is_unicode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L145">
      <a href="#L145">145</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L146">
      <a href="#L146">146</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:lasth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L147">
      <a href="#L147">147</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L148">
      <a href="#L148">148</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:links</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L149">
      <a href="#L149">149</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L150">
      <a href="#L150">150</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:list_ordered</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L151">
      <a href="#L151">151</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L152">
      <a href="#L152">152</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:list_count</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L153">
      <a href="#L153">153</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L154">
      <a href="#L154">154</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:li_spacer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L155">
      <a href="#L155">155</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L156">
      <a href="#L156">156</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:n</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L157">
      <a href="#L157">157</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L158">
      <a href="#L158">158</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:offsets</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L159">
      <a href="#L159">159</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L160">
      <a href="#L160">160</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:orientation_changes</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L161">
      <a href="#L161">161</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L162">
      <a href="#L162">162</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L163">
      <a href="#L163">163</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L164">
      <a href="#L164">164</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:page_links</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L165">
      <a href="#L165">165</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L166">
      <a href="#L166">166</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:pages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L167">
      <a href="#L167">167</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L168">
      <a href="#L168">168</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:pdf_version</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L169">
      <a href="#L169">169</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L170">
      <a href="#L170">170</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:prevfill_color</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L171">
      <a href="#L171">171</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L172">
      <a href="#L172">172</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:prevtext_color</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L173">
      <a href="#L173">173</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L174">
      <a href="#L174">174</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:print_header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L175">
      <a href="#L175">175</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L176">
      <a href="#L176">176</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:print_footer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L177">
      <a href="#L177">177</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L178">
      <a href="#L178">178</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:state</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L179">
      <a href="#L179">179</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L180">
      <a href="#L180">180</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tableborder</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L181">
      <a href="#L181">181</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L182">
      <a href="#L182">182</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tdbegin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L183">
      <a href="#L183">183</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L184">
      <a href="#L184">184</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tdwidth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L185">
      <a href="#L185">185</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L186">
      <a href="#L186">186</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tdheight</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L187">
      <a href="#L187">187</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L188">
      <a href="#L188">188</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tdalign</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L189">
      <a href="#L189">189</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L190">
      <a href="#L190">190</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tdfill</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L191">
      <a href="#L191">191</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L192">
      <a href="#L192">192</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:tempfontsize</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L193">
      <a href="#L193">193</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L194">
      <a href="#L194">194</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:text_color</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L195">
      <a href="#L195">195</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L196">
      <a href="#L196">196</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:underline</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L197">
      <a href="#L197">197</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L198">
      <a href="#L198">198</a>
    </th>
    <td class="line-code">
      <pre>        attr_accessor <span class="symbol">:ws</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L199">
      <a href="#L199">199</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L200">
      <a href="#L200">200</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L201">
      <a href="#L201">201</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This is the class constructor. </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L202">
      <a href="#L202">202</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># It allows to set up the page format, the orientation and </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L203">
      <a href="#L203">203</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># the measure unit used in all the methods (except for the font sizes).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L204">
      <a href="#L204">204</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L205">
      <a href="#L205">205</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :orientation page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or Portrait (default)&lt;/li&gt;&lt;li&gt;L or Landscape&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L206">
      <a href="#L206">206</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :unit User measure unit. Possible values are:&lt;ul&gt;&lt;li&gt;pt: point&lt;/li&gt;&lt;li&gt;mm: millimeter (default)&lt;/li&gt;&lt;li&gt;cm: centimeter&lt;/li&gt;&lt;li&gt;in: inch&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;A point equals 1/72 of inch, that is to say about 0.35 mm (an inch being 2.54 cm). This is a very common unit in typography; font sizes are expressed in that unit.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L207">
      <a href="#L207">207</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :format The format used for pages. It can be either one of the following values (case insensitive) or a custom format in the form of a two-element array containing the width and the height (expressed in the unit given by unit).&lt;ul&gt;&lt;li&gt;4A0&lt;/li&gt;&lt;li&gt;2A0&lt;/li&gt;&lt;li&gt;A0&lt;/li&gt;&lt;li&gt;A1&lt;/li&gt;&lt;li&gt;A2&lt;/li&gt;&lt;li&gt;A3&lt;/li&gt;&lt;li&gt;A4 (default)&lt;/li&gt;&lt;li&gt;A5&lt;/li&gt;&lt;li&gt;A6&lt;/li&gt;&lt;li&gt;A7&lt;/li&gt;&lt;li&gt;A8&lt;/li&gt;&lt;li&gt;A9&lt;/li&gt;&lt;li&gt;A10&lt;/li&gt;&lt;li&gt;B0&lt;/li&gt;&lt;li&gt;B1&lt;/li&gt;&lt;li&gt;B2&lt;/li&gt;&lt;li&gt;B3&lt;/li&gt;&lt;li&gt;B4&lt;/li&gt;&lt;li&gt;B5&lt;/li&gt;&lt;li&gt;B6&lt;/li&gt;&lt;li&gt;B7&lt;/li&gt;&lt;li&gt;B8&lt;/li&gt;&lt;li&gt;B9&lt;/li&gt;&lt;li&gt;B10&lt;/li&gt;&lt;li&gt;C0&lt;/li&gt;&lt;li&gt;C1&lt;/li&gt;&lt;li&gt;C2&lt;/li&gt;&lt;li&gt;C3&lt;/li&gt;&lt;li&gt;C4&lt;/li&gt;&lt;li&gt;C5&lt;/li&gt;&lt;li&gt;C6&lt;/li&gt;&lt;li&gt;C7&lt;/li&gt;&lt;li&gt;C8&lt;/li&gt;&lt;li&gt;C9&lt;/li&gt;&lt;li&gt;C10&lt;/li&gt;&lt;li&gt;RA0&lt;/li&gt;&lt;li&gt;RA1&lt;/li&gt;&lt;li&gt;RA2&lt;/li&gt;&lt;li&gt;RA3&lt;/li&gt;&lt;li&gt;RA4&lt;/li&gt;&lt;li&gt;SRA0&lt;/li&gt;&lt;li&gt;SRA1&lt;/li&gt;&lt;li&gt;SRA2&lt;/li&gt;&lt;li&gt;SRA3&lt;/li&gt;&lt;li&gt;SRA4&lt;/li&gt;&lt;li&gt;LETTER&lt;/li&gt;&lt;li&gt;LEGAL&lt;/li&gt;&lt;li&gt;EXECUTIVE&lt;/li&gt;&lt;li&gt;FOLIO&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L208">
      <a href="#L208">208</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :unicode TRUE means that the input text is unicode (default = true)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L209">
      <a href="#L209">209</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param String :encoding charset encoding; default is UTF-8</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L210">
      <a href="#L210">210</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L211">
      <a href="#L211">211</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">initialize</span>(orientation = <span class="string"><span class="delimiter">'</span><span class="content">P</span><span class="delimiter">'</span></span>,  unit = <span class="string"><span class="delimiter">'</span><span class="content">mm</span><span class="delimiter">'</span></span>, format = <span class="string"><span class="delimiter">'</span><span class="content">A4</span><span class="delimiter">'</span></span>, unicode = <span class="predefined-constant">true</span>, encoding = <span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L212">
      <a href="#L212">212</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L213">
      <a href="#L213">213</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># Set internal character encoding to ASCII#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L214">
      <a href="#L214">214</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#FIXME 2007-05-25 (EJM) Level=0 - </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L215">
      <a href="#L215">215</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># if (respond_to?(&quot;mb_internal_encoding&quot;) and mb_internal_encoding())</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L216">
      <a href="#L216">216</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#         @internal_encoding = mb_internal_encoding();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L217">
      <a href="#L217">217</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#         mb_internal_encoding(&quot;ASCII&quot;);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L218">
      <a href="#L218">218</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># }</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L219">
      <a href="#L219">219</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L220">
      <a href="#L220">220</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Some checks</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L221">
      <a href="#L221">221</a>
    </th>
    <td class="line-code">
      <pre>                dochecks();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L222">
      <a href="#L222">222</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L223">
      <a href="#L223">223</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">begin</span>          
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L224">
      <a href="#L224">224</a>
    </th>
    <td class="line-code">
      <pre>                  <span class="class-variable">@@decoder</span> = <span class="constant">HTMLEntities</span>.new 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L225">
      <a href="#L225">225</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">rescue</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L226">
      <a href="#L226">226</a>
    </th>
    <td class="line-code">
      <pre>                  <span class="class-variable">@@decoder</span> = <span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L227">
      <a href="#L227">227</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L228">
      <a href="#L228">228</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L229">
      <a href="#L229">229</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Initialization of properties</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L230">
      <a href="#L230">230</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@barcode</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L231">
      <a href="#L231">231</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@buffer</span> ||= <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L232">
      <a href="#L232">232</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@diffs</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L233">
      <a href="#L233">233</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L234">
      <a href="#L234">234</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@default_table_columns</span> ||= <span class="integer">4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L235">
      <a href="#L235">235</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@table_columns</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L236">
      <a href="#L236">236</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@max_table_columns</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L237">
      <a href="#L237">237</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tr_id</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L238">
      <a href="#L238">238</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@max_td_page</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L239">
      <a href="#L239">239</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@max_td_y</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L240">
      <a href="#L240">240</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@t_columns</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L241">
      <a href="#L241">241</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@default_font</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="content">FreeSans</span><span class="delimiter">&quot;</span></span> <span class="keyword">if</span> unicode
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L242">
      <a href="#L242">242</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@default_font</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="content">Helvetica</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L243">
      <a href="#L243">243</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@draw_color</span> ||= <span class="string"><span class="delimiter">'</span><span class="content">0 G</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L244">
      <a href="#L244">244</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@encoding</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L245">
      <a href="#L245">245</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fill_color</span> ||= <span class="string"><span class="delimiter">'</span><span class="content">0 g</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L246">
      <a href="#L246">246</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fonts</span> ||= {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L247">
      <a href="#L247">247</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_family</span> ||= <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L248">
      <a href="#L248">248</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_files</span> ||= {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L249">
      <a href="#L249">249</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_style</span> ||= <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L250">
      <a href="#L250">250</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size</span> ||= <span class="integer">12</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L251">
      <a href="#L251">251</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size_pt</span> ||= <span class="integer">12</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L252">
      <a href="#L252">252</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@header_width</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L253">
      <a href="#L253">253</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@header_logo</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L254">
      <a href="#L254">254</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@header_logo_width</span> ||= <span class="integer">30</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L255">
      <a href="#L255">255</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@header_title</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L256">
      <a href="#L256">256</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@header_string</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L257">
      <a href="#L257">257</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@images</span> ||= {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L258">
      <a href="#L258">258</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@img_scale</span> ||= <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L259">
      <a href="#L259">259</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@in_footer</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L260">
      <a href="#L260">260</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@is_unicode</span> = unicode
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L261">
      <a href="#L261">261</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@lasth</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L262">
      <a href="#L262">262</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@links</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L263">
      <a href="#L263">263</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@list_ordered</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L264">
      <a href="#L264">264</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@list_count</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L265">
      <a href="#L265">265</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@li_spacer</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L266">
      <a href="#L266">266</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@li_count</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L267">
      <a href="#L267">267</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@spacer</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L268">
      <a href="#L268">268</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@quote_count</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L269">
      <a href="#L269">269</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@prevquote_count</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L270">
      <a href="#L270">270</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@quote_top</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L271">
      <a href="#L271">271</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@quote_page</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L272">
      <a href="#L272">272</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@n</span> ||= <span class="integer">2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L273">
      <a href="#L273">273</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@offsets</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L274">
      <a href="#L274">274</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@orientation_changes</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L275">
      <a href="#L275">275</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@page</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L276">
      <a href="#L276">276</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@page_links</span> ||= {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L277">
      <a href="#L277">277</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@pages</span> ||= []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L278">
      <a href="#L278">278</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@pdf_version</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="content">1.3</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L279">
      <a href="#L279">279</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@prevfill_color</span> ||= [<span class="integer">255</span>,<span class="integer">255</span>,<span class="integer">255</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L280">
      <a href="#L280">280</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@prevtext_color</span> ||= [<span class="integer">0</span>,<span class="integer">0</span>,<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L281">
      <a href="#L281">281</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@print_header</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L282">
      <a href="#L282">282</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@print_footer</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L283">
      <a href="#L283">283</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L284">
      <a href="#L284">284</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tableborder</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L285">
      <a href="#L285">285</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tdbegin</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L286">
      <a href="#L286">286</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tdwidth</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L287">
      <a href="#L287">287</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tdheight</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L288">
      <a href="#L288">288</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tdalign</span> ||= <span class="string"><span class="delimiter">&quot;</span><span class="content">L</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L289">
      <a href="#L289">289</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tdfill</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L290">
      <a href="#L290">290</a>
    </th>
    <td class="line-code">
      <pre>          <span class="instance-variable">@tempfontsize</span> ||= <span class="integer">10</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L291">
      <a href="#L291">291</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@text_color</span> ||= <span class="string"><span class="delimiter">'</span><span class="content">0 g</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L292">
      <a href="#L292">292</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@underline</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L293">
      <a href="#L293">293</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@deleted</span> ||= <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L294">
      <a href="#L294">294</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@ws</span> ||= <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L295">
      <a href="#L295">295</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L296">
      <a href="#L296">296</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Standard Unicode fonts</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L297">
      <a href="#L297">297</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@core_fonts</span> = {
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L298">
      <a href="#L298">298</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">courier</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Courier</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L299">
      <a href="#L299">299</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">courierB</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Courier-Bold</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L300">
      <a href="#L300">300</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">courierI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Courier-Oblique</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L301">
      <a href="#L301">301</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">courierBI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Courier-BoldOblique</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L302">
      <a href="#L302">302</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">helvetica</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Helvetica</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L303">
      <a href="#L303">303</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">helveticaB</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Helvetica-Bold</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L304">
      <a href="#L304">304</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">helveticaI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Helvetica-Oblique</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L305">
      <a href="#L305">305</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">helveticaBI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Helvetica-BoldOblique</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L306">
      <a href="#L306">306</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">times</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Times-Roman</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L307">
      <a href="#L307">307</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">timesB</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Times-Bold</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L308">
      <a href="#L308">308</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">timesI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Times-Italic</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L309">
      <a href="#L309">309</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">timesBI</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Times-BoldItalic</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L310">
      <a href="#L310">310</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">symbol</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">Symbol</span><span class="delimiter">'</span></span>,
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L311">
      <a href="#L311">311</a>
    </th>
    <td class="line-code">
      <pre>                <span class="string"><span class="delimiter">'</span><span class="content">zapfdingbats</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">ZapfDingbats</span><span class="delimiter">'</span></span>}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L312">
      <a href="#L312">312</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L313">
      <a href="#L313">313</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Scale factor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L314">
      <a href="#L314">314</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> unit.downcase
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L315">
      <a href="#L315">315</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">pt</span><span class="delimiter">'</span></span> ; <span class="instance-variable">@k</span>=<span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L316">
      <a href="#L316">316</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">mm</span><span class="delimiter">'</span></span> ; <span class="instance-variable">@k</span>=<span class="integer">72</span>/<span class="float">25.4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L317">
      <a href="#L317">317</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">cm</span><span class="delimiter">'</span></span> ; <span class="instance-variable">@k</span>=<span class="integer">72</span>/<span class="float">2.54</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L318">
      <a href="#L318">318</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">in</span><span class="delimiter">'</span></span> ; <span class="instance-variable">@k</span>=<span class="integer">72</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L319">
      <a href="#L319">319</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span> Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect unit: </span><span class="inline"><span class="inline-delimiter">#{</span>unit<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L320">
      <a href="#L320">320</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L321">
      <a href="#L321">321</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L322">
      <a href="#L322">322</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page format</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L323">
      <a href="#L323">323</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> format.is_a?(<span class="constant">String</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L324">
      <a href="#L324">324</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># Page formats (45 standard ISO paper formats and 4 american common formats).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L325">
      <a href="#L325">325</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># Paper cordinates are calculated in this way: (inches# 72) where (1 inch = 2.54 cm)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L326">
      <a href="#L326">326</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">case</span> (format.upcase)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L327">
      <a href="#L327">327</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">4A0</span><span class="delimiter">'</span></span> ; format = [<span class="float">4767.87</span>,<span class="float">6740.79</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L328">
      <a href="#L328">328</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">2A0</span><span class="delimiter">'</span></span> ; format = [<span class="float">3370.39</span>,<span class="float">4767.87</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L329">
      <a href="#L329">329</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A0</span><span class="delimiter">'</span></span> ; format = [<span class="float">2383.94</span>,<span class="float">3370.39</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L330">
      <a href="#L330">330</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A1</span><span class="delimiter">'</span></span> ; format = [<span class="float">1683.78</span>,<span class="float">2383.94</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L331">
      <a href="#L331">331</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A2</span><span class="delimiter">'</span></span> ; format = [<span class="float">1190.55</span>,<span class="float">1683.78</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L332">
      <a href="#L332">332</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A3</span><span class="delimiter">'</span></span> ; format = [<span class="float">841.89</span>,<span class="float">1190.55</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L333">
      <a href="#L333">333</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A4</span><span class="delimiter">'</span></span> ; format = [<span class="float">595.28</span>,<span class="float">841.89</span>] <span class="comment"># ; default</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L334">
      <a href="#L334">334</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A5</span><span class="delimiter">'</span></span> ; format = [<span class="float">419.53</span>,<span class="float">595.28</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L335">
      <a href="#L335">335</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A6</span><span class="delimiter">'</span></span> ; format = [<span class="float">297.64</span>,<span class="float">419.53</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L336">
      <a href="#L336">336</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A7</span><span class="delimiter">'</span></span> ; format = [<span class="float">209.76</span>,<span class="float">297.64</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L337">
      <a href="#L337">337</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A8</span><span class="delimiter">'</span></span> ; format = [<span class="float">147.40</span>,<span class="float">209.76</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L338">
      <a href="#L338">338</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A9</span><span class="delimiter">'</span></span> ; format = [<span class="float">104.88</span>,<span class="float">147.40</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L339">
      <a href="#L339">339</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">A10</span><span class="delimiter">'</span></span> ; format = [<span class="float">73.70</span>,<span class="float">104.88</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L340">
      <a href="#L340">340</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B0</span><span class="delimiter">'</span></span> ; format = [<span class="float">2834.65</span>,<span class="float">4008.19</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L341">
      <a href="#L341">341</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B1</span><span class="delimiter">'</span></span> ; format = [<span class="float">2004.09</span>,<span class="float">2834.65</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L342">
      <a href="#L342">342</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B2</span><span class="delimiter">'</span></span> ; format = [<span class="float">1417.32</span>,<span class="float">2004.09</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L343">
      <a href="#L343">343</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B3</span><span class="delimiter">'</span></span> ; format = [<span class="float">1000.63</span>,<span class="float">1417.32</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L344">
      <a href="#L344">344</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B4</span><span class="delimiter">'</span></span> ; format = [<span class="float">708.66</span>,<span class="float">1000.63</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L345">
      <a href="#L345">345</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B5</span><span class="delimiter">'</span></span> ; format = [<span class="float">498.90</span>,<span class="float">708.66</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L346">
      <a href="#L346">346</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B6</span><span class="delimiter">'</span></span> ; format = [<span class="float">354.33</span>,<span class="float">498.90</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L347">
      <a href="#L347">347</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B7</span><span class="delimiter">'</span></span> ; format = [<span class="float">249.45</span>,<span class="float">354.33</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L348">
      <a href="#L348">348</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B8</span><span class="delimiter">'</span></span> ; format = [<span class="float">175.75</span>,<span class="float">249.45</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L349">
      <a href="#L349">349</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B9</span><span class="delimiter">'</span></span> ; format = [<span class="float">124.72</span>,<span class="float">175.75</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L350">
      <a href="#L350">350</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">B10</span><span class="delimiter">'</span></span> ; format = [<span class="float">87.87</span>,<span class="float">124.72</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L351">
      <a href="#L351">351</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C0</span><span class="delimiter">'</span></span> ; format = [<span class="float">2599.37</span>,<span class="float">3676.54</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L352">
      <a href="#L352">352</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C1</span><span class="delimiter">'</span></span> ; format = [<span class="float">1836.85</span>,<span class="float">2599.37</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L353">
      <a href="#L353">353</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C2</span><span class="delimiter">'</span></span> ; format = [<span class="float">1298.27</span>,<span class="float">1836.85</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L354">
      <a href="#L354">354</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C3</span><span class="delimiter">'</span></span> ; format = [<span class="float">918.43</span>,<span class="float">1298.27</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L355">
      <a href="#L355">355</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C4</span><span class="delimiter">'</span></span> ; format = [<span class="float">649.13</span>,<span class="float">918.43</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L356">
      <a href="#L356">356</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C5</span><span class="delimiter">'</span></span> ; format = [<span class="float">459.21</span>,<span class="float">649.13</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L357">
      <a href="#L357">357</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C6</span><span class="delimiter">'</span></span> ; format = [<span class="float">323.15</span>,<span class="float">459.21</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L358">
      <a href="#L358">358</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C7</span><span class="delimiter">'</span></span> ; format = [<span class="float">229.61</span>,<span class="float">323.15</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L359">
      <a href="#L359">359</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C8</span><span class="delimiter">'</span></span> ; format = [<span class="float">161.57</span>,<span class="float">229.61</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L360">
      <a href="#L360">360</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C9</span><span class="delimiter">'</span></span> ; format = [<span class="float">113.39</span>,<span class="float">161.57</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L361">
      <a href="#L361">361</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">C10</span><span class="delimiter">'</span></span> ; format = [<span class="float">79.37</span>,<span class="float">113.39</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L362">
      <a href="#L362">362</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">RA0</span><span class="delimiter">'</span></span> ; format = [<span class="float">2437.80</span>,<span class="float">3458.27</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L363">
      <a href="#L363">363</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">RA1</span><span class="delimiter">'</span></span> ; format = [<span class="float">1729.13</span>,<span class="float">2437.80</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L364">
      <a href="#L364">364</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">RA2</span><span class="delimiter">'</span></span> ; format = [<span class="float">1218.90</span>,<span class="float">1729.13</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L365">
      <a href="#L365">365</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">RA3</span><span class="delimiter">'</span></span> ; format = [<span class="float">864.57</span>,<span class="float">1218.90</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L366">
      <a href="#L366">366</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">RA4</span><span class="delimiter">'</span></span> ; format = [<span class="float">609.45</span>,<span class="float">864.57</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L367">
      <a href="#L367">367</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">SRA0</span><span class="delimiter">'</span></span> ; format = [<span class="float">2551.18</span>,<span class="float">3628.35</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L368">
      <a href="#L368">368</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">SRA1</span><span class="delimiter">'</span></span> ; format = [<span class="float">1814.17</span>,<span class="float">2551.18</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L369">
      <a href="#L369">369</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">SRA2</span><span class="delimiter">'</span></span> ; format = [<span class="float">1275.59</span>,<span class="float">1814.17</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L370">
      <a href="#L370">370</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">SRA3</span><span class="delimiter">'</span></span> ; format = [<span class="float">907.09</span>,<span class="float">1275.59</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L371">
      <a href="#L371">371</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">SRA4</span><span class="delimiter">'</span></span> ; format = [<span class="float">637.80</span>,<span class="float">907.09</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L372">
      <a href="#L372">372</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">LETTER</span><span class="delimiter">'</span></span> ; format = [<span class="float">612.00</span>,<span class="float">792.00</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L373">
      <a href="#L373">373</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">LEGAL</span><span class="delimiter">'</span></span> ; format = [<span class="float">612.00</span>,<span class="float">1008.00</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L374">
      <a href="#L374">374</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">EXECUTIVE</span><span class="delimiter">'</span></span> ; format = [<span class="float">521.86</span>,<span class="float">756.00</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L375">
      <a href="#L375">375</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">when</span>  <span class="string"><span class="delimiter">'</span><span class="content">FOLIO</span><span class="delimiter">'</span></span> ; format = [<span class="float">612.00</span>,<span class="float">936.00</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L376">
      <a href="#L376">376</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#else then Error(&quot;Unknown page format: #{format}&quot;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L377">
      <a href="#L377">377</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L378">
      <a href="#L378">378</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fw_pt</span> = format[<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L379">
      <a href="#L379">379</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fh_pt</span> = format[<span class="integer">1</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L380">
      <a href="#L380">380</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L381">
      <a href="#L381">381</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fw_pt</span> = format[<span class="integer">0</span>]*<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L382">
      <a href="#L382">382</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fh_pt</span> = format[<span class="integer">1</span>]*<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L383">
      <a href="#L383">383</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L384">
      <a href="#L384">384</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L385">
      <a href="#L385">385</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fw</span> = <span class="instance-variable">@fw_pt</span>/<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L386">
      <a href="#L386">386</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fh</span> = <span class="instance-variable">@fh_pt</span>/<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L387">
      <a href="#L387">387</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L388">
      <a href="#L388">388</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page orientation</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L389">
      <a href="#L389">389</a>
    </th>
    <td class="line-code">
      <pre>                orientation = orientation.downcase
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L390">
      <a href="#L390">390</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> orientation == <span class="string"><span class="delimiter">'</span><span class="content">p</span><span class="delimiter">'</span></span> <span class="keyword">or</span> orientation == <span class="string"><span class="delimiter">'</span><span class="content">portrait</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L391">
      <a href="#L391">391</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@def_orientation</span> = <span class="string"><span class="delimiter">'</span><span class="content">P</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L392">
      <a href="#L392">392</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@w_pt</span> = <span class="instance-variable">@fw_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L393">
      <a href="#L393">393</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@h_pt</span> = <span class="instance-variable">@fh_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L394">
      <a href="#L394">394</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> orientation == <span class="string"><span class="delimiter">'</span><span class="content">l</span><span class="delimiter">'</span></span> <span class="keyword">or</span> orientation == <span class="string"><span class="delimiter">'</span><span class="content">landscape</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L395">
      <a href="#L395">395</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@def_orientation</span> = <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L396">
      <a href="#L396">396</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@w_pt</span> = <span class="instance-variable">@fh_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L397">
      <a href="#L397">397</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@h_pt</span> = <span class="instance-variable">@fw_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L398">
      <a href="#L398">398</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L399">
      <a href="#L399">399</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect orientation: </span><span class="inline"><span class="inline-delimiter">#{</span>orientation<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L400">
      <a href="#L400">400</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L401">
      <a href="#L401">401</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L402">
      <a href="#L402">402</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@cur_orientation</span> = <span class="instance-variable">@def_orientation</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L403">
      <a href="#L403">403</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@w</span> = <span class="instance-variable">@w_pt</span>/<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L404">
      <a href="#L404">404</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@h</span> = <span class="instance-variable">@h_pt</span>/<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L405">
      <a href="#L405">405</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page margins (1 cm)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L406">
      <a href="#L406">406</a>
    </th>
    <td class="line-code">
      <pre>                margin = <span class="float">28.35</span>/<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L407">
      <a href="#L407">407</a>
    </th>
    <td class="line-code">
      <pre>                SetMargins(margin, margin)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L408">
      <a href="#L408">408</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Interior cell margin (1 mm)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L409">
      <a href="#L409">409</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@c_margin</span> = margin / <span class="integer">10</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L410">
      <a href="#L410">410</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Line width (0.2 mm)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L411">
      <a href="#L411">411</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@line_width</span> = <span class="float">0.567</span> / <span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L412">
      <a href="#L412">412</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Automatic page break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L413">
      <a href="#L413">413</a>
    </th>
    <td class="line-code">
      <pre>                SetAutoPageBreak(<span class="predefined-constant">true</span>, <span class="integer">2</span> * margin)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L414">
      <a href="#L414">414</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Full width display mode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L415">
      <a href="#L415">415</a>
    </th>
    <td class="line-code">
      <pre>                SetDisplayMode(<span class="string"><span class="delimiter">'</span><span class="content">fullwidth</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L416">
      <a href="#L416">416</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Compression</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L417">
      <a href="#L417">417</a>
    </th>
    <td class="line-code">
      <pre>                SetCompression(<span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L418">
      <a href="#L418">418</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set default PDF version number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L419">
      <a href="#L419">419</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@pdf_version</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">1.3</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L420">
      <a href="#L420">420</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L421">
      <a href="#L421">421</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@encoding</span> = encoding
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L422">
      <a href="#L422">422</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@b</span> = <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L423">
      <a href="#L423">423</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@i</span> = <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L424">
      <a href="#L424">424</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@u</span> = <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L425">
      <a href="#L425">425</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@href</span> = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L426">
      <a href="#L426">426</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fontlist</span> = [<span class="string"><span class="delimiter">&quot;</span><span class="content">arial</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">times</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">courier</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">helvetica</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">symbol</span><span class="delimiter">&quot;</span></span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L427">
      <a href="#L427">427</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@issetfont</span> = <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L428">
      <a href="#L428">428</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@issetcolor</span> = <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L429">
      <a href="#L429">429</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L430">
      <a href="#L430">430</a>
    </th>
    <td class="line-code">
      <pre>                SetFillColor(<span class="integer">200</span>, <span class="integer">200</span>, <span class="integer">200</span>, <span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L431">
      <a href="#L431">431</a>
    </th>
    <td class="line-code">
      <pre>                SetTextColor(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">0</span>, <span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L432">
      <a href="#L432">432</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L433">
      <a href="#L433">433</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L434">
      <a href="#L434">434</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L435">
      <a href="#L435">435</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Set the image scale.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L436">
      <a href="#L436">436</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :scale image scale.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L437">
      <a href="#L437">437</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L438">
      <a href="#L438">438</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L439">
      <a href="#L439">439</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L440">
      <a href="#L440">440</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetImageScale</span>(scale)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L441">
      <a href="#L441">441</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@img_scale</span> = scale;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L442">
      <a href="#L442">442</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L443">
      <a href="#L443">443</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_image_scale</span>, <span class="symbol">:SetImageScale</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L444">
      <a href="#L444">444</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L445">
      <a href="#L445">445</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L446">
      <a href="#L446">446</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the image scale.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L447">
      <a href="#L447">447</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return float image scale.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L448">
      <a href="#L448">448</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L449">
      <a href="#L449">449</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L450">
      <a href="#L450">450</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L451">
      <a href="#L451">451</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetImageScale</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L452">
      <a href="#L452">452</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@img_scale</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L453">
      <a href="#L453">453</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L454">
      <a href="#L454">454</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_image_scale</span>, <span class="symbol">:GetImageScale</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L455">
      <a href="#L455">455</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L456">
      <a href="#L456">456</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L457">
      <a href="#L457">457</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the page width in units.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L458">
      <a href="#L458">458</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int page width.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L459">
      <a href="#L459">459</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L460">
      <a href="#L460">460</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L461">
      <a href="#L461">461</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L462">
      <a href="#L462">462</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetPageWidth</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L463">
      <a href="#L463">463</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@w</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L464">
      <a href="#L464">464</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L465">
      <a href="#L465">465</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_page_width</span>, <span class="symbol">:GetPageWidth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L466">
      <a href="#L466">466</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L467">
      <a href="#L467">467</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L468">
      <a href="#L468">468</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the page height in units.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L469">
      <a href="#L469">469</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int page height.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L470">
      <a href="#L470">470</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L471">
      <a href="#L471">471</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L472">
      <a href="#L472">472</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L473">
      <a href="#L473">473</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetPageHeight</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L474">
      <a href="#L474">474</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@h</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L475">
      <a href="#L475">475</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L476">
      <a href="#L476">476</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_page_height</span>, <span class="symbol">:GetPageHeight</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L477">
      <a href="#L477">477</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L478">
      <a href="#L478">478</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L479">
      <a href="#L479">479</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the page break margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L480">
      <a href="#L480">480</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int page break margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L481">
      <a href="#L481">481</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L482">
      <a href="#L482">482</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L483">
      <a href="#L483">483</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L484">
      <a href="#L484">484</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetBreakMargin</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L485">
      <a href="#L485">485</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@b_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L486">
      <a href="#L486">486</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L487">
      <a href="#L487">487</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_break_margin</span>, <span class="symbol">:GetBreakMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L488">
      <a href="#L488">488</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L489">
      <a href="#L489">489</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L490">
      <a href="#L490">490</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the scale factor (number of points in user unit).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L491">
      <a href="#L491">491</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int scale factor.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L492">
      <a href="#L492">492</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L493">
      <a href="#L493">493</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L494">
      <a href="#L494">494</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L495">
      <a href="#L495">495</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetScaleFactor</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L496">
      <a href="#L496">496</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L497">
      <a href="#L497">497</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L498">
      <a href="#L498">498</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_scale_factor</span>, <span class="symbol">:GetScaleFactor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L499">
      <a href="#L499">499</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L500">
      <a href="#L500">500</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L501">
      <a href="#L501">501</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the left, top and right margins. By default, they equal 1 cm. Call this method to change them.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L502">
      <a href="#L502">502</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :left Left margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L503">
      <a href="#L503">503</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :top Top margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L504">
      <a href="#L504">504</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :right Right margin. Default value is the left one.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L505">
      <a href="#L505">505</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L506">
      <a href="#L506">506</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetLeftMargin(), SetTopMargin(), SetRightMargin(), SetAutoPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L507">
      <a href="#L507">507</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L508">
      <a href="#L508">508</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetMargins</span>(left, top, right=<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L509">
      <a href="#L509">509</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set left, top and right margins</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L510">
      <a href="#L510">510</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@l_margin</span> = left
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L511">
      <a href="#L511">511</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@t_margin</span> = top
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L512">
      <a href="#L512">512</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (right == <span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L513">
      <a href="#L513">513</a>
    </th>
    <td class="line-code">
      <pre>                        right = left
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L514">
      <a href="#L514">514</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L515">
      <a href="#L515">515</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@r_margin</span> = right
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L516">
      <a href="#L516">516</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L517">
      <a href="#L517">517</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_margins</span>, <span class="symbol">:SetMargins</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L518">
      <a href="#L518">518</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L519">
      <a href="#L519">519</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L520">
      <a href="#L520">520</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the left margin. The method can be called before creating the first page. If the current abscissa gets out of page, it is brought back to the margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L521">
      <a href="#L521">521</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :margin The margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L522">
      <a href="#L522">522</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L523">
      <a href="#L523">523</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetTopMargin(), SetRightMargin(), SetAutoPageBreak(), SetMargins()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L524">
      <a href="#L524">524</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L525">
      <a href="#L525">525</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetLeftMargin</span>(margin)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L526">
      <a href="#L526">526</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set left margin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L527">
      <a href="#L527">527</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@l_margin</span> = margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L528">
      <a href="#L528">528</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>) <span class="keyword">and</span> (<span class="instance-variable">@x</span> &lt; margin))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L529">
      <a href="#L529">529</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L530">
      <a href="#L530">530</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L531">
      <a href="#L531">531</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L532">
      <a href="#L532">532</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_left_margin</span>, <span class="symbol">:SetLeftMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L533">
      <a href="#L533">533</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L534">
      <a href="#L534">534</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L535">
      <a href="#L535">535</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the top margin. The method can be called before creating the first page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L536">
      <a href="#L536">536</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :margin The margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L537">
      <a href="#L537">537</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L538">
      <a href="#L538">538</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetLeftMargin(), SetRightMargin(), SetAutoPageBreak(), SetMargins()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L539">
      <a href="#L539">539</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L540">
      <a href="#L540">540</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetTopMargin</span>(margin)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L541">
      <a href="#L541">541</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set top margin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L542">
      <a href="#L542">542</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@t_margin</span> = margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L543">
      <a href="#L543">543</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L544">
      <a href="#L544">544</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_top_margin</span>, <span class="symbol">:SetTopMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L545">
      <a href="#L545">545</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L546">
      <a href="#L546">546</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L547">
      <a href="#L547">547</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the right margin. The method can be called before creating the first page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L548">
      <a href="#L548">548</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :margin The margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L549">
      <a href="#L549">549</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L550">
      <a href="#L550">550</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetLeftMargin(), SetTopMargin(), SetAutoPageBreak(), SetMargins()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L551">
      <a href="#L551">551</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L552">
      <a href="#L552">552</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetRightMargin</span>(margin)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L553">
      <a href="#L553">553</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set right margin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L554">
      <a href="#L554">554</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@r_margin</span> = margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L555">
      <a href="#L555">555</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L556">
      <a href="#L556">556</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_right_margin</span>, <span class="symbol">:SetRightMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L557">
      <a href="#L557">557</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L558">
      <a href="#L558">558</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L559">
      <a href="#L559">559</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Enables or disables the automatic page breaking mode. When enabling, the second parameter is the distance from the bottom of the page that defines the triggering limit. By default, the mode is on and the margin is 2 cm.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L560">
      <a href="#L560">560</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :auto Boolean indicating if mode should be on or off.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L561">
      <a href="#L561">561</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :margin Distance from the bottom of the page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L562">
      <a href="#L562">562</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L563">
      <a href="#L563">563</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Cell(), MultiCell(), AcceptPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L564">
      <a href="#L564">564</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L565">
      <a href="#L565">565</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetAutoPageBreak</span>(auto, margin=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L566">
      <a href="#L566">566</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set auto page break mode and triggering margin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L567">
      <a href="#L567">567</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@auto_page_break</span> = auto
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L568">
      <a href="#L568">568</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@b_margin</span> = margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L569">
      <a href="#L569">569</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@page_break_trigger</span> = <span class="instance-variable">@h</span> - margin
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L570">
      <a href="#L570">570</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L571">
      <a href="#L571">571</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_auto_page_break</span>, <span class="symbol">:SetAutoPageBreak</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L572">
      <a href="#L572">572</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L573">
      <a href="#L573">573</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L574">
      <a href="#L574">574</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the way the document is to be displayed by the viewer. The zoom level can be set: pages can be displayed entirely on screen, occupy the full width of the window, use real size, be scaled by a specific zooming factor or use viewer default (configured in the Preferences menu of Acrobat). The page layout can be specified too: single at once, continuous display, two columns or viewer default. By default, documents use the full width mode with continuous display.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L575">
      <a href="#L575">575</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :zoom The zoom to use. It can be one of the following string values or a number indicating the zooming factor to use. &lt;ul&gt;&lt;li&gt;fullpage: displays the entire page on screen &lt;/li&gt;&lt;li&gt;fullwidth: uses maximum width of window&lt;/li&gt;&lt;li&gt;real: uses real size (equivalent to 100% zoom)&lt;/li&gt;&lt;li&gt;default: uses viewer default mode&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L576">
      <a href="#L576">576</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :layout The page layout. Possible values are:&lt;ul&gt;&lt;li&gt;single: displays one page at once&lt;/li&gt;&lt;li&gt;continuous: displays pages continuously (default)&lt;/li&gt;&lt;li&gt;two: displays two pages on two columns&lt;/li&gt;&lt;li&gt;default: uses viewer default mode&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L577">
      <a href="#L577">577</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L578">
      <a href="#L578">578</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L579">
      <a href="#L579">579</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetDisplayMode</span>(zoom, layout = <span class="string"><span class="delimiter">'</span><span class="content">continuous</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L580">
      <a href="#L580">580</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set display mode in viewer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L581">
      <a href="#L581">581</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (zoom == <span class="string"><span class="delimiter">'</span><span class="content">fullpage</span><span class="delimiter">'</span></span> <span class="keyword">or</span> zoom == <span class="string"><span class="delimiter">'</span><span class="content">fullwidth</span><span class="delimiter">'</span></span> <span class="keyword">or</span> zoom == <span class="string"><span class="delimiter">'</span><span class="content">real</span><span class="delimiter">'</span></span> <span class="keyword">or</span> zoom == <span class="string"><span class="delimiter">'</span><span class="content">default</span><span class="delimiter">'</span></span> <span class="keyword">or</span> !zoom.is_a?(<span class="constant">String</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L582">
      <a href="#L582">582</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@zoom_mode</span> = zoom
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L583">
      <a href="#L583">583</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L584">
      <a href="#L584">584</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect zoom display mode: </span><span class="inline"><span class="inline-delimiter">#{</span>zoom<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L585">
      <a href="#L585">585</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L586">
      <a href="#L586">586</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (layout == <span class="string"><span class="delimiter">'</span><span class="content">single</span><span class="delimiter">'</span></span> <span class="keyword">or</span> layout == <span class="string"><span class="delimiter">'</span><span class="content">continuous</span><span class="delimiter">'</span></span> <span class="keyword">or</span> layout == <span class="string"><span class="delimiter">'</span><span class="content">two</span><span class="delimiter">'</span></span> <span class="keyword">or</span> layout == <span class="string"><span class="delimiter">'</span><span class="content">default</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L587">
      <a href="#L587">587</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@layout_mode</span> = layout
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L588">
      <a href="#L588">588</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L589">
      <a href="#L589">589</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect layout display mode: </span><span class="inline"><span class="inline-delimiter">#{</span>layout<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L590">
      <a href="#L590">590</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L591">
      <a href="#L591">591</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L592">
      <a href="#L592">592</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_display_mode</span>, <span class="symbol">:SetDisplayMode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L593">
      <a href="#L593">593</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L594">
      <a href="#L594">594</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L595">
      <a href="#L595">595</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Activates or deactivates page compression. When activated, the internal representation of each page is compressed, which leads to a compression ratio of about 2 for the resulting document. Compression is on by default.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L596">
      <a href="#L596">596</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Note: the Zlib extension is required for this feature. If not present, compression will be turned off.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L597">
      <a href="#L597">597</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :compress Boolean indicating if compression must be enabled.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L598">
      <a href="#L598">598</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L599">
      <a href="#L599">599</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L600">
      <a href="#L600">600</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetCompression</span>(compress)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L601">
      <a href="#L601">601</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set page compression</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L602">
      <a href="#L602">602</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (respond_to?(<span class="string"><span class="delimiter">'</span><span class="content">gzcompress</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L603">
      <a href="#L603">603</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@compress</span> = compress
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L604">
      <a href="#L604">604</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L605">
      <a href="#L605">605</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@compress</span> = <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L606">
      <a href="#L606">606</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L607">
      <a href="#L607">607</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L608">
      <a href="#L608">608</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_compression</span>, <span class="symbol">:SetCompression</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L609">
      <a href="#L609">609</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L610">
      <a href="#L610">610</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L611">
      <a href="#L611">611</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the title of the document.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L612">
      <a href="#L612">612</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :title The title.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L613">
      <a href="#L613">613</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L614">
      <a href="#L614">614</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetAuthor(), SetCreator(), SetKeywords(), SetSubject()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L615">
      <a href="#L615">615</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L616">
      <a href="#L616">616</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetTitle</span>(title)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L617">
      <a href="#L617">617</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Title of document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L618">
      <a href="#L618">618</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@title</span> = title
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L619">
      <a href="#L619">619</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L620">
      <a href="#L620">620</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_title</span>, <span class="symbol">:SetTitle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L621">
      <a href="#L621">621</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L622">
      <a href="#L622">622</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L623">
      <a href="#L623">623</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the subject of the document.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L624">
      <a href="#L624">624</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :subject The subject.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L625">
      <a href="#L625">625</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L626">
      <a href="#L626">626</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetAuthor(), SetCreator(), SetKeywords(), SetTitle()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L627">
      <a href="#L627">627</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L628">
      <a href="#L628">628</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetSubject</span>(subject)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L629">
      <a href="#L629">629</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Subject of document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L630">
      <a href="#L630">630</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@subject</span> = subject
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L631">
      <a href="#L631">631</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L632">
      <a href="#L632">632</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_subject</span>, <span class="symbol">:SetSubject</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L633">
      <a href="#L633">633</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L634">
      <a href="#L634">634</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L635">
      <a href="#L635">635</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the author of the document.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L636">
      <a href="#L636">636</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :author The name of the author.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L637">
      <a href="#L637">637</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L638">
      <a href="#L638">638</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetCreator(), SetKeywords(), SetSubject(), SetTitle()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L639">
      <a href="#L639">639</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L640">
      <a href="#L640">640</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetAuthor</span>(author)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L641">
      <a href="#L641">641</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Author of document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L642">
      <a href="#L642">642</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@author</span> = author
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L643">
      <a href="#L643">643</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L644">
      <a href="#L644">644</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_author</span>, <span class="symbol">:SetAuthor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L645">
      <a href="#L645">645</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L646">
      <a href="#L646">646</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L647">
      <a href="#L647">647</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Associates keywords with the document, generally in the form 'keyword1 keyword2 ...'.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L648">
      <a href="#L648">648</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :keywords The list of keywords.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L649">
      <a href="#L649">649</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L650">
      <a href="#L650">650</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetAuthor(), SetCreator(), SetSubject(), SetTitle()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L651">
      <a href="#L651">651</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L652">
      <a href="#L652">652</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetKeywords</span>(keywords)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L653">
      <a href="#L653">653</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Keywords of document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L654">
      <a href="#L654">654</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@keywords</span> = keywords
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L655">
      <a href="#L655">655</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L656">
      <a href="#L656">656</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_keywords</span>, <span class="symbol">:SetKeywords</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L657">
      <a href="#L657">657</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L658">
      <a href="#L658">658</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L659">
      <a href="#L659">659</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the creator of the document. This is typically the name of the application that generates the PDF.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L660">
      <a href="#L660">660</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :creator The name of the creator.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L661">
      <a href="#L661">661</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L662">
      <a href="#L662">662</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetAuthor(), SetKeywords(), SetSubject(), SetTitle()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L663">
      <a href="#L663">663</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L664">
      <a href="#L664">664</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetCreator</span>(creator)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L665">
      <a href="#L665">665</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Creator of document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L666">
      <a href="#L666">666</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@creator</span> = creator
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L667">
      <a href="#L667">667</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L668">
      <a href="#L668">668</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_creator</span>, <span class="symbol">:SetCreator</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L669">
      <a href="#L669">669</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L670">
      <a href="#L670">670</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L671">
      <a href="#L671">671</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines an alias for the total number of pages. It will be substituted as the document is closed.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L672">
      <a href="#L672">672</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;b&gt;Example:&lt;/b&gt;&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L673">
      <a href="#L673">673</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L674">
      <a href="#L674">674</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># class PDF extends TCPDF {</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L675">
      <a href="#L675">675</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         def Footer()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L676">
      <a href="#L676">676</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 #Go to 1.5 cm from bottom</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L677">
      <a href="#L677">677</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 SetY(-15);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L678">
      <a href="#L678">678</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 #Select Arial italic 8</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L679">
      <a href="#L679">679</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 SetFont('Arial','I',8);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L680">
      <a href="#L680">680</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 #Print current and total page numbers</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L681">
      <a href="#L681">681</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 Cell(0,10,'Page '.PageNo().'/{nb}',0,0,'C');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L682">
      <a href="#L682">682</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L683">
      <a href="#L683">683</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># }</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L684">
      <a href="#L684">684</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf=new PDF();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L685">
      <a href="#L685">685</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;alias_nb_pages();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L686">
      <a href="#L686">686</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L687">
      <a href="#L687">687</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :alias The alias. Default valuenb}.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L688">
      <a href="#L688">688</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L689">
      <a href="#L689">689</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see PageNo(), Footer()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L690">
      <a href="#L690">690</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L691">
      <a href="#L691">691</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">AliasNbPages</span>(alias_nb =<span class="string"><span class="delimiter">'</span><span class="content">{nb}</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L692">
      <a href="#L692">692</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Define an alias for total number of pages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L693">
      <a href="#L693">693</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@alias_nb_pages</span> = escapetext(alias_nb)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L694">
      <a href="#L694">694</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L695">
      <a href="#L695">695</a>
    </th>
    <td class="line-code">
      <pre>        alias_method <span class="symbol">:alias_nb_pages</span>, <span class="symbol">:AliasNbPages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L696">
      <a href="#L696">696</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L697">
      <a href="#L697">697</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L698">
      <a href="#L698">698</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This method is automatically called in case of fatal error; it simply outputs the message and halts the execution. An inherited class may override it to customize the error handling but should always halt the script, or the resulting document would probably be invalid.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L699">
      <a href="#L699">699</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># 2004-06-11 :: Nicola Asuni : changed bold tag with strong</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L700">
      <a href="#L700">700</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :msg The error message</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L701">
      <a href="#L701">701</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L702">
      <a href="#L702">702</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L703">
      <a href="#L703">703</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Error</span>(msg)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L704">
      <a href="#L704">704</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Fatal error</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L705">
      <a href="#L705">705</a>
    </th>
    <td class="line-code">
      <pre>                raise (<span class="string"><span class="delimiter">&quot;</span><span class="content">TCPDF error: </span><span class="inline"><span class="inline-delimiter">#{</span>msg<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L706">
      <a href="#L706">706</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L707">
      <a href="#L707">707</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:error</span>, <span class="symbol">:Error</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L708">
      <a href="#L708">708</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L709">
      <a href="#L709">709</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L710">
      <a href="#L710">710</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This method begins the generation of the PDF document. It is not necessary to call it explicitly because AddPage() does it automatically.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L711">
      <a href="#L711">711</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Note: no page is created by this method</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L712">
      <a href="#L712">712</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L713">
      <a href="#L713">713</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see AddPage(), Close()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L714">
      <a href="#L714">714</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L715">
      <a href="#L715">715</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Open</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L716">
      <a href="#L716">716</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Begin document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L717">
      <a href="#L717">717</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span> = <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L718">
      <a href="#L718">718</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L719">
      <a href="#L719">719</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># alias_method :open, :Open</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L720">
      <a href="#L720">720</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L721">
      <a href="#L721">721</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L722">
      <a href="#L722">722</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Terminates the PDF document. It is not necessary to call this method explicitly because Output() does it automatically. If the document contains no page, AddPage() is called to prevent from getting an invalid document.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L723">
      <a href="#L723">723</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L724">
      <a href="#L724">724</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Open(), Output()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L725">
      <a href="#L725">725</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L726">
      <a href="#L726">726</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Close</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L727">
      <a href="#L727">727</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Terminate document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L728">
      <a href="#L728">728</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@state</span>==<span class="integer">3</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L729">
      <a href="#L729">729</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L730">
      <a href="#L730">730</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L731">
      <a href="#L731">731</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L732">
      <a href="#L732">732</a>
    </th>
    <td class="line-code">
      <pre>                        AddPage();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L733">
      <a href="#L733">733</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L734">
      <a href="#L734">734</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page footer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L735">
      <a href="#L735">735</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@in_footer</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L736">
      <a href="#L736">736</a>
    </th>
    <td class="line-code">
      <pre>                Footer();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L737">
      <a href="#L737">737</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@in_footer</span>=<span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L738">
      <a href="#L738">738</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Close page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L739">
      <a href="#L739">739</a>
    </th>
    <td class="line-code">
      <pre>                endpage();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L740">
      <a href="#L740">740</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Close document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L741">
      <a href="#L741">741</a>
    </th>
    <td class="line-code">
      <pre>                enddoc();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L742">
      <a href="#L742">742</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L743">
      <a href="#L743">743</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># alias_method :close, :Close</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L744">
      <a href="#L744">744</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L745">
      <a href="#L745">745</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L746">
      <a href="#L746">746</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Adds a new page to the document. If a page is already present, the Footer() method is called first to output the footer. Then the page is added, the current position set to the top-left corner according to the left and top margins, and Header() is called to display the header.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L747">
      <a href="#L747">747</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The font which was set before calling is automatically restored. There is no need to call SetFont() again if you want to continue with the same font. The same is true for colors and line width.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L748">
      <a href="#L748">748</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The origin of the coordinate system is at the top-left corner and increasing ordinates go downwards.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L749">
      <a href="#L749">749</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :orientation Page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or Portrait&lt;/li&gt;&lt;li&gt;L or Landscape&lt;/li&gt;&lt;/ul&gt; The default value is the one passed to the constructor.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L750">
      <a href="#L750">750</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L751">
      <a href="#L751">751</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see TCPDF(), Header(), Footer(), SetMargins()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L752">
      <a href="#L752">752</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L753">
      <a href="#L753">753</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">AddPage</span>(orientation=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L754">
      <a href="#L754">754</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Start a new page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L755">
      <a href="#L755">755</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@state</span>==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L756">
      <a href="#L756">756</a>
    </th>
    <td class="line-code">
      <pre>                        Open();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L757">
      <a href="#L757">757</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L758">
      <a href="#L758">758</a>
    </th>
    <td class="line-code">
      <pre>                family=<span class="instance-variable">@font_family</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L759">
      <a href="#L759">759</a>
    </th>
    <td class="line-code">
      <pre>                style=<span class="instance-variable">@font_style</span> + (<span class="instance-variable">@underline</span> ? <span class="string"><span class="delimiter">'</span><span class="content">U</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) + (<span class="instance-variable">@deleted</span> ? <span class="string"><span class="delimiter">'</span><span class="content">D</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L760">
      <a href="#L760">760</a>
    </th>
    <td class="line-code">
      <pre>                size=<span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L761">
      <a href="#L761">761</a>
    </th>
    <td class="line-code">
      <pre>                lw=<span class="instance-variable">@line_width</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L762">
      <a href="#L762">762</a>
    </th>
    <td class="line-code">
      <pre>                dc=<span class="instance-variable">@draw_color</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L763">
      <a href="#L763">763</a>
    </th>
    <td class="line-code">
      <pre>                fc=<span class="instance-variable">@fill_color</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L764">
      <a href="#L764">764</a>
    </th>
    <td class="line-code">
      <pre>                tc=<span class="instance-variable">@text_color</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L765">
      <a href="#L765">765</a>
    </th>
    <td class="line-code">
      <pre>                cf=<span class="instance-variable">@color_flag</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L766">
      <a href="#L766">766</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L767">
      <a href="#L767">767</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Page footer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L768">
      <a href="#L768">768</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@in_footer</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L769">
      <a href="#L769">769</a>
    </th>
    <td class="line-code">
      <pre>                        Footer();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L770">
      <a href="#L770">770</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@in_footer</span>=<span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L771">
      <a href="#L771">771</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Close page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L772">
      <a href="#L772">772</a>
    </th>
    <td class="line-code">
      <pre>                        endpage();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L773">
      <a href="#L773">773</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L774">
      <a href="#L774">774</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Start new page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L775">
      <a href="#L775">775</a>
    </th>
    <td class="line-code">
      <pre>                beginpage(orientation);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L776">
      <a href="#L776">776</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set line cap style to square</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L777">
      <a href="#L777">777</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">2 J</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L778">
      <a href="#L778">778</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set line width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L779">
      <a href="#L779">779</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@line_width</span> = lw;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L780">
      <a href="#L780">780</a>
    </th>
    <td class="line-code">
      <pre>                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f w</span><span class="delimiter">'</span></span>, lw*<span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L781">
      <a href="#L781">781</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L782">
      <a href="#L782">782</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (family)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L783">
      <a href="#L783">783</a>
    </th>
    <td class="line-code">
      <pre>                        SetFont(family, style, size);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L784">
      <a href="#L784">784</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L785">
      <a href="#L785">785</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set colors</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L786">
      <a href="#L786">786</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@draw_color</span> = dc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L787">
      <a href="#L787">787</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (dc!=<span class="string"><span class="delimiter">'</span><span class="content">0 G</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L788">
      <a href="#L788">788</a>
    </th>
    <td class="line-code">
      <pre>                        out(dc);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L789">
      <a href="#L789">789</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L790">
      <a href="#L790">790</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fill_color</span> = fc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L791">
      <a href="#L791">791</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (fc!=<span class="string"><span class="delimiter">'</span><span class="content">0 g</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L792">
      <a href="#L792">792</a>
    </th>
    <td class="line-code">
      <pre>                        out(fc);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L793">
      <a href="#L793">793</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L794">
      <a href="#L794">794</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@text_color</span> = tc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L795">
      <a href="#L795">795</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span> = cf;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L796">
      <a href="#L796">796</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L797">
      <a href="#L797">797</a>
    </th>
    <td class="line-code">
      <pre>                Header();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L798">
      <a href="#L798">798</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Restore line width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L799">
      <a href="#L799">799</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@line_width</span> != lw)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L800">
      <a href="#L800">800</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@line_width</span> = lw;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L801">
      <a href="#L801">801</a>
    </th>
    <td class="line-code">
      <pre>                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f w</span><span class="delimiter">'</span></span>, lw*<span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L802">
      <a href="#L802">802</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L803">
      <a href="#L803">803</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Restore font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L804">
      <a href="#L804">804</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (family)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L805">
      <a href="#L805">805</a>
    </th>
    <td class="line-code">
      <pre>                        SetFont(family, style, size);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L806">
      <a href="#L806">806</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L807">
      <a href="#L807">807</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Restore colors</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L808">
      <a href="#L808">808</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@draw_color</span> != dc)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L809">
      <a href="#L809">809</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@draw_color</span> = dc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L810">
      <a href="#L810">810</a>
    </th>
    <td class="line-code">
      <pre>                        out(dc);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L811">
      <a href="#L811">811</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L812">
      <a href="#L812">812</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@fill_color</span> != fc)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L813">
      <a href="#L813">813</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fill_color</span> = fc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L814">
      <a href="#L814">814</a>
    </th>
    <td class="line-code">
      <pre>                        out(fc);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L815">
      <a href="#L815">815</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L816">
      <a href="#L816">816</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@text_color</span> = tc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L817">
      <a href="#L817">817</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span> = cf;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L818">
      <a href="#L818">818</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L819">
      <a href="#L819">819</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:add_page</span>, <span class="symbol">:AddPage</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L820">
      <a href="#L820">820</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L821">
      <a href="#L821">821</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L822">
      <a href="#L822">822</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># Rotate object.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L823">
      <a href="#L823">823</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># @param float :angle angle in degrees for counter-clockwise rotation</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L824">
      <a href="#L824">824</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># @param int :x abscissa of the rotation center. Default is current x position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L825">
      <a href="#L825">825</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># @param int :y ordinate of the rotation center. Default is current y position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L826">
      <a href="#L826">826</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L827">
      <a href="#L827">827</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="function">Rotate</span>(angle, x=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, y=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L828">
      <a href="#L828">828</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L829">
      <a href="#L829">829</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">if</span> (x == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L830">
      <a href="#L830">830</a>
    </th>
    <td class="line-code">
      <pre>                  x = <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L831">
      <a href="#L831">831</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L832">
      <a href="#L832">832</a>
    </th>
    <td class="line-code">
      <pre>          
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L833">
      <a href="#L833">833</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">if</span> (y == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L834">
      <a href="#L834">834</a>
    </th>
    <td class="line-code">
      <pre>                  y = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L835">
      <a href="#L835">835</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L836">
      <a href="#L836">836</a>
    </th>
    <td class="line-code">
      <pre>          
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L837">
      <a href="#L837">837</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">if</span> (<span class="instance-variable">@rtl</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L838">
      <a href="#L838">838</a>
    </th>
    <td class="line-code">
      <pre>                  x = <span class="instance-variable">@w</span> - x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L839">
      <a href="#L839">839</a>
    </th>
    <td class="line-code">
      <pre>                  angle = -<span class="instance-variable">@angle</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L840">
      <a href="#L840">840</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L841">
      <a href="#L841">841</a>
    </th>
    <td class="line-code">
      <pre>          
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L842">
      <a href="#L842">842</a>
    </th>
    <td class="line-code">
      <pre>          y = (<span class="instance-variable">@h</span> - y) * <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L843">
      <a href="#L843">843</a>
    </th>
    <td class="line-code">
      <pre>          x *= <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L844">
      <a href="#L844">844</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L845">
      <a href="#L845">845</a>
    </th>
    <td class="line-code">
      <pre>          <span class="comment"># calculate elements of transformation matrix</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L846">
      <a href="#L846">846</a>
    </th>
    <td class="line-code">
      <pre>          tm = []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L847">
      <a href="#L847">847</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">0</span>] = ::<span class="constant">Math</span>::cos(deg2rad(angle));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L848">
      <a href="#L848">848</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">1</span>] = ::<span class="constant">Math</span>::sin(deg2rad(angle));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L849">
      <a href="#L849">849</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">2</span>] = -tm[<span class="integer">1</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L850">
      <a href="#L850">850</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">3</span>] = tm[<span class="integer">0</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L851">
      <a href="#L851">851</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">4</span>] = x + tm[<span class="integer">1</span>] * y - tm[<span class="integer">0</span>] * x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L852">
      <a href="#L852">852</a>
    </th>
    <td class="line-code">
      <pre>          tm[<span class="integer">5</span>] = y - tm[<span class="integer">0</span>] * y - tm[<span class="integer">1</span>] * x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L853">
      <a href="#L853">853</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L854">
      <a href="#L854">854</a>
    </th>
    <td class="line-code">
      <pre>          <span class="comment"># generate the transformation matrix</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L855">
      <a href="#L855">855</a>
    </th>
    <td class="line-code">
      <pre>          Transform(tm);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L856">
      <a href="#L856">856</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L857">
      <a href="#L857">857</a>
    </th>
    <td class="line-code">
      <pre>    alias_method <span class="symbol">:rotate</span>, <span class="symbol">:Rotate</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L858">
      <a href="#L858">858</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L859">
      <a href="#L859">859</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L860">
      <a href="#L860">860</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Starts a 2D tranformation saving current graphic state.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L861">
      <a href="#L861">861</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This function must be called before scaling, mirroring, translation, rotation and skewing.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L862">
      <a href="#L862">862</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Use StartTransform() before, and StopTransform() after the transformations to restore the normal behavior.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L863">
      <a href="#L863">863</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L864">
      <a href="#L864">864</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">StartTransform</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L865">
      <a href="#L865">865</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">q</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L866">
      <a href="#L866">866</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L867">
      <a href="#L867">867</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:start_transform</span>, <span class="symbol">:StartTransform</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L868">
      <a href="#L868">868</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L869">
      <a href="#L869">869</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L870">
      <a href="#L870">870</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Stops a 2D tranformation restoring previous graphic state.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L871">
      <a href="#L871">871</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This function must be called after scaling, mirroring, translation, rotation and skewing.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L872">
      <a href="#L872">872</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Use StartTransform() before, and StopTransform() after the transformations to restore the normal behavior.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L873">
      <a href="#L873">873</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L874">
      <a href="#L874">874</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">StopTransform</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L875">
      <a href="#L875">875</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">Q</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L876">
      <a href="#L876">876</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L877">
      <a href="#L877">877</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:stop_transform</span>, <span class="symbol">:StopTransform</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L878">
      <a href="#L878">878</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L879">
      <a href="#L879">879</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L880">
      <a href="#L880">880</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Apply graphic transformations.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L881">
      <a href="#L881">881</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 2.1.000 (2008-01-07)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L882">
      <a href="#L882">882</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see StartTransform(), StopTransform()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L883">
      <a href="#L883">883</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L884">
      <a href="#L884">884</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Transform</span>(tm)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L885">
      <a href="#L885">885</a>
    </th>
    <td class="line-code">
      <pre>                x = out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f %.3f %.3f %.3f cm</span><span class="delimiter">'</span></span>, tm[<span class="integer">0</span>], tm[<span class="integer">1</span>], tm[<span class="integer">2</span>], tm[<span class="integer">3</span>], tm[<span class="integer">4</span>], tm[<span class="integer">5</span>]));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L886">
      <a href="#L886">886</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L887">
      <a href="#L887">887</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:transform</span>, <span class="symbol">:Transform</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L888">
      <a href="#L888">888</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L889">
      <a href="#L889">889</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L890">
      <a href="#L890">890</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set header data.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L891">
      <a href="#L891">891</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :ln header image logo</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L892">
      <a href="#L892">892</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :lw header image logo width in mm</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L893">
      <a href="#L893">893</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :ht string to print as title on document header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L894">
      <a href="#L894">894</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :hs string to print on document header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L895">
      <a href="#L895">895</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L896">
      <a href="#L896">896</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetHeaderData</span>(ln=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, lw=<span class="integer">0</span>, ht=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, hs=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L897">
      <a href="#L897">897</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_logo</span> = ln || <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L898">
      <a href="#L898">898</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_logo_width</span> = lw || <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L899">
      <a href="#L899">899</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_title</span> = ht || <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L900">
      <a href="#L900">900</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_string</span> = hs || <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L901">
      <a href="#L901">901</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L902">
      <a href="#L902">902</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:set_header_data</span>, <span class="symbol">:SetHeaderData</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L903">
      <a href="#L903">903</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L904">
      <a href="#L904">904</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L905">
      <a href="#L905">905</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set header margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L906">
      <a href="#L906">906</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># (minimum distance between header and top page margin)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L907">
      <a href="#L907">907</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :hm distance in millimeters</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L908">
      <a href="#L908">908</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L909">
      <a href="#L909">909</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetHeaderMargin</span>(hm=<span class="integer">10</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L910">
      <a href="#L910">910</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_margin</span> = hm;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L911">
      <a href="#L911">911</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L912">
      <a href="#L912">912</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:set_header_margin</span>, <span class="symbol">:SetHeaderMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L913">
      <a href="#L913">913</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L914">
      <a href="#L914">914</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L915">
      <a href="#L915">915</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set footer margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L916">
      <a href="#L916">916</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># (minimum distance between footer and bottom page margin)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L917">
      <a href="#L917">917</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fm distance in millimeters</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L918">
      <a href="#L918">918</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L919">
      <a href="#L919">919</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetFooterMargin</span>(fm=<span class="integer">10</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L920">
      <a href="#L920">920</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@footer_margin</span> = fm;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L921">
      <a href="#L921">921</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L922">
      <a href="#L922">922</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:set_footer_margin</span>, <span class="symbol">:SetFooterMargin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L923">
      <a href="#L923">923</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L924">
      <a href="#L924">924</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L925">
      <a href="#L925">925</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set a flag to print page header.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L926">
      <a href="#L926">926</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :val set to true to print the page header (default), false otherwise. </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L927">
      <a href="#L927">927</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L928">
      <a href="#L928">928</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetPrintHeader</span>(val=<span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L929">
      <a href="#L929">929</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@print_header</span> = val;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L930">
      <a href="#L930">930</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L931">
      <a href="#L931">931</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:set_print_header</span>, <span class="symbol">:SetPrintHeader</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L932">
      <a href="#L932">932</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L933">
      <a href="#L933">933</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L934">
      <a href="#L934">934</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set a flag to print page footer.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L935">
      <a href="#L935">935</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :value set to true to print the page footer (default), false otherwise. </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L936">
      <a href="#L936">936</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L937">
      <a href="#L937">937</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetPrintFooter</span>(val=<span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L938">
      <a href="#L938">938</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@print_footer</span> = val;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L939">
      <a href="#L939">939</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L940">
      <a href="#L940">940</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:set_print_footer</span>, <span class="symbol">:SetPrintFooter</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L941">
      <a href="#L941">941</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L942">
      <a href="#L942">942</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L943">
      <a href="#L943">943</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># This method is used to render the page header.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L944">
      <a href="#L944">944</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># It is automatically called by AddPage() and could be overwritten in your own inherited class.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L945">
      <a href="#L945">945</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L946">
      <a href="#L946">946</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Header</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L947">
      <a href="#L947">947</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@print_header</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L948">
      <a href="#L948">948</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@original_l_margin</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L949">
      <a href="#L949">949</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@original_l_margin</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L950">
      <a href="#L950">950</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L951">
      <a href="#L951">951</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@original_r_margin</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L952">
      <a href="#L952">952</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@original_r_margin</span> = <span class="instance-variable">@r_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L953">
      <a href="#L953">953</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L954">
      <a href="#L954">954</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L955">
      <a href="#L955">955</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set current position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L956">
      <a href="#L956">956</a>
    </th>
    <td class="line-code">
      <pre>                        SetXY(<span class="instance-variable">@original_l_margin</span>, <span class="instance-variable">@header_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L957">
      <a href="#L957">957</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L958">
      <a href="#L958">958</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> ((<span class="instance-variable">@header_logo</span>) <span class="keyword">and</span> (<span class="instance-variable">@header_logo</span> != <span class="class-variable">@@k_blank_image</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L959">
      <a href="#L959">959</a>
    </th>
    <td class="line-code">
      <pre>                                Image(<span class="instance-variable">@header_logo</span>, <span class="instance-variable">@original_l_margin</span>, <span class="instance-variable">@header_margin</span>, <span class="instance-variable">@header_logo_width</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L960">
      <a href="#L960">960</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L961">
      <a href="#L961">961</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@img_rb_y</span> = GetY();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L962">
      <a href="#L962">962</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L963">
      <a href="#L963">963</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L964">
      <a href="#L964">964</a>
    </th>
    <td class="line-code">
      <pre>                        cell_height = ((<span class="class-variable">@@k_cell_height_ratio</span> * <span class="instance-variable">@header_font</span>[<span class="integer">2</span>]) / <span class="instance-variable">@k</span>).round(<span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L965">
      <a href="#L965">965</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L966">
      <a href="#L966">966</a>
    </th>
    <td class="line-code">
      <pre>                        header_x = <span class="instance-variable">@original_l_margin</span> + (<span class="instance-variable">@header_logo_width</span> * <span class="float">1.05</span>); <span class="comment">#set left margin for text data cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L967">
      <a href="#L967">967</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L968">
      <a href="#L968">968</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># header title</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L969">
      <a href="#L969">969</a>
    </th>
    <td class="line-code">
      <pre>                        SetFont(<span class="instance-variable">@header_font</span>[<span class="integer">0</span>], <span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>, <span class="instance-variable">@header_font</span>[<span class="integer">2</span>] + <span class="integer">1</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L970">
      <a href="#L970">970</a>
    </th>
    <td class="line-code">
      <pre>                        SetX(header_x);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L971">
      <a href="#L971">971</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(<span class="instance-variable">@header_width</span>, cell_height, <span class="instance-variable">@header_title</span>, <span class="integer">0</span>, <span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L972">
      <a href="#L972">972</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L973">
      <a href="#L973">973</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># header string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L974">
      <a href="#L974">974</a>
    </th>
    <td class="line-code">
      <pre>                        SetFont(<span class="instance-variable">@header_font</span>[<span class="integer">0</span>], <span class="instance-variable">@header_font</span>[<span class="integer">1</span>], <span class="instance-variable">@header_font</span>[<span class="integer">2</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L975">
      <a href="#L975">975</a>
    </th>
    <td class="line-code">
      <pre>                        SetX(header_x);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L976">
      <a href="#L976">976</a>
    </th>
    <td class="line-code">
      <pre>                        MultiCell(<span class="instance-variable">@header_width</span>, cell_height, <span class="instance-variable">@header_string</span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L977">
      <a href="#L977">977</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L978">
      <a href="#L978">978</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># print an ending header line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L979">
      <a href="#L979">979</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@header_width</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L980">
      <a href="#L980">980</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#set style for cell border</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L981">
      <a href="#L981">981</a>
    </th>
    <td class="line-code">
      <pre>                                SetLineWidth(<span class="float">0.3</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L982">
      <a href="#L982">982</a>
    </th>
    <td class="line-code">
      <pre>                                SetDrawColor(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L983">
      <a href="#L983">983</a>
    </th>
    <td class="line-code">
      <pre>                                SetY(<span class="integer">1</span> + (<span class="instance-variable">@img_rb_y</span> &gt; GetY() ? <span class="instance-variable">@img_rb_y</span> : GetY()));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L984">
      <a href="#L984">984</a>
    </th>
    <td class="line-code">
      <pre>                                SetX(<span class="instance-variable">@original_l_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L985">
      <a href="#L985">985</a>
    </th>
    <td class="line-code">
      <pre>                                Cell(<span class="integer">0</span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L986">
      <a href="#L986">986</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L987">
      <a href="#L987">987</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L988">
      <a href="#L988">988</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#restore position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L989">
      <a href="#L989">989</a>
    </th>
    <td class="line-code">
      <pre>                        SetXY(<span class="instance-variable">@original_l_margin</span>, <span class="instance-variable">@t_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L990">
      <a href="#L990">990</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L991">
      <a href="#L991">991</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L992">
      <a href="#L992">992</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:header</span>, <span class="symbol">:Header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L993">
      <a href="#L993">993</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L994">
      <a href="#L994">994</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L995">
      <a href="#L995">995</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># This method is used to render the page footer. </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L996">
      <a href="#L996">996</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># It is automatically called by AddPage() and could be overwritten in your own inherited class.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L997">
      <a href="#L997">997</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L998">
      <a href="#L998">998</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Footer</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L999">
      <a href="#L999">999</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@print_footer</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1000">
      <a href="#L1000">1000</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1001">
      <a href="#L1001">1001</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@original_l_margin</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1002">
      <a href="#L1002">1002</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@original_l_margin</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1003">
      <a href="#L1003">1003</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1004">
      <a href="#L1004">1004</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@original_r_margin</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1005">
      <a href="#L1005">1005</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@original_r_margin</span> = <span class="instance-variable">@r_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1006">
      <a href="#L1006">1006</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1007">
      <a href="#L1007">1007</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1008">
      <a href="#L1008">1008</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1009">
      <a href="#L1009">1009</a>
    </th>
    <td class="line-code">
      <pre>                        SetFont(<span class="instance-variable">@footer_font</span>[<span class="integer">0</span>], <span class="instance-variable">@footer_font</span>[<span class="integer">1</span>] , <span class="instance-variable">@footer_font</span>[<span class="integer">2</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1010">
      <a href="#L1010">1010</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set style for cell border</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1011">
      <a href="#L1011">1011</a>
    </th>
    <td class="line-code">
      <pre>                        line_width = <span class="float">0.3</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1012">
      <a href="#L1012">1012</a>
    </th>
    <td class="line-code">
      <pre>                        SetLineWidth(line_width);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1013">
      <a href="#L1013">1013</a>
    </th>
    <td class="line-code">
      <pre>                        SetDrawColor(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1014">
      <a href="#L1014">1014</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1015">
      <a href="#L1015">1015</a>
    </th>
    <td class="line-code">
      <pre>                        footer_height = ((<span class="class-variable">@@k_cell_height_ratio</span> * <span class="instance-variable">@footer_font</span>[<span class="integer">2</span>]) / <span class="instance-variable">@k</span>).round; <span class="comment">#footer height, was , 2)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1016">
      <a href="#L1016">1016</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#get footer y position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1017">
      <a href="#L1017">1017</a>
    </th>
    <td class="line-code">
      <pre>                        footer_y = <span class="instance-variable">@h</span> - <span class="instance-variable">@footer_margin</span> - footer_height;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1018">
      <a href="#L1018">1018</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set current position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1019">
      <a href="#L1019">1019</a>
    </th>
    <td class="line-code">
      <pre>                        SetXY(<span class="instance-variable">@original_l_margin</span>, footer_y); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1020">
      <a href="#L1020">1020</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1021">
      <a href="#L1021">1021</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#print document barcode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1022">
      <a href="#L1022">1022</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@barcode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1023">
      <a href="#L1023">1023</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1024">
      <a href="#L1024">1024</a>
    </th>
    <td class="line-code">
      <pre>                                barcode_width = ((<span class="instance-variable">@w</span> - <span class="instance-variable">@original_l_margin</span> - <span class="instance-variable">@original_r_margin</span>)).round; <span class="comment">#max width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1025">
      <a href="#L1025">1025</a>
    </th>
    <td class="line-code">
      <pre>                                writeBarcode(<span class="instance-variable">@original_l_margin</span>, footer_y + line_width, barcode_width, footer_height - line_width, <span class="string"><span class="delimiter">&quot;</span><span class="content">C128B</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">false</span>, <span class="predefined-constant">false</span>, <span class="integer">2</span>, <span class="instance-variable">@barcode</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1026">
      <a href="#L1026">1026</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1027">
      <a href="#L1027">1027</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1028">
      <a href="#L1028">1028</a>
    </th>
    <td class="line-code">
      <pre>                        SetXY(<span class="instance-variable">@original_l_margin</span>, footer_y); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1029">
      <a href="#L1029">1029</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1030">
      <a href="#L1030">1030</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Print page number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1031">
      <a href="#L1031">1031</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(<span class="integer">0</span>, footer_height, <span class="instance-variable">@l</span>[<span class="string"><span class="delimiter">'</span><span class="content">w_page</span><span class="delimiter">'</span></span>] + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + PageNo().to_s + <span class="string"><span class="delimiter">'</span><span class="content"> / {nb}</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1032">
      <a href="#L1032">1032</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1033">
      <a href="#L1033">1033</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1034">
      <a href="#L1034">1034</a>
    </th>
    <td class="line-code">
      <pre>          alias_method <span class="symbol">:footer</span>, <span class="symbol">:Footer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1035">
      <a href="#L1035">1035</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1036">
      <a href="#L1036">1036</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1037">
      <a href="#L1037">1037</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the current page number.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1038">
      <a href="#L1038">1038</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int page number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1039">
      <a href="#L1039">1039</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1040">
      <a href="#L1040">1040</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see alias_nb_pages()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1041">
      <a href="#L1041">1041</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1042">
      <a href="#L1042">1042</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">PageNo</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1043">
      <a href="#L1043">1043</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Get current page number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1044">
      <a href="#L1044">1044</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1045">
      <a href="#L1045">1045</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1046">
      <a href="#L1046">1046</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:page_no</span>, <span class="symbol">:PageNo</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1047">
      <a href="#L1047">1047</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1048">
      <a href="#L1048">1048</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1049">
      <a href="#L1049">1049</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the color used for all drawing operations (lines, rectangles and cell borders). It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1050">
      <a href="#L1050">1050</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :r If g et b are given, red component; if not, indicates the gray level. Value between 0 and 255</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1051">
      <a href="#L1051">1051</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :g Green component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1052">
      <a href="#L1052">1052</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :b Blue component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1053">
      <a href="#L1053">1053</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.3</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1054">
      <a href="#L1054">1054</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFillColor(), SetTextColor(), Line(), Rect(), Cell(), MultiCell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1055">
      <a href="#L1055">1055</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1056">
      <a href="#L1056">1056</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetDrawColor</span>(r, g=<span class="integer">-1</span>, b=<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1057">
      <a href="#L1057">1057</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set color for all stroking operations</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1058">
      <a href="#L1058">1058</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((r==<span class="integer">0</span> <span class="keyword">and</span> g==<span class="integer">0</span> <span class="keyword">and</span> b==<span class="integer">0</span>) <span class="keyword">or</span> g==<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1059">
      <a href="#L1059">1059</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@draw_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f G</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1060">
      <a href="#L1060">1060</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1061">
      <a href="#L1061">1061</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@draw_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f RG</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>, g/<span class="float">255.0</span>, b/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1062">
      <a href="#L1062">1062</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1063">
      <a href="#L1063">1063</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1064">
      <a href="#L1064">1064</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="instance-variable">@draw_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1065">
      <a href="#L1065">1065</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1066">
      <a href="#L1066">1066</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1067">
      <a href="#L1067">1067</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_draw_color</span>, <span class="symbol">:SetDrawColor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1068">
      <a href="#L1068">1068</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1069">
      <a href="#L1069">1069</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1070">
      <a href="#L1070">1070</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the color used for all filling operations (filled rectangles and cell backgrounds). It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1071">
      <a href="#L1071">1071</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :r If g et b are given, red component; if not, indicates the gray level. Value between 0 and 255</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1072">
      <a href="#L1072">1072</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :g Green component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1073">
      <a href="#L1073">1073</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :b Blue component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1074">
      <a href="#L1074">1074</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :storeprev if true stores the RGB array on :prevfill_color variable.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1075">
      <a href="#L1075">1075</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.3</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1076">
      <a href="#L1076">1076</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetDrawColor(), SetTextColor(), Rect(), Cell(), MultiCell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1077">
      <a href="#L1077">1077</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1078">
      <a href="#L1078">1078</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetFillColor</span>(r, g=<span class="integer">-1</span>, b=<span class="integer">-1</span>, storeprev=<span class="predefined-constant">false</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1079">
      <a href="#L1079">1079</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set color for all filling operations</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1080">
      <a href="#L1080">1080</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((r==<span class="integer">0</span> <span class="keyword">and</span> g==<span class="integer">0</span> <span class="keyword">and</span> b==<span class="integer">0</span>) <span class="keyword">or</span> g==<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1081">
      <a href="#L1081">1081</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fill_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f g</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1082">
      <a href="#L1082">1082</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1083">
      <a href="#L1083">1083</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fill_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f rg</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>, g/<span class="float">255.0</span>, b/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1084">
      <a href="#L1084">1084</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1085">
      <a href="#L1085">1085</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span>=(<span class="instance-variable">@fill_color</span>!=<span class="instance-variable">@text_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1086">
      <a href="#L1086">1086</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1087">
      <a href="#L1087">1087</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="instance-variable">@fill_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1088">
      <a href="#L1088">1088</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1089">
      <a href="#L1089">1089</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (storeprev)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1090">
      <a href="#L1090">1090</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># store color as previous value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1091">
      <a href="#L1091">1091</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@prevfill_color</span> = [r, g, b]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1092">
      <a href="#L1092">1092</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1093">
      <a href="#L1093">1093</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1094">
      <a href="#L1094">1094</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_fill_color</span>, <span class="symbol">:SetFillColor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1095">
      <a href="#L1095">1095</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1096">
      <a href="#L1096">1096</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># This hasn't been ported from tcpdf, it's a variation on SetTextColor for setting cmyk colors</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1097">
      <a href="#L1097">1097</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetCmykFillColor</span>(c, m, y, k, storeprev=<span class="predefined-constant">false</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1098">
      <a href="#L1098">1098</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set color for all filling operations</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1099">
      <a href="#L1099">1099</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fill_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f %.3f k</span><span class="delimiter">'</span></span>, c, m, y, k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1100">
      <a href="#L1100">1100</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span>=(<span class="instance-variable">@fill_color</span>!=<span class="instance-variable">@text_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1101">
      <a href="#L1101">1101</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (storeprev)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1102">
      <a href="#L1102">1102</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># store color as previous value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1103">
      <a href="#L1103">1103</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@prevtext_color</span> = [c, m, y, k]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1104">
      <a href="#L1104">1104</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1105">
      <a href="#L1105">1105</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1106">
      <a href="#L1106">1106</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="instance-variable">@fill_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1107">
      <a href="#L1107">1107</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1108">
      <a href="#L1108">1108</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1109">
      <a href="#L1109">1109</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_cmyk_fill_color</span>, <span class="symbol">:SetCmykFillColor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1110">
      <a href="#L1110">1110</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1111">
      <a href="#L1111">1111</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1112">
      <a href="#L1112">1112</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the color used for text. It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1113">
      <a href="#L1113">1113</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :r If g et b are given, red component; if not, indicates the gray level. Value between 0 and 255</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1114">
      <a href="#L1114">1114</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :g Green component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1115">
      <a href="#L1115">1115</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :b Blue component (between 0 and 255)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1116">
      <a href="#L1116">1116</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :storeprev if true stores the RGB array on :prevtext_color variable.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1117">
      <a href="#L1117">1117</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.3</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1118">
      <a href="#L1118">1118</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetDrawColor(), SetFillColor(), Text(), Cell(), MultiCell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1119">
      <a href="#L1119">1119</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1120">
      <a href="#L1120">1120</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetTextColor</span>(r, g=<span class="integer">-1</span>, b=<span class="integer">-1</span>, storeprev=<span class="predefined-constant">false</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1121">
      <a href="#L1121">1121</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set color for text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1122">
      <a href="#L1122">1122</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((r==<span class="integer">0</span> <span class="keyword">and</span> <span class="symbol">:g</span>==<span class="integer">0</span> <span class="keyword">and</span> <span class="symbol">:b</span>==<span class="integer">0</span>) <span class="keyword">or</span> <span class="symbol">:g</span>==<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1123">
      <a href="#L1123">1123</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@text_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f g</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1124">
      <a href="#L1124">1124</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1125">
      <a href="#L1125">1125</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@text_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f rg</span><span class="delimiter">'</span></span>, r/<span class="float">255.0</span>, g/<span class="float">255.0</span>, b/<span class="float">255.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1126">
      <a href="#L1126">1126</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1127">
      <a href="#L1127">1127</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span>=(<span class="instance-variable">@fill_color</span>!=<span class="instance-variable">@text_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1128">
      <a href="#L1128">1128</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (storeprev)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1129">
      <a href="#L1129">1129</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># store color as previous value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1130">
      <a href="#L1130">1130</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@prevtext_color</span> = [r, g, b]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1131">
      <a href="#L1131">1131</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1132">
      <a href="#L1132">1132</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1133">
      <a href="#L1133">1133</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_text_color</span>, <span class="symbol">:SetTextColor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1134">
      <a href="#L1134">1134</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1135">
      <a href="#L1135">1135</a>
    </th>
    <td class="line-code">
      <pre>  <span class="comment"># This hasn't been ported from tcpdf, it's a variation on SetTextColor for setting cmyk colors</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1136">
      <a href="#L1136">1136</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetCmykTextColor</span>(c, m, y, k, storeprev=<span class="predefined-constant">false</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1137">
      <a href="#L1137">1137</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set color for text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1138">
      <a href="#L1138">1138</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@text_color</span>=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f %.3f %.3f %.3f k</span><span class="delimiter">'</span></span>, c, m, y, k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1139">
      <a href="#L1139">1139</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@color_flag</span>=(<span class="instance-variable">@fill_color</span>!=<span class="instance-variable">@text_color</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1140">
      <a href="#L1140">1140</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (storeprev)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1141">
      <a href="#L1141">1141</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># store color as previous value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1142">
      <a href="#L1142">1142</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@prevtext_color</span> = [c, m, y, k]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1143">
      <a href="#L1143">1143</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1144">
      <a href="#L1144">1144</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1145">
      <a href="#L1145">1145</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_cmyk_text_color</span>, <span class="symbol">:SetCmykTextColor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1146">
      <a href="#L1146">1146</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1147">
      <a href="#L1147">1147</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1148">
      <a href="#L1148">1148</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the length of a string in user unit. A font must be selected.&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1149">
      <a href="#L1149">1149</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Support UTF-8 Unicode [Nicola Asuni, 2005-01-02]</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1150">
      <a href="#L1150">1150</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :s The string whose length is to be computed</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1151">
      <a href="#L1151">1151</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1152">
      <a href="#L1152">1152</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1153">
      <a href="#L1153">1153</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1154">
      <a href="#L1154">1154</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetStringWidth</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1155">
      <a href="#L1155">1155</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Get width of a string in the current font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1156">
      <a href="#L1156">1156</a>
    </th>
    <td class="line-code">
      <pre>                s = s.to_s;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1157">
      <a href="#L1157">1157</a>
    </th>
    <td class="line-code">
      <pre>                cw = <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1158">
      <a href="#L1158">1158</a>
    </th>
    <td class="line-code">
      <pre>                w = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1159">
      <a href="#L1159">1159</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1160">
      <a href="#L1160">1160</a>
    </th>
    <td class="line-code">
      <pre>      unicode = UTF8StringToArray(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1161">
      <a href="#L1161">1161</a>
    </th>
    <td class="line-code">
      <pre>      unicode.each <span class="keyword">do</span> |char|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1162">
      <a href="#L1162">1162</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!cw[char].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1163">
      <a href="#L1163">1163</a>
    </th>
    <td class="line-code">
      <pre>                                        w += cw[char];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1164">
      <a href="#L1164">1164</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># This should not happen. UTF8StringToArray should guarentee the array is ascii values.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1165">
      <a href="#L1165">1165</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># elsif (c!cw[char[0]].nil?)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1166">
      <a href="#L1166">1166</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   w += cw[char[0]];</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1167">
      <a href="#L1167">1167</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         elsif (!cw[char.chr].nil?)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1168">
      <a href="#L1168">1168</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#           w += cw[char.chr];</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1169">
      <a href="#L1169">1169</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> (!<span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">MissingWidth</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1170">
      <a href="#L1170">1170</a>
    </th>
    <td class="line-code">
      <pre>                                        w += <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">MissingWidth</span><span class="delimiter">'</span></span>]; <span class="comment"># set default size</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1171">
      <a href="#L1171">1171</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1172">
      <a href="#L1172">1172</a>
    </th>
    <td class="line-code">
      <pre>                                        w += <span class="integer">500</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1173">
      <a href="#L1173">1173</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1174">
      <a href="#L1174">1174</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1175">
      <a href="#L1175">1175</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1176">
      <a href="#L1176">1176</a>
    </th>
    <td class="line-code">
      <pre>                  s.each_byte <span class="keyword">do</span> |c|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1177">
      <a href="#L1177">1177</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> cw[c.chr]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1178">
      <a href="#L1178">1178</a>
    </th>
    <td class="line-code">
      <pre>                                        w += cw[c.chr];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1179">
      <a href="#L1179">1179</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> cw[<span class="integer">?c</span>.chr]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1180">
      <a href="#L1180">1180</a>
    </th>
    <td class="line-code">
      <pre>                                        w += cw[<span class="integer">?c</span>.chr]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1181">
      <a href="#L1181">1181</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1182">
      <a href="#L1182">1182</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1183">
      <a href="#L1183">1183</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1184">
      <a href="#L1184">1184</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> (w * <span class="instance-variable">@font_size</span> / <span class="float">1000.0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1185">
      <a href="#L1185">1185</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1186">
      <a href="#L1186">1186</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_string_width</span>, <span class="symbol">:GetStringWidth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1187">
      <a href="#L1187">1187</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1188">
      <a href="#L1188">1188</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1189">
      <a href="#L1189">1189</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the line width. By default, the value equals 0.2 mm. The method can be called before the first page is created and the value is retained from page to page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1190">
      <a href="#L1190">1190</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :width The width.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1191">
      <a href="#L1191">1191</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1192">
      <a href="#L1192">1192</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Line(), Rect(), Cell(), MultiCell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1193">
      <a href="#L1193">1193</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1194">
      <a href="#L1194">1194</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetLineWidth</span>(width)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1195">
      <a href="#L1195">1195</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set line width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1196">
      <a href="#L1196">1196</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@line_width</span> = width;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1197">
      <a href="#L1197">1197</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1198">
      <a href="#L1198">1198</a>
    </th>
    <td class="line-code">
      <pre>                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f w</span><span class="delimiter">'</span></span>, width*<span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1199">
      <a href="#L1199">1199</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1200">
      <a href="#L1200">1200</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1201">
      <a href="#L1201">1201</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_line_width</span>, <span class="symbol">:SetLineWidth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1202">
      <a href="#L1202">1202</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1203">
      <a href="#L1203">1203</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1204">
      <a href="#L1204">1204</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Draws a line between two points.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1205">
      <a href="#L1205">1205</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x1 Abscissa of first point</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1206">
      <a href="#L1206">1206</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y1 Ordinate of first point</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1207">
      <a href="#L1207">1207</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x2 Abscissa of second point</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1208">
      <a href="#L1208">1208</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y2 Ordinate of second point</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1209">
      <a href="#L1209">1209</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1210">
      <a href="#L1210">1210</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetLineWidth(), SetDrawColor()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1211">
      <a href="#L1211">1211</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1212">
      <a href="#L1212">1212</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Line</span>(x1, y1, x2, y2)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1213">
      <a href="#L1213">1213</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Draw a line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1214">
      <a href="#L1214">1214</a>
    </th>
    <td class="line-code">
      <pre>                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f m %.2f %.2f l S</span><span class="delimiter">'</span></span>, x1 * <span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span> - y1) * <span class="instance-variable">@k</span>, x2 * <span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span> - y2) * <span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1215">
      <a href="#L1215">1215</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1216">
      <a href="#L1216">1216</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:line</span>, <span class="symbol">:Line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1217">
      <a href="#L1217">1217</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1218">
      <a href="#L1218">1218</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="function">Circle</span>(mid_x, mid_y, radius, style=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1219">
      <a href="#L1219">1219</a>
    </th>
    <td class="line-code">
      <pre>    mid_y = (<span class="instance-variable">@h</span>-mid_y)*<span class="instance-variable">@k</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1220">
      <a href="#L1220">1220</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">q</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)) <span class="comment"># postscript content in pdf</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1221">
      <a href="#L1221">1221</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># init line type etc. with /GSD gs G g (grey) RG rg (RGB) w=line witdh etc. </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1222">
      <a href="#L1222">1222</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">1 j</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)) <span class="comment"># line join</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1223">
      <a href="#L1223">1223</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># translate (&quot;move&quot;) circle to mid_y, mid_y</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1224">
      <a href="#L1224">1224</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">1 0 0 1 %f %f cm</span><span class="delimiter">&quot;</span></span>, mid_x, mid_y))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1225">
      <a href="#L1225">1225</a>
    </th>
    <td class="line-code">
      <pre>    kappa = <span class="float">0.5522847498307933984022516322796</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1226">
      <a href="#L1226">1226</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Quadrant 1 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1227">
      <a href="#L1227">1227</a>
    </th>
    <td class="line-code">
      <pre>    x_s = <span class="float">0.0</span> <span class="comment"># 12 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1228">
      <a href="#L1228">1228</a>
    </th>
    <td class="line-code">
      <pre>    y_s = <span class="float">0.0</span> + radius
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1229">
      <a href="#L1229">1229</a>
    </th>
    <td class="line-code">
      <pre>    x_e = <span class="float">0.0</span> + radius <span class="comment"># 3 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1230">
      <a href="#L1230">1230</a>
    </th>
    <td class="line-code">
      <pre>    y_e = <span class="float">0.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1231">
      <a href="#L1231">1231</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%f %f m</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, x_s, y_s)) <span class="comment"># move to 12 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1232">
      <a href="#L1232">1232</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># cubic bezier control point 1, start height and kappa * radius to the right </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1233">
      <a href="#L1233">1233</a>
    </th>
    <td class="line-code">
      <pre>    bx_e1 = x_s + (radius * kappa)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1234">
      <a href="#L1234">1234</a>
    </th>
    <td class="line-code">
      <pre>    by_e1 = y_s
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1235">
      <a href="#L1235">1235</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># cubic bezier control point 2, end and kappa * radius above </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1236">
      <a href="#L1236">1236</a>
    </th>
    <td class="line-code">
      <pre>    bx_e2 = x_e
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1237">
      <a href="#L1237">1237</a>
    </th>
    <td class="line-code">
      <pre>    by_e2 = y_e + (radius * kappa)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1238">
      <a href="#L1238">1238</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># draw cubic bezier from current point to x_e/y_e with bx_e1/by_e1 and bx_e2/by_e2 as bezier control points</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1239">
      <a href="#L1239">1239</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%f %f %f %f %f %f c</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, bx_e1, by_e1, bx_e2, by_e2, x_e, y_e))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1240">
      <a href="#L1240">1240</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Quadrant 2 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1241">
      <a href="#L1241">1241</a>
    </th>
    <td class="line-code">
      <pre>    x_s = x_e 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1242">
      <a href="#L1242">1242</a>
    </th>
    <td class="line-code">
      <pre>    y_s = y_e <span class="comment"># 3 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1243">
      <a href="#L1243">1243</a>
    </th>
    <td class="line-code">
      <pre>    x_e = <span class="float">0.0</span> 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1244">
      <a href="#L1244">1244</a>
    </th>
    <td class="line-code">
      <pre>    y_e = <span class="float">0.0</span> - radius <span class="comment"># 6 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1245">
      <a href="#L1245">1245</a>
    </th>
    <td class="line-code">
      <pre>    bx_e1 = x_s <span class="comment"># cubic bezier point 1 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1246">
      <a href="#L1246">1246</a>
    </th>
    <td class="line-code">
      <pre>    by_e1 = y_s - (radius * kappa)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1247">
      <a href="#L1247">1247</a>
    </th>
    <td class="line-code">
      <pre>    bx_e2 = x_e + (radius * kappa) <span class="comment"># cubic bezier point 2 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1248">
      <a href="#L1248">1248</a>
    </th>
    <td class="line-code">
      <pre>    by_e2 = y_e
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1249">
      <a href="#L1249">1249</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%f %f %f %f %f %f c</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, bx_e1, by_e1, bx_e2, by_e2, x_e, y_e))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1250">
      <a href="#L1250">1250</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Quadrant 3 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1251">
      <a href="#L1251">1251</a>
    </th>
    <td class="line-code">
      <pre>    x_s = x_e 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1252">
      <a href="#L1252">1252</a>
    </th>
    <td class="line-code">
      <pre>    y_s = y_e <span class="comment"># 6 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1253">
      <a href="#L1253">1253</a>
    </th>
    <td class="line-code">
      <pre>    x_e = <span class="float">0.0</span> - radius
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1254">
      <a href="#L1254">1254</a>
    </th>
    <td class="line-code">
      <pre>    y_e = <span class="float">0.0</span> <span class="comment"># 9 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1255">
      <a href="#L1255">1255</a>
    </th>
    <td class="line-code">
      <pre>    bx_e1 = x_s - (radius * kappa) <span class="comment"># cubic bezier point 1 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1256">
      <a href="#L1256">1256</a>
    </th>
    <td class="line-code">
      <pre>    by_e1 = y_s
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1257">
      <a href="#L1257">1257</a>
    </th>
    <td class="line-code">
      <pre>    bx_e2 = x_e <span class="comment"># cubic bezier point 2 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1258">
      <a href="#L1258">1258</a>
    </th>
    <td class="line-code">
      <pre>    by_e2 = y_e - (radius * kappa)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1259">
      <a href="#L1259">1259</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%f %f %f %f %f %f c</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, bx_e1, by_e1, bx_e2, by_e2, x_e, y_e))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1260">
      <a href="#L1260">1260</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Quadrant 4 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1261">
      <a href="#L1261">1261</a>
    </th>
    <td class="line-code">
      <pre>    x_s = x_e 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1262">
      <a href="#L1262">1262</a>
    </th>
    <td class="line-code">
      <pre>    y_s = y_e <span class="comment"># 9 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1263">
      <a href="#L1263">1263</a>
    </th>
    <td class="line-code">
      <pre>    x_e = <span class="float">0.0</span> 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1264">
      <a href="#L1264">1264</a>
    </th>
    <td class="line-code">
      <pre>    y_e = <span class="float">0.0</span> + radius <span class="comment"># 12 o'clock </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1265">
      <a href="#L1265">1265</a>
    </th>
    <td class="line-code">
      <pre>    bx_e1 = x_s <span class="comment"># cubic bezier point 1 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1266">
      <a href="#L1266">1266</a>
    </th>
    <td class="line-code">
      <pre>    by_e1 = y_s + (radius * kappa)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1267">
      <a href="#L1267">1267</a>
    </th>
    <td class="line-code">
      <pre>    bx_e2 = x_e - (radius * kappa) <span class="comment"># cubic bezier point 2 </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1268">
      <a href="#L1268">1268</a>
    </th>
    <td class="line-code">
      <pre>    by_e2 = y_e
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1269">
      <a href="#L1269">1269</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%f %f %f %f %f %f c</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, bx_e1, by_e1, bx_e2, by_e2, x_e, y_e))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1270">
      <a href="#L1270">1270</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">if</span> style==<span class="string"><span class="delimiter">'</span><span class="content">F</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1271">
      <a href="#L1271">1271</a>
    </th>
    <td class="line-code">
      <pre>        op=<span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1272">
      <a href="#L1272">1272</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">elsif</span> style==<span class="string"><span class="delimiter">'</span><span class="content">FD</span><span class="delimiter">'</span></span> <span class="keyword">or</span> style==<span class="string"><span class="delimiter">'</span><span class="content">DF</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1273">
      <a href="#L1273">1273</a>
    </th>
    <td class="line-code">
      <pre>        op=<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1274">
      <a href="#L1274">1274</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1275">
      <a href="#L1275">1275</a>
    </th>
    <td class="line-code">
      <pre>        op=<span class="string"><span class="delimiter">'</span><span class="content">s</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1276">
      <a href="#L1276">1276</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1277">
      <a href="#L1277">1277</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>op<span class="inline-delimiter">}</span></span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)) <span class="comment"># stroke circle, do not fill and close path </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1278">
      <a href="#L1278">1278</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># for filling etc. b, b*, f, f*</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1279">
      <a href="#L1279">1279</a>
    </th>
    <td class="line-code">
      <pre>    out(sprintf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Q</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)) <span class="comment"># finish postscript in PDF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1280">
      <a href="#L1280">1280</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1281">
      <a href="#L1281">1281</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:circle</span>, <span class="symbol">:Circle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1282">
      <a href="#L1282">1282</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1283">
      <a href="#L1283">1283</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1284">
      <a href="#L1284">1284</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Outputs a rectangle. It can be drawn (border only), filled (with no border) or both.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1285">
      <a href="#L1285">1285</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x Abscissa of upper-left corner</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1286">
      <a href="#L1286">1286</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y Ordinate of upper-left corner</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1287">
      <a href="#L1287">1287</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Width</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1288">
      <a href="#L1288">1288</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Height</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1289">
      <a href="#L1289">1289</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :style Style of rendering. Possible values are:&lt;ul&gt;&lt;li&gt;D or empty string: draw (default)&lt;/li&gt;&lt;li&gt;F: fill&lt;/li&gt;&lt;li&gt;DF or FD: draw and fill&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1290">
      <a href="#L1290">1290</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1291">
      <a href="#L1291">1291</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetLineWidth(), SetDrawColor(), SetFillColor()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1292">
      <a href="#L1292">1292</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1293">
      <a href="#L1293">1293</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Rect</span>(x, y, w, h, style=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1294">
      <a href="#L1294">1294</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Draw a rectangle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1295">
      <a href="#L1295">1295</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style==<span class="string"><span class="delimiter">'</span><span class="content">F</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1296">
      <a href="#L1296">1296</a>
    </th>
    <td class="line-code">
      <pre>                        op=<span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1297">
      <a href="#L1297">1297</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (style==<span class="string"><span class="delimiter">'</span><span class="content">FD</span><span class="delimiter">'</span></span> <span class="keyword">or</span> style==<span class="string"><span class="delimiter">'</span><span class="content">DF</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1298">
      <a href="#L1298">1298</a>
    </th>
    <td class="line-code">
      <pre>                        op=<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1299">
      <a href="#L1299">1299</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1300">
      <a href="#L1300">1300</a>
    </th>
    <td class="line-code">
      <pre>                        op=<span class="string"><span class="delimiter">'</span><span class="content">S</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1301">
      <a href="#L1301">1301</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1302">
      <a href="#L1302">1302</a>
    </th>
    <td class="line-code">
      <pre>                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f %.2f %.2f re %s</span><span class="delimiter">'</span></span>, x * <span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span> - y) * <span class="instance-variable">@k</span>, w * <span class="instance-variable">@k</span>, -h * <span class="instance-variable">@k</span>, op));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1303">
      <a href="#L1303">1303</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1304">
      <a href="#L1304">1304</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:rect</span>, <span class="symbol">:Rect</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1305">
      <a href="#L1305">1305</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1306">
      <a href="#L1306">1306</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1307">
      <a href="#L1307">1307</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Imports a TrueType or Type1 font and makes it available. It is necessary to generate a font definition file first with the makefont.rb utility. The definition file (and the font file itself when embedding) must be present either in the current directory or in the one indicated by FPDF_FONTPATH if the constant is defined. If it could not be found, the error &quot;Could not include font definition file&quot; is generated.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1308">
      <a href="#L1308">1308</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Support UTF-8 Unicode [Nicola Asuni, 2005-01-02].</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1309">
      <a href="#L1309">1309</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;b&gt;Example&lt;/b&gt;:&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1310">
      <a href="#L1310">1310</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1311">
      <a href="#L1311">1311</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;AddFont('Comic','I');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1312">
      <a href="#L1312">1312</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># # is equivalent to:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1313">
      <a href="#L1313">1313</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;AddFont('Comic','I','comici.rb');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1314">
      <a href="#L1314">1314</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1315">
      <a href="#L1315">1315</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :family Font family. The name can be chosen arbitrarily. If it is a standard family name, it will override the corresponding font.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1316">
      <a href="#L1316">1316</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :style Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular (default)&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;BI or IB: bold italic&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1317">
      <a href="#L1317">1317</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :file The font definition file. By default, the name is built from the family and style, in lower case with no space.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1318">
      <a href="#L1318">1318</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1319">
      <a href="#L1319">1319</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1320">
      <a href="#L1320">1320</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1321">
      <a href="#L1321">1321</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">AddFont</span>(family, style=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, file=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1322">
      <a href="#L1322">1322</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (family.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1323">
      <a href="#L1323">1323</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1324">
      <a href="#L1324">1324</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1325">
      <a href="#L1325">1325</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1326">
      <a href="#L1326">1326</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Add a TrueType or Type1 font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1327">
      <a href="#L1327">1327</a>
    </th>
    <td class="line-code">
      <pre>                family = family.downcase
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1328">
      <a href="#L1328">1328</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((!<span class="instance-variable">@is_unicode</span>) <span class="keyword">and</span> (family == <span class="string"><span class="delimiter">'</span><span class="content">arial</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1329">
      <a href="#L1329">1329</a>
    </th>
    <td class="line-code">
      <pre>                        family = <span class="string"><span class="delimiter">'</span><span class="content">helvetica</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1330">
      <a href="#L1330">1330</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1331">
      <a href="#L1331">1331</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1332">
      <a href="#L1332">1332</a>
    </th>
    <td class="line-code">
      <pre>                style=style.upcase
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1333">
      <a href="#L1333">1333</a>
    </th>
    <td class="line-code">
      <pre>                style=style.gsub(<span class="string"><span class="delimiter">'</span><span class="content">U</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1334">
      <a href="#L1334">1334</a>
    </th>
    <td class="line-code">
      <pre>                style=style.gsub(<span class="string"><span class="delimiter">'</span><span class="content">D</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1335">
      <a href="#L1335">1335</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style == <span class="string"><span class="delimiter">'</span><span class="content">IB</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1336">
      <a href="#L1336">1336</a>
    </th>
    <td class="line-code">
      <pre>                        style = <span class="string"><span class="delimiter">'</span><span class="content">BI</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1337">
      <a href="#L1337">1337</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1338">
      <a href="#L1338">1338</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1339">
      <a href="#L1339">1339</a>
    </th>
    <td class="line-code">
      <pre>                fontkey = family + style;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1340">
      <a href="#L1340">1340</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># check if the font has been already added</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1341">
      <a href="#L1341">1341</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> !<span class="instance-variable">@fonts</span>[fontkey].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1342">
      <a href="#L1342">1342</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1343">
      <a href="#L1343">1343</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1344">
      <a href="#L1344">1344</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1345">
      <a href="#L1345">1345</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (file==<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1346">
      <a href="#L1346">1346</a>
    </th>
    <td class="line-code">
      <pre>                        file = family.gsub(<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) + style.downcase + <span class="string"><span class="delimiter">'</span><span class="content">.rb</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1347">
      <a href="#L1347">1347</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1348">
      <a href="#L1348">1348</a>
    </th>
    <td class="line-code">
      <pre>                font_file_name = getfontpath(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1349">
      <a href="#L1349">1349</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (font_file_name.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1350">
      <a href="#L1350">1350</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># try to load the basic file without styles</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1351">
      <a href="#L1351">1351</a>
    </th>
    <td class="line-code">
      <pre>                        file = family.gsub(<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) + <span class="string"><span class="delimiter">'</span><span class="content">.rb</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1352">
      <a href="#L1352">1352</a>
    </th>
    <td class="line-code">
      <pre>                  font_file_name = getfontpath(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1353">
      <a href="#L1353">1353</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1354">
      <a href="#L1354">1354</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">if</span> font_file_name.nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1355">
      <a href="#L1355">1355</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Could not find font </span><span class="inline"><span class="inline-delimiter">#{</span>file<span class="inline-delimiter">}</span></span><span class="content">.</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1356">
      <a href="#L1356">1356</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1357">
      <a href="#L1357">1357</a>
    </th>
    <td class="line-code">
      <pre>                require(getfontpath(file))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1358">
      <a href="#L1358">1358</a>
    </th>
    <td class="line-code">
      <pre>                font_desc = <span class="constant">TCPDFFontDescriptor</span>.font(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1359">
      <a href="#L1359">1359</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1360">
      <a href="#L1360">1360</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (font_desc[<span class="symbol">:name</span>].nil? <span class="keyword">and</span> <span class="class-variable">@@fpdf_charwidths</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1361">
      <a href="#L1361">1361</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Could not include font definition file</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1362">
      <a href="#L1362">1362</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1363">
      <a href="#L1363">1363</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1364">
      <a href="#L1364">1364</a>
    </th>
    <td class="line-code">
      <pre>                i = <span class="instance-variable">@fonts</span>.length+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1365">
      <a href="#L1365">1365</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1366">
      <a href="#L1366">1366</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fonts</span>[fontkey] = {<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span> =&gt; i, <span class="string"><span class="delimiter">'</span><span class="content">type</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:type</span>], <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:name</span>], <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:desc</span>], <span class="string"><span class="delimiter">'</span><span class="content">up</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:up</span>], <span class="string"><span class="delimiter">'</span><span class="content">ut</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:ut</span>], <span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:cw</span>], <span class="string"><span class="delimiter">'</span><span class="content">enc</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:enc</span>], <span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:file</span>], <span class="string"><span class="delimiter">'</span><span class="content">ctg</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:ctg</span>], <span class="string"><span class="delimiter">'</span><span class="content">cMap</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:cMap</span>], <span class="string"><span class="delimiter">'</span><span class="content">registry</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:registry</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1367">
      <a href="#L1367">1367</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="class-variable">@@fpdf_charwidths</span>[fontkey] = font_desc[<span class="symbol">:cw</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1368">
      <a href="#L1368">1368</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1369">
      <a href="#L1369">1369</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fonts</span>[fontkey]={<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span> =&gt; i, <span class="string"><span class="delimiter">'</span><span class="content">type</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">core</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>=&gt;<span class="instance-variable">@core_fonts</span>[fontkey], <span class="string"><span class="delimiter">'</span><span class="content">up</span><span class="delimiter">'</span></span>=&gt;<span class="integer">-100</span>, <span class="string"><span class="delimiter">'</span><span class="content">ut</span><span class="delimiter">'</span></span>=&gt;<span class="integer">50</span>, <span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:cw</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1370">
      <a href="#L1370">1370</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="class-variable">@@fpdf_charwidths</span>[fontkey] = font_desc[<span class="symbol">:cw</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1371">
      <a href="#L1371">1371</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1372">
      <a href="#L1372">1372</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1373">
      <a href="#L1373">1373</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!font_desc[<span class="symbol">:diff</span>].nil? <span class="keyword">and</span> (!font_desc[<span class="symbol">:diff</span>].empty?))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1374">
      <a href="#L1374">1374</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Search existing encodings</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1375">
      <a href="#L1375">1375</a>
    </th>
    <td class="line-code">
      <pre>                        d=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1376">
      <a href="#L1376">1376</a>
    </th>
    <td class="line-code">
      <pre>                        nb=<span class="instance-variable">@diffs</span>.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1377">
      <a href="#L1377">1377</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="integer">1</span>.upto(nb) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1378">
      <a href="#L1378">1378</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@diffs</span>[i]== font_desc[<span class="symbol">:diff</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1379">
      <a href="#L1379">1379</a>
    </th>
    <td class="line-code">
      <pre>                                        d = i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1380">
      <a href="#L1380">1380</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">break</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1381">
      <a href="#L1381">1381</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1382">
      <a href="#L1382">1382</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1383">
      <a href="#L1383">1383</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (d==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1384">
      <a href="#L1384">1384</a>
    </th>
    <td class="line-code">
      <pre>                                d = nb+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1385">
      <a href="#L1385">1385</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@diffs</span>[d] = font_desc[<span class="symbol">:diff</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1386">
      <a href="#L1386">1386</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1387">
      <a href="#L1387">1387</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fonts</span>[fontkey][<span class="string"><span class="delimiter">'</span><span class="content">diff</span><span class="delimiter">'</span></span>] = d;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1388">
      <a href="#L1388">1388</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1389">
      <a href="#L1389">1389</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (font_desc[<span class="symbol">:file</span>] <span class="keyword">and</span> font_desc[<span class="symbol">:file</span>].length &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1390">
      <a href="#L1390">1390</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (font_desc[<span class="symbol">:type</span>] == <span class="string"><span class="delimiter">&quot;</span><span class="content">TrueType</span><span class="delimiter">&quot;</span></span>) <span class="keyword">or</span> (font_desc[<span class="symbol">:type</span>] == <span class="string"><span class="delimiter">&quot;</span><span class="content">TrueTypeUnicode</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1391">
      <a href="#L1391">1391</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@font_files</span>[font_desc[<span class="symbol">:file</span>]] = {<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:originalsize</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1392">
      <a href="#L1392">1392</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1393">
      <a href="#L1393">1393</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@font_files</span>[font_desc[<span class="symbol">:file</span>]] = {<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:size1</span>], <span class="string"><span class="delimiter">'</span><span class="content">length2</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:size2</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1394">
      <a href="#L1394">1394</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1395">
      <a href="#L1395">1395</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1396">
      <a href="#L1396">1396</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1397">
      <a href="#L1397">1397</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:add_font</span>, <span class="symbol">:AddFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1398">
      <a href="#L1398">1398</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1399">
      <a href="#L1399">1399</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1400">
      <a href="#L1400">1400</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Sets the font used to print character strings. It is mandatory to call this method at least once before printing text or the resulting document would not be valid.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1401">
      <a href="#L1401">1401</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The font can be either a standard one or a font added via the AddFont() method. Standard fonts use Windows encoding cp1252 (Western Europe).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1402">
      <a href="#L1402">1402</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The method can be called before the first page is created and the font is retained from page to page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1403">
      <a href="#L1403">1403</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># If you just wish to change the current font size, it is simpler to call SetFontSize().</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1404">
      <a href="#L1404">1404</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Note: for the standard fonts, the font metric files must be accessible. There are three possibilities for this:&lt;ul&gt;&lt;li&gt;They are in the current directory (the one where the running script lies)&lt;/li&gt;&lt;li&gt;They are in one of the directories defined by the include_path parameter&lt;/li&gt;&lt;li&gt;They are in the directory defined by the FPDF_FONTPATH constant&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1405">
      <a href="#L1405">1405</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Example for the last case (note the trailing slash):&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1406">
      <a href="#L1406">1406</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1407">
      <a href="#L1407">1407</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># define('FPDF_FONTPATH','/home/www/font/');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1408">
      <a href="#L1408">1408</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># require('tcpdf.rb');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1409">
      <a href="#L1409">1409</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1410">
      <a href="#L1410">1410</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Times regular 12</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1411">
      <a href="#L1411">1411</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('Times');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1412">
      <a href="#L1412">1412</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Arial bold 14</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1413">
      <a href="#L1413">1413</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('Arial','B',14);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1414">
      <a href="#L1414">1414</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Removes bold</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1415">
      <a href="#L1415">1415</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1416">
      <a href="#L1416">1416</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Times bold, italic and underlined 14</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1417">
      <a href="#L1417">1417</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('Times','BIUD');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1418">
      <a href="#L1418">1418</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1419">
      <a href="#L1419">1419</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># If the file corresponding to the requested font is not found, the error &quot;Could not include font metric file&quot; is generated.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1420">
      <a href="#L1420">1420</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :family Family font. It can be either a name defined by AddFont() or one of the standard families (case insensitive):&lt;ul&gt;&lt;li&gt;Courier (fixed-width)&lt;/li&gt;&lt;li&gt;Helvetica or Arial (synonymous; sans serif)&lt;/li&gt;&lt;li&gt;Times (serif)&lt;/li&gt;&lt;li&gt;Symbol (symbolic)&lt;/li&gt;&lt;li&gt;ZapfDingbats (symbolic)&lt;/li&gt;&lt;/ul&gt;It is also possible to pass an empty string. In that case, the current family is retained.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1421">
      <a href="#L1421">1421</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :style Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;U: underline&lt;/li&gt;&lt;/ul&gt;or any combination. The default value is regular. Bold and italic styles do not apply to Symbol and ZapfDingbats</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1422">
      <a href="#L1422">1422</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :size Font size in points. The default value is the current size. If no size has been specified since the beginning of the document, the value taken is 12</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1423">
      <a href="#L1423">1423</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1424">
      <a href="#L1424">1424</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see AddFont(), SetFontSize(), Cell(), MultiCell(), Write()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1425">
      <a href="#L1425">1425</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1426">
      <a href="#L1426">1426</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetFont</span>(family, style=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, size=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1427">
      <a href="#L1427">1427</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># save previous values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1428">
      <a href="#L1428">1428</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@prevfont_family</span> = <span class="instance-variable">@font_family</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1429">
      <a href="#L1429">1429</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@prevfont_style</span> = <span class="instance-variable">@font_style</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1430">
      <a href="#L1430">1430</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1431">
      <a href="#L1431">1431</a>
    </th>
    <td class="line-code">
      <pre>                family=family.downcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1432">
      <a href="#L1432">1432</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (family==<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1433">
      <a href="#L1433">1433</a>
    </th>
    <td class="line-code">
      <pre>                        family=<span class="instance-variable">@font_family</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1434">
      <a href="#L1434">1434</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1435">
      <a href="#L1435">1435</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((!<span class="instance-variable">@is_unicode</span>) <span class="keyword">and</span> (family == <span class="string"><span class="delimiter">'</span><span class="content">arial</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1436">
      <a href="#L1436">1436</a>
    </th>
    <td class="line-code">
      <pre>                        family = <span class="string"><span class="delimiter">'</span><span class="content">helvetica</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1437">
      <a href="#L1437">1437</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> ((family==<span class="string"><span class="delimiter">&quot;</span><span class="content">symbol</span><span class="delimiter">&quot;</span></span>) <span class="keyword">or</span> (family==<span class="string"><span class="delimiter">&quot;</span><span class="content">zapfdingbats</span><span class="delimiter">&quot;</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1438">
      <a href="#L1438">1438</a>
    </th>
    <td class="line-code">
      <pre>                        style=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1439">
      <a href="#L1439">1439</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1440">
      <a href="#L1440">1440</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1441">
      <a href="#L1441">1441</a>
    </th>
    <td class="line-code">
      <pre>                style=style.upcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1442">
      <a href="#L1442">1442</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1443">
      <a href="#L1443">1443</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style.include?(<span class="string"><span class="delimiter">'</span><span class="content">U</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1444">
      <a href="#L1444">1444</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@underline</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1445">
      <a href="#L1445">1445</a>
    </th>
    <td class="line-code">
      <pre>                        style= style.gsub(<span class="string"><span class="delimiter">'</span><span class="content">U</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1446">
      <a href="#L1446">1446</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1447">
      <a href="#L1447">1447</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@underline</span>=<span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1448">
      <a href="#L1448">1448</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1449">
      <a href="#L1449">1449</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style.include?(<span class="string"><span class="delimiter">'</span><span class="content">D</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1450">
      <a href="#L1450">1450</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@deleted</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1451">
      <a href="#L1451">1451</a>
    </th>
    <td class="line-code">
      <pre>                        style= style.gsub(<span class="string"><span class="delimiter">'</span><span class="content">D</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1452">
      <a href="#L1452">1452</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1453">
      <a href="#L1453">1453</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@deleted</span>=<span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1454">
      <a href="#L1454">1454</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1455">
      <a href="#L1455">1455</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style==<span class="string"><span class="delimiter">'</span><span class="content">IB</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1456">
      <a href="#L1456">1456</a>
    </th>
    <td class="line-code">
      <pre>                        style=<span class="string"><span class="delimiter">'</span><span class="content">BI</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1457">
      <a href="#L1457">1457</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1458">
      <a href="#L1458">1458</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (size==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1459">
      <a href="#L1459">1459</a>
    </th>
    <td class="line-code">
      <pre>                        size=<span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1460">
      <a href="#L1460">1460</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1461">
      <a href="#L1461">1461</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1462">
      <a href="#L1462">1462</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># try to add font (if not already added)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1463">
      <a href="#L1463">1463</a>
    </th>
    <td class="line-code">
      <pre>                AddFont(family, style);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1464">
      <a href="#L1464">1464</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1465">
      <a href="#L1465">1465</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Test if font is already selected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1466">
      <a href="#L1466">1466</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((<span class="instance-variable">@font_family</span> == family) <span class="keyword">and</span> (<span class="instance-variable">@font_style</span> == style) <span class="keyword">and</span> (<span class="instance-variable">@font_size_pt</span> == size))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1467">
      <a href="#L1467">1467</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1468">
      <a href="#L1468">1468</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1469">
      <a href="#L1469">1469</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1470">
      <a href="#L1470">1470</a>
    </th>
    <td class="line-code">
      <pre>                fontkey = family + style;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1471">
      <a href="#L1471">1471</a>
    </th>
    <td class="line-code">
      <pre>                style = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span> <span class="keyword">if</span> (<span class="instance-variable">@fonts</span>[fontkey].nil? <span class="keyword">and</span> !<span class="instance-variable">@fonts</span>[family].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1472">
      <a href="#L1472">1472</a>
    </th>
    <td class="line-code">
      <pre>    
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1473">
      <a href="#L1473">1473</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Test if used for the first time</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1474">
      <a href="#L1474">1474</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@fonts</span>[fontkey].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1475">
      <a href="#L1475">1475</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Check if one of the standard fonts</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1476">
      <a href="#L1476">1476</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!<span class="instance-variable">@core_fonts</span>[fontkey].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1477">
      <a href="#L1477">1477</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="class-variable">@@fpdf_charwidths</span>[fontkey].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1478">
      <a href="#L1478">1478</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#Load metric file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1479">
      <a href="#L1479">1479</a>
    </th>
    <td class="line-code">
      <pre>                                        file = family;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1480">
      <a href="#L1480">1480</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> ((family!=<span class="string"><span class="delimiter">'</span><span class="content">symbol</span><span class="delimiter">'</span></span>) <span class="keyword">and</span> (family!=<span class="string"><span class="delimiter">'</span><span class="content">zapfdingbats</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1481">
      <a href="#L1481">1481</a>
    </th>
    <td class="line-code">
      <pre>                                                file += style.downcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1482">
      <a href="#L1482">1482</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1483">
      <a href="#L1483">1483</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (getfontpath(file + <span class="string"><span class="delimiter">'</span><span class="content">.rb</span><span class="delimiter">'</span></span>).nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1484">
      <a href="#L1484">1484</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment"># try to load the basic file without styles</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1485">
      <a href="#L1485">1485</a>
    </th>
    <td class="line-code">
      <pre>                                                file = family;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1486">
      <a href="#L1486">1486</a>
    </th>
    <td class="line-code">
      <pre>                                                fontkey = family;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1487">
      <a href="#L1487">1487</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1488">
      <a href="#L1488">1488</a>
    </th>
    <td class="line-code">
      <pre>                                        require(getfontpath(file + <span class="string"><span class="delimiter">'</span><span class="content">.rb</span><span class="delimiter">'</span></span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1489">
      <a href="#L1489">1489</a>
    </th>
    <td class="line-code">
      <pre>                      font_desc = <span class="constant">TCPDFFontDescriptor</span>.font(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1490">
      <a href="#L1490">1490</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> ((<span class="instance-variable">@is_unicode</span> <span class="keyword">and</span> ctg.nil?) <span class="keyword">or</span> ((!<span class="instance-variable">@is_unicode</span>) <span class="keyword">and</span> (<span class="class-variable">@@fpdf_charwidths</span>[fontkey].nil?)) )
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1491">
      <a href="#L1491">1491</a>
    </th>
    <td class="line-code">
      <pre>                                                Error(<span class="string"><span class="delimiter">&quot;</span><span class="content">Could not include font metric file [</span><span class="delimiter">&quot;</span></span> + fontkey + <span class="string"><span class="delimiter">&quot;</span><span class="content">]: </span><span class="delimiter">&quot;</span></span> + getfontpath(file + <span class="string"><span class="delimiter">&quot;</span><span class="content">.rb</span><span class="delimiter">&quot;</span></span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1492">
      <a href="#L1492">1492</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1493">
      <a href="#L1493">1493</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1494">
      <a href="#L1494">1494</a>
    </th>
    <td class="line-code">
      <pre>                                i = <span class="instance-variable">@fonts</span>.length + <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1495">
      <a href="#L1495">1495</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1496">
      <a href="#L1496">1496</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1497">
      <a href="#L1497">1497</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@fonts</span>[fontkey] = {<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span> =&gt; i, <span class="string"><span class="delimiter">'</span><span class="content">type</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:type</span>], <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:name</span>], <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:desc</span>], <span class="string"><span class="delimiter">'</span><span class="content">up</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:up</span>], <span class="string"><span class="delimiter">'</span><span class="content">ut</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:ut</span>], <span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:cw</span>], <span class="string"><span class="delimiter">'</span><span class="content">enc</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:enc</span>], <span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:file</span>], <span class="string"><span class="delimiter">'</span><span class="content">ctg</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:ctg</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1498">
      <a href="#L1498">1498</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="class-variable">@@fpdf_charwidths</span>[fontkey] = font_desc[<span class="symbol">:cw</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1499">
      <a href="#L1499">1499</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1500">
      <a href="#L1500">1500</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@fonts</span>[fontkey] = {<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span> =&gt; i, <span class="string"><span class="delimiter">'</span><span class="content">type</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">core</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>=&gt;<span class="instance-variable">@core_fonts</span>[fontkey], <span class="string"><span class="delimiter">'</span><span class="content">up</span><span class="delimiter">'</span></span>=&gt;<span class="integer">-100</span>, <span class="string"><span class="delimiter">'</span><span class="content">ut</span><span class="delimiter">'</span></span>=&gt;<span class="integer">50</span>, <span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span> =&gt; font_desc[<span class="symbol">:cw</span>]}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1501">
      <a href="#L1501">1501</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="class-variable">@@fpdf_charwidths</span>[fontkey] = font_desc[<span class="symbol">:cw</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1502">
      <a href="#L1502">1502</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1503">
      <a href="#L1503">1503</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1504">
      <a href="#L1504">1504</a>
    </th>
    <td class="line-code">
      <pre>                                Error(<span class="string"><span class="delimiter">'</span><span class="content">Undefined font: </span><span class="delimiter">'</span></span> + family + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + style);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1505">
      <a href="#L1505">1505</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1506">
      <a href="#L1506">1506</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1507">
      <a href="#L1507">1507</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Select it</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1508">
      <a href="#L1508">1508</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_family</span> = family;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1509">
      <a href="#L1509">1509</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_style</span> = style;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1510">
      <a href="#L1510">1510</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size_pt</span> = size;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1511">
      <a href="#L1511">1511</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size</span> = size / <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1512">
      <a href="#L1512">1512</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@current_font</span> = <span class="instance-variable">@fonts</span>[fontkey]; <span class="comment"># was &amp; may need deep copy?</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1513">
      <a href="#L1513">1513</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1514">
      <a href="#L1514">1514</a>
    </th>
    <td class="line-code">
      <pre>                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">BT /F%d %.2f Tf ET</span><span class="delimiter">'</span></span>, <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>], <span class="instance-variable">@font_size_pt</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1515">
      <a href="#L1515">1515</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1516">
      <a href="#L1516">1516</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1517">
      <a href="#L1517">1517</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_font</span>, <span class="symbol">:SetFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1518">
      <a href="#L1518">1518</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1519">
      <a href="#L1519">1519</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1520">
      <a href="#L1520">1520</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the size of the current font.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1521">
      <a href="#L1521">1521</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :size The size (in points)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1522">
      <a href="#L1522">1522</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1523">
      <a href="#L1523">1523</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1524">
      <a href="#L1524">1524</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1525">
      <a href="#L1525">1525</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetFontSize</span>(size)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1526">
      <a href="#L1526">1526</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set font size in points</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1527">
      <a href="#L1527">1527</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@font_size_pt</span>== size)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1528">
      <a href="#L1528">1528</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1529">
      <a href="#L1529">1529</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1530">
      <a href="#L1530">1530</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size_pt</span> = size;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1531">
      <a href="#L1531">1531</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_size</span> = size.to_f / <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1532">
      <a href="#L1532">1532</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span> &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1533">
      <a href="#L1533">1533</a>
    </th>
    <td class="line-code">
      <pre>                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">BT /F%d %.2f Tf ET</span><span class="delimiter">'</span></span>, <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>], <span class="instance-variable">@font_size_pt</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1534">
      <a href="#L1534">1534</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1535">
      <a href="#L1535">1535</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1536">
      <a href="#L1536">1536</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_font_size</span>, <span class="symbol">:SetFontSize</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1537">
      <a href="#L1537">1537</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1538">
      <a href="#L1538">1538</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1539">
      <a href="#L1539">1539</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Creates a new internal link and returns its identifier. An internal link is a clickable area which directs to another place within the document.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1540">
      <a href="#L1540">1540</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The identifier can then be passed to Cell(), Write(), Image() or Link(). The destination is defined with SetLink().</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1541">
      <a href="#L1541">1541</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1542">
      <a href="#L1542">1542</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Cell(), Write(), Image(), Link(), SetLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1543">
      <a href="#L1543">1543</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1544">
      <a href="#L1544">1544</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">AddLink</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1545">
      <a href="#L1545">1545</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Create a new internal link</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1546">
      <a href="#L1546">1546</a>
    </th>
    <td class="line-code">
      <pre>                n=<span class="instance-variable">@links</span>.length+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1547">
      <a href="#L1547">1547</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@links</span>[n]=[<span class="integer">0</span>,<span class="integer">0</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1548">
      <a href="#L1548">1548</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> n;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1549">
      <a href="#L1549">1549</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1550">
      <a href="#L1550">1550</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:add_link</span>, <span class="symbol">:AddLink</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1551">
      <a href="#L1551">1551</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1552">
      <a href="#L1552">1552</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1553">
      <a href="#L1553">1553</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the page and position a link points to</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1554">
      <a href="#L1554">1554</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :link The link identifier returned by AddLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1555">
      <a href="#L1555">1555</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y Ordinate of target position; -1 indicates the current position. The default value is 0 (top of page)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1556">
      <a href="#L1556">1556</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :page Number of target page; -1 indicates the current page. This is the default value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1557">
      <a href="#L1557">1557</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1558">
      <a href="#L1558">1558</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see AddLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1559">
      <a href="#L1559">1559</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1560">
      <a href="#L1560">1560</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetLink</span>(link, y=<span class="integer">0</span>, page=<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1561">
      <a href="#L1561">1561</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set destination of internal link</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1562">
      <a href="#L1562">1562</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (y==<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1563">
      <a href="#L1563">1563</a>
    </th>
    <td class="line-code">
      <pre>                        y=<span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1564">
      <a href="#L1564">1564</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1565">
      <a href="#L1565">1565</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (page==<span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1566">
      <a href="#L1566">1566</a>
    </th>
    <td class="line-code">
      <pre>                        page=<span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1567">
      <a href="#L1567">1567</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1568">
      <a href="#L1568">1568</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@links</span>[link] = [page, y]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1569">
      <a href="#L1569">1569</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1570">
      <a href="#L1570">1570</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_link</span>, <span class="symbol">:SetLink</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1571">
      <a href="#L1571">1571</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1572">
      <a href="#L1572">1572</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1573">
      <a href="#L1573">1573</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Puts a link on a rectangular area of the page. Text or image links are generally put via Cell(), Write() or Image(), but this method can be useful for instance to define a clickable area inside an image.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1574">
      <a href="#L1574">1574</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x Abscissa of the upper-left corner of the rectangle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1575">
      <a href="#L1575">1575</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y Ordinate of the upper-left corner of the rectangle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1576">
      <a href="#L1576">1576</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Width of the rectangle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1577">
      <a href="#L1577">1577</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Height of the rectangle</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1578">
      <a href="#L1578">1578</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :link URL or identifier returned by AddLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1579">
      <a href="#L1579">1579</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1580">
      <a href="#L1580">1580</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see AddLink(), Cell(), Write(), Image()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1581">
      <a href="#L1581">1581</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1582">
      <a href="#L1582">1582</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Link</span>(x, y, w, h, link)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1583">
      <a href="#L1583">1583</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Put a link on the page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1584">
      <a href="#L1584">1584</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@page_links</span> ||= <span class="constant">Array</span>.new
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1585">
      <a href="#L1585">1585</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@page_links</span>[<span class="instance-variable">@page</span>] ||= <span class="constant">Array</span>.new
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1586">
      <a href="#L1586">1586</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@page_links</span>[<span class="instance-variable">@page</span>].push([x * <span class="instance-variable">@k</span>, <span class="instance-variable">@h_pt</span> - y * <span class="instance-variable">@k</span>, w * <span class="instance-variable">@k</span>, h*<span class="instance-variable">@k</span>, link]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1587">
      <a href="#L1587">1587</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1588">
      <a href="#L1588">1588</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:link</span>, <span class="symbol">:Link</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1589">
      <a href="#L1589">1589</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1590">
      <a href="#L1590">1590</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1591">
      <a href="#L1591">1591</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Prints a character string. The origin is on the left of the first charcter, on the baseline. This method allows to place a string precisely on the page, but it is usually easier to use Cell(), MultiCell() or Write() which are the standard methods to print text.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1592">
      <a href="#L1592">1592</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x Abscissa of the origin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1593">
      <a href="#L1593">1593</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y Ordinate of the origin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1594">
      <a href="#L1594">1594</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :txt String to print</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1595">
      <a href="#L1595">1595</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1596">
      <a href="#L1596">1596</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont(), SetTextColor(), Cell(), MultiCell(), Write()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1597">
      <a href="#L1597">1597</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1598">
      <a href="#L1598">1598</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Text</span>(x, y, txt)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1599">
      <a href="#L1599">1599</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Output a string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1600">
      <a href="#L1600">1600</a>
    </th>
    <td class="line-code">
      <pre>                s=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">BT %.2f %.2f Td (%s) Tj ET</span><span class="delimiter">'</span></span>, x * <span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span>-y) * <span class="instance-variable">@k</span>, escapetext(txt));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1601">
      <a href="#L1601">1601</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@underline</span> <span class="keyword">and</span> (txt!=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1602">
      <a href="#L1602">1602</a>
    </th>
    <td class="line-code">
      <pre>                        s += <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + dolinetxt(x, y, txt);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1603">
      <a href="#L1603">1603</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1604">
      <a href="#L1604">1604</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@color_flag</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1605">
      <a href="#L1605">1605</a>
    </th>
    <td class="line-code">
      <pre>                        s=<span class="string"><span class="delimiter">'</span><span class="content">q </span><span class="delimiter">'</span></span> + <span class="instance-variable">@text_color</span> + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + s + <span class="string"><span class="delimiter">'</span><span class="content"> Q</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1606">
      <a href="#L1606">1606</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1607">
      <a href="#L1607">1607</a>
    </th>
    <td class="line-code">
      <pre>                out(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1608">
      <a href="#L1608">1608</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1609">
      <a href="#L1609">1609</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:text</span>, <span class="symbol">:Text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1610">
      <a href="#L1610">1610</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1611">
      <a href="#L1611">1611</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1612">
      <a href="#L1612">1612</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Whenever a page break condition is met, the method is called, and the break is issued or not depending on the returned value. The default implementation returns a value according to the mode selected by SetAutoPageBreak().&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1613">
      <a href="#L1613">1613</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This method is called automatically and should not be called directly by the application.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1614">
      <a href="#L1614">1614</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;b&gt;Example:&lt;/b&gt;&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1615">
      <a href="#L1615">1615</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The method is overriden in an inherited class in order to obtain a 3 column layout:&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1616">
      <a href="#L1616">1616</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1617">
      <a href="#L1617">1617</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># class PDF extends TCPDF {</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1618">
      <a href="#L1618">1618</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         var :col=0;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1619">
      <a href="#L1619">1619</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1620">
      <a href="#L1620">1620</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         def SetCol(col)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1621">
      <a href="#L1621">1621</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 #Move position to a column</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1622">
      <a href="#L1622">1622</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 @col = col;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1623">
      <a href="#L1623">1623</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 :x=10+:col*65;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1624">
      <a href="#L1624">1624</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 SetLeftMargin(x);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1625">
      <a href="#L1625">1625</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 SetX(x);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1626">
      <a href="#L1626">1626</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1627">
      <a href="#L1627">1627</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1628">
      <a href="#L1628">1628</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         def AcceptPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1629">
      <a href="#L1629">1629</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 if (@col&lt;2)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1630">
      <a href="#L1630">1630</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         #Go to next column</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1631">
      <a href="#L1631">1631</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         SetCol(@col+1);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1632">
      <a href="#L1632">1632</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         SetY(10);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1633">
      <a href="#L1633">1633</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         return false;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1634">
      <a href="#L1634">1634</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1635">
      <a href="#L1635">1635</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1636">
      <a href="#L1636">1636</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         #Go back to first column and issue page break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1637">
      <a href="#L1637">1637</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         SetCol(0);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1638">
      <a href="#L1638">1638</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                         return true;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1639">
      <a href="#L1639">1639</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1640">
      <a href="#L1640">1640</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#         end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1641">
      <a href="#L1641">1641</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># }</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1642">
      <a href="#L1642">1642</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1643">
      <a href="#L1643">1643</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf=new PDF();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1644">
      <a href="#L1644">1644</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;Open();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1645">
      <a href="#L1645">1645</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;AddPage();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1646">
      <a href="#L1646">1646</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('Arial','',12);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1647">
      <a href="#L1647">1647</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># for(i=1;:i&lt;=300;:i++)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1648">
      <a href="#L1648">1648</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#     :pdf-&gt;Cell(0,5,&quot;Line :i&quot;,0,1);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1649">
      <a href="#L1649">1649</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># }</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1650">
      <a href="#L1650">1650</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;Output();</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1651">
      <a href="#L1651">1651</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1652">
      <a href="#L1652">1652</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return boolean</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1653">
      <a href="#L1653">1653</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1654">
      <a href="#L1654">1654</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetAutoPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1655">
      <a href="#L1655">1655</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1656">
      <a href="#L1656">1656</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">AcceptPageBreak</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1657">
      <a href="#L1657">1657</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Accept automatic page break or not</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1658">
      <a href="#L1658">1658</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@auto_page_break</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1659">
      <a href="#L1659">1659</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1660">
      <a href="#L1660">1660</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:accept_page_break</span>, <span class="symbol">:AcceptPageBreak</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1661">
      <a href="#L1661">1661</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1662">
      <a href="#L1662">1662</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="function">BreakThePage?</span>(h)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1663">
      <a href="#L1663">1663</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((<span class="instance-variable">@y</span> + h) &gt; <span class="instance-variable">@page_break_trigger</span> <span class="keyword">and</span> !<span class="instance-variable">@in_footer</span> <span class="keyword">and</span> AcceptPageBreak())
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1664">
      <a href="#L1664">1664</a>
    </th>
    <td class="line-code">
      <pre>      <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1665">
      <a href="#L1665">1665</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1666">
      <a href="#L1666">1666</a>
    </th>
    <td class="line-code">
      <pre>      <span class="predefined-constant">false</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1667">
      <a href="#L1667">1667</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1668">
      <a href="#L1668">1668</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1669">
      <a href="#L1669">1669</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:break_the_page?</span>, <span class="symbol">:BreakThePage?</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1670">
      <a href="#L1670">1670</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1671">
      <a href="#L1671">1671</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Prints a cell (rectangular area) with optional borders, background color and character string. The upper-left corner of the cell corresponds to the current position. The text can be aligned or centered. After the call, the current position moves to the right or to the next line. It is possible to put a link on the text.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1672">
      <a href="#L1672">1672</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># If automatic page breaking is enabled and the cell goes beyond the limit, a page break is done before outputting.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1673">
      <a href="#L1673">1673</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Cell width. If 0, the cell extends up to the right margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1674">
      <a href="#L1674">1674</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Cell height. Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1675">
      <a href="#L1675">1675</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :txt String to print. Default value: empty string.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1676">
      <a href="#L1676">1676</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :border Indicates if borders must be drawn around the cell. The value can be either a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt;or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1677">
      <a href="#L1677">1677</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :ln Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1678">
      <a href="#L1678">1678</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1679">
      <a href="#L1679">1679</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :align Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align (default value)&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1680">
      <a href="#L1680">1680</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the cell background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1681">
      <a href="#L1681">1681</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :link URL or identifier returned by AddLink().</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1682">
      <a href="#L1682">1682</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1683">
      <a href="#L1683">1683</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont(), SetDrawColor(), SetFillColor(), SetTextColor(), SetLineWidth(), AddLink(), Ln(), MultiCell(), Write(), SetAutoPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1684">
      <a href="#L1684">1684</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1685">
      <a href="#L1685">1685</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Cell</span>(w, h=<span class="integer">0</span>, txt=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, border=<span class="integer">0</span>, ln=<span class="integer">0</span>, align=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill=<span class="integer">0</span>, link=<span class="predefined-constant">nil</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1686">
      <a href="#L1686">1686</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Output a cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1687">
      <a href="#L1687">1687</a>
    </th>
    <td class="line-code">
      <pre>                k=<span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1688">
      <a href="#L1688">1688</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((<span class="instance-variable">@y</span> + h) &gt; <span class="instance-variable">@page_break_trigger</span> <span class="keyword">and</span> !<span class="instance-variable">@in_footer</span> <span class="keyword">and</span> AcceptPageBreak())
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1689">
      <a href="#L1689">1689</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Automatic page break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1690">
      <a href="#L1690">1690</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> <span class="instance-variable">@pages</span>[<span class="instance-variable">@page</span>+<span class="integer">1</span>].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1691">
      <a href="#L1691">1691</a>
    </th>
    <td class="line-code">
      <pre>                                x = <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1692">
      <a href="#L1692">1692</a>
    </th>
    <td class="line-code">
      <pre>                                ws = <span class="instance-variable">@ws</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1693">
      <a href="#L1693">1693</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1694">
      <a href="#L1694">1694</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@ws</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1695">
      <a href="#L1695">1695</a>
    </th>
    <td class="line-code">
      <pre>                                        out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1696">
      <a href="#L1696">1696</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1697">
      <a href="#L1697">1697</a>
    </th>
    <td class="line-code">
      <pre>                                AddPage(<span class="instance-variable">@cur_orientation</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1698">
      <a href="#L1698">1698</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1699">
      <a href="#L1699">1699</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1700">
      <a href="#L1700">1700</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@ws</span> = ws;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1701">
      <a href="#L1701">1701</a>
    </th>
    <td class="line-code">
      <pre>                                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f Tw</span><span class="delimiter">'</span></span>, ws * k));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1702">
      <a href="#L1702">1702</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1703">
      <a href="#L1703">1703</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1704">
      <a href="#L1704">1704</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1705">
      <a href="#L1705">1705</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@y</span>=<span class="instance-variable">@t_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1706">
      <a href="#L1706">1706</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1707">
      <a href="#L1707">1707</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1708">
      <a href="#L1708">1708</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1709">
      <a href="#L1709">1709</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (w == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1710">
      <a href="#L1710">1710</a>
    </th>
    <td class="line-code">
      <pre>                        w = <span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1711">
      <a href="#L1711">1711</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1712">
      <a href="#L1712">1712</a>
    </th>
    <td class="line-code">
      <pre>                s = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1713">
      <a href="#L1713">1713</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((fill.to_i == <span class="integer">1</span>) <span class="keyword">or</span> (border.to_i == <span class="integer">1</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1714">
      <a href="#L1714">1714</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (fill.to_i == <span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1715">
      <a href="#L1715">1715</a>
    </th>
    <td class="line-code">
      <pre>                                op = (border.to_i == <span class="integer">1</span>) ? <span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1716">
      <a href="#L1716">1716</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1717">
      <a href="#L1717">1717</a>
    </th>
    <td class="line-code">
      <pre>                                op = <span class="string"><span class="delimiter">'</span><span class="content">S</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1718">
      <a href="#L1718">1718</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1719">
      <a href="#L1719">1719</a>
    </th>
    <td class="line-code">
      <pre>                        s = sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f %.2f %.2f re %s </span><span class="delimiter">'</span></span>, <span class="instance-variable">@x</span> * k, (<span class="instance-variable">@h</span> - <span class="instance-variable">@y</span>) * k, w * k, -h * k, op);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1720">
      <a href="#L1720">1720</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1721">
      <a href="#L1721">1721</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (border.is_a?(<span class="constant">String</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1722">
      <a href="#L1722">1722</a>
    </th>
    <td class="line-code">
      <pre>                        x=<span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1723">
      <a href="#L1723">1723</a>
    </th>
    <td class="line-code">
      <pre>                        y=<span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1724">
      <a href="#L1724">1724</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1725">
      <a href="#L1725">1725</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f m %.2f %.2f l S </span><span class="delimiter">'</span></span>, x*k,(<span class="instance-variable">@h</span>-y)*k, x*k,(<span class="instance-variable">@h</span>-(y+h))*k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1726">
      <a href="#L1726">1726</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1727">
      <a href="#L1727">1727</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1728">
      <a href="#L1728">1728</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f m %.2f %.2f l S </span><span class="delimiter">'</span></span>, x*k,(<span class="instance-variable">@h</span>-y)*k,(x+w)*k,(<span class="instance-variable">@h</span>-y)*k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1729">
      <a href="#L1729">1729</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1730">
      <a href="#L1730">1730</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1731">
      <a href="#L1731">1731</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f m %.2f %.2f l S </span><span class="delimiter">'</span></span>,(x+w)*k,(<span class="instance-variable">@h</span>-y)*k,(x+w)*k,(<span class="instance-variable">@h</span>-(y+h))*k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1732">
      <a href="#L1732">1732</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1733">
      <a href="#L1733">1733</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1734">
      <a href="#L1734">1734</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f m %.2f %.2f l S </span><span class="delimiter">'</span></span>, x*k,(<span class="instance-variable">@h</span>-(y+h))*k,(x+w)*k,(<span class="instance-variable">@h</span>-(y+h))*k);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1735">
      <a href="#L1735">1735</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1736">
      <a href="#L1736">1736</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1737">
      <a href="#L1737">1737</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (txt != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1738">
      <a href="#L1738">1738</a>
    </th>
    <td class="line-code">
      <pre>                        width = GetStringWidth(txt);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1739">
      <a href="#L1739">1739</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (align == <span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span> || align == <span class="string"><span class="delimiter">'</span><span class="content">right</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1740">
      <a href="#L1740">1740</a>
    </th>
    <td class="line-code">
      <pre>                                dx = w - <span class="instance-variable">@c_margin</span> - width;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1741">
      <a href="#L1741">1741</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (align==<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span> || align == <span class="string"><span class="delimiter">'</span><span class="content">center</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1742">
      <a href="#L1742">1742</a>
    </th>
    <td class="line-code">
      <pre>                                dx = (w - width)/<span class="integer">2</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1743">
      <a href="#L1743">1743</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1744">
      <a href="#L1744">1744</a>
    </th>
    <td class="line-code">
      <pre>                                dx = <span class="instance-variable">@c_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1745">
      <a href="#L1745">1745</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1746">
      <a href="#L1746">1746</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@color_flag</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1747">
      <a href="#L1747">1747</a>
    </th>
    <td class="line-code">
      <pre>                                s &lt;&lt; <span class="string"><span class="delimiter">'</span><span class="content">q </span><span class="delimiter">'</span></span> + <span class="instance-variable">@text_color</span> + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1748">
      <a href="#L1748">1748</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1749">
      <a href="#L1749">1749</a>
    </th>
    <td class="line-code">
      <pre>                        txt2 = escapetext(txt);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1750">
      <a href="#L1750">1750</a>
    </th>
    <td class="line-code">
      <pre>                        s&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">BT %.2f %.2f Td (%s) Tj ET</span><span class="delimiter">'</span></span>, (<span class="instance-variable">@x</span> + dx) * k, (<span class="instance-variable">@h</span> - (<span class="instance-variable">@y</span> + <span class="float">0.5</span> * h + <span class="float">0.3</span> * <span class="instance-variable">@font_size</span>)) * k, txt2);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1751">
      <a href="#L1751">1751</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@underline</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1752">
      <a href="#L1752">1752</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + dolinetxt(<span class="instance-variable">@x</span> + dx, <span class="instance-variable">@y</span> + <span class="float">0.5</span> * h + <span class="float">0.3</span> * <span class="instance-variable">@font_size</span>, txt);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1753">
      <a href="#L1753">1753</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1754">
      <a href="#L1754">1754</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@deleted</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1755">
      <a href="#L1755">1755</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + dolinetxt(<span class="instance-variable">@x</span> + dx, <span class="instance-variable">@y</span> + <span class="float">0.3</span> * h + <span class="float">0.2</span> * <span class="instance-variable">@font_size</span>, txt);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1756">
      <a href="#L1756">1756</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1757">
      <a href="#L1757">1757</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (<span class="instance-variable">@color_flag</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1758">
      <a href="#L1758">1758</a>
    </th>
    <td class="line-code">
      <pre>                                s&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content"> Q</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1759">
      <a href="#L1759">1759</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1760">
      <a href="#L1760">1760</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> link &amp;&amp; !link.empty?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1761">
      <a href="#L1761">1761</a>
    </th>
    <td class="line-code">
      <pre>                                Link(<span class="instance-variable">@x</span> + dx, <span class="instance-variable">@y</span> + <span class="float">0.5</span> * h - <span class="float">0.5</span> * <span class="instance-variable">@font_size</span>, width, <span class="instance-variable">@font_size</span>, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1762">
      <a href="#L1762">1762</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1763">
      <a href="#L1763">1763</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1764">
      <a href="#L1764">1764</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1765">
      <a href="#L1765">1765</a>
    </th>
    <td class="line-code">
      <pre>                        out(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1766">
      <a href="#L1766">1766</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1767">
      <a href="#L1767">1767</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@lasth</span> = h;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1768">
      <a href="#L1768">1768</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ln.to_i&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1769">
      <a href="#L1769">1769</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># Go to next line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1770">
      <a href="#L1770">1770</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> += h;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1771">
      <a href="#L1771">1771</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (ln == <span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1772">
      <a href="#L1772">1772</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1773">
      <a href="#L1773">1773</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1774">
      <a href="#L1774">1774</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1775">
      <a href="#L1775">1775</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> += w;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1776">
      <a href="#L1776">1776</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1777">
      <a href="#L1777">1777</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1778">
      <a href="#L1778">1778</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:cell</span>, <span class="symbol">:Cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1779">
      <a href="#L1779">1779</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1780">
      <a href="#L1780">1780</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1781">
      <a href="#L1781">1781</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This method allows printing text with line breaks. They can be automatic (as soon as the text reaches the right border of the cell) or explicit (via the \n character). As many cells as necessary are output, one below the other.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1782">
      <a href="#L1782">1782</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Text can be aligned, centered or justified. The cell block can be framed and the background painted.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1783">
      <a href="#L1783">1783</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Width of cells. If 0, they extend up to the right margin of the page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1784">
      <a href="#L1784">1784</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Height of cells.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1785">
      <a href="#L1785">1785</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :txt String to print</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1786">
      <a href="#L1786">1786</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :border Indicates if borders must be drawn around the cell block. The value can be either a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt;or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1787">
      <a href="#L1787">1787</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :align Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justification (default value)&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1788">
      <a href="#L1788">1788</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the cell background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1789">
      <a href="#L1789">1789</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :ln Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line [DEFAULT]&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1790">
      <a href="#L1790">1790</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.3</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1791">
      <a href="#L1791">1791</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont(), SetDrawColor(), SetFillColor(), SetTextColor(), SetLineWidth(), Cell(), Write(), SetAutoPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1792">
      <a href="#L1792">1792</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1793">
      <a href="#L1793">1793</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">MultiCell</span>(w, h, txt, border=<span class="integer">0</span>, align=<span class="string"><span class="delimiter">'</span><span class="content">J</span><span class="delimiter">'</span></span>, fill=<span class="integer">0</span>, ln=<span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1794">
      <a href="#L1794">1794</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1795">
      <a href="#L1795">1795</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># save current position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1796">
      <a href="#L1796">1796</a>
    </th>
    <td class="line-code">
      <pre>                prevx = <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1797">
      <a href="#L1797">1797</a>
    </th>
    <td class="line-code">
      <pre>                prevy = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1798">
      <a href="#L1798">1798</a>
    </th>
    <td class="line-code">
      <pre>                prevpage = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1799">
      <a href="#L1799">1799</a>
    </th>
    <td class="line-code">
      <pre>                 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1800">
      <a href="#L1800">1800</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Output text with automatic or explicit line breaks</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1801">
      <a href="#L1801">1801</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1802">
      <a href="#L1802">1802</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (w == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1803">
      <a href="#L1803">1803</a>
    </th>
    <td class="line-code">
      <pre>                        w = <span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1804">
      <a href="#L1804">1804</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1805">
      <a href="#L1805">1805</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1806">
      <a href="#L1806">1806</a>
    </th>
    <td class="line-code">
      <pre>                wmax = (w - <span class="integer">2</span> * <span class="instance-variable">@c_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1807">
      <a href="#L1807">1807</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1808">
      <a href="#L1808">1808</a>
    </th>
    <td class="line-code">
      <pre>                s = txt.gsub(<span class="string"><span class="delimiter">&quot;</span><span class="char">\r</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>); <span class="comment"># remove carriage returns</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1809">
      <a href="#L1809">1809</a>
    </th>
    <td class="line-code">
      <pre>                nb = s.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1810">
      <a href="#L1810">1810</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1811">
      <a href="#L1811">1811</a>
    </th>
    <td class="line-code">
      <pre>                b=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1812">
      <a href="#L1812">1812</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (border)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1813">
      <a href="#L1813">1813</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border==<span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1814">
      <a href="#L1814">1814</a>
    </th>
    <td class="line-code">
      <pre>                                border=<span class="string"><span class="delimiter">'</span><span class="content">LTRB</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1815">
      <a href="#L1815">1815</a>
    </th>
    <td class="line-code">
      <pre>                                b=<span class="string"><span class="delimiter">'</span><span class="content">LRT</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1816">
      <a href="#L1816">1816</a>
    </th>
    <td class="line-code">
      <pre>                                b2=<span class="string"><span class="delimiter">'</span><span class="content">LR</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1817">
      <a href="#L1817">1817</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> border.is_a?(<span class="constant">String</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1818">
      <a href="#L1818">1818</a>
    </th>
    <td class="line-code">
      <pre>                                b2=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1819">
      <a href="#L1819">1819</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1820">
      <a href="#L1820">1820</a>
    </th>
    <td class="line-code">
      <pre>                                        b2&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1821">
      <a href="#L1821">1821</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1822">
      <a href="#L1822">1822</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1823">
      <a href="#L1823">1823</a>
    </th>
    <td class="line-code">
      <pre>                                        b2&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1824">
      <a href="#L1824">1824</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1825">
      <a href="#L1825">1825</a>
    </th>
    <td class="line-code">
      <pre>                                b=(border.include?(<span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span>)) ? b2 + <span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span> : b2;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1826">
      <a href="#L1826">1826</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1827">
      <a href="#L1827">1827</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1828">
      <a href="#L1828">1828</a>
    </th>
    <td class="line-code">
      <pre>                sep=<span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1829">
      <a href="#L1829">1829</a>
    </th>
    <td class="line-code">
      <pre>                to_index=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1830">
      <a href="#L1830">1830</a>
    </th>
    <td class="line-code">
      <pre>                from_j=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1831">
      <a href="#L1831">1831</a>
    </th>
    <td class="line-code">
      <pre>                l=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1832">
      <a href="#L1832">1832</a>
    </th>
    <td class="line-code">
      <pre>                ns=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1833">
      <a href="#L1833">1833</a>
    </th>
    <td class="line-code">
      <pre>                nl=<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1834">
      <a href="#L1834">1834</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1835">
      <a href="#L1835">1835</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">while</span> to_index &lt; nb
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1836">
      <a href="#L1836">1836</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Get next character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1837">
      <a href="#L1837">1837</a>
    </th>
    <td class="line-code">
      <pre>                        c = s[to_index];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1838">
      <a href="#L1838">1838</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> c == <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>[<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1839">
      <a href="#L1839">1839</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Explicit line break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1840">
      <a href="#L1840">1840</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@ws</span> &gt; <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1841">
      <a href="#L1841">1841</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@ws</span> = <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1842">
      <a href="#L1842">1842</a>
    </th>
    <td class="line-code">
      <pre>                                        out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1843">
      <a href="#L1843">1843</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1844">
      <a href="#L1844">1844</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#Ed Moss - change begin            </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1845">
      <a href="#L1845">1845</a>
    </th>
    <td class="line-code">
      <pre>        end_i = to_index == <span class="integer">0</span> ? <span class="integer">0</span> : to_index - <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1846">
      <a href="#L1846">1846</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Changed from s[from_j..to_index] to fix bug reported by Hans Allis.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1847">
      <a href="#L1847">1847</a>
    </th>
    <td class="line-code">
      <pre>        from_j = to_index == <span class="integer">0</span> ? <span class="integer">1</span> : from_j 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1848">
      <a href="#L1848">1848</a>
    </th>
    <td class="line-code">
      <pre>        Cell(w, h, s[from_j..end_i], b, <span class="integer">2</span>, align, fill) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1849">
      <a href="#L1849">1849</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#change end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1850">
      <a href="#L1850">1850</a>
    </th>
    <td class="line-code">
      <pre>                                to_index += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1851">
      <a href="#L1851">1851</a>
    </th>
    <td class="line-code">
      <pre>                                sep=<span class="integer">-1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1852">
      <a href="#L1852">1852</a>
    </th>
    <td class="line-code">
      <pre>        from_j=to_index
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1853">
      <a href="#L1853">1853</a>
    </th>
    <td class="line-code">
      <pre>                                l=<span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1854">
      <a href="#L1854">1854</a>
    </th>
    <td class="line-code">
      <pre>                                ns=<span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1855">
      <a href="#L1855">1855</a>
    </th>
    <td class="line-code">
      <pre>                                nl += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1856">
      <a href="#L1856">1856</a>
    </th>
    <td class="line-code">
      <pre>                                b = b2 <span class="keyword">if</span> border <span class="keyword">and</span> nl==<span class="integer">2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1857">
      <a href="#L1857">1857</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">next</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1858">
      <a href="#L1858">1858</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1859">
      <a href="#L1859">1859</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (c == <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>[<span class="integer">0</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1860">
      <a href="#L1860">1860</a>
    </th>
    <td class="line-code">
      <pre>                                sep = to_index;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1861">
      <a href="#L1861">1861</a>
    </th>
    <td class="line-code">
      <pre>                                ls = l;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1862">
      <a href="#L1862">1862</a>
    </th>
    <td class="line-code">
      <pre>                                ns += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1863">
      <a href="#L1863">1863</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1864">
      <a href="#L1864">1864</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1865">
      <a href="#L1865">1865</a>
    </th>
    <td class="line-code">
      <pre>                        l = GetStringWidth(s[from_j, to_index - from_j + <span class="integer">1</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1866">
      <a href="#L1866">1866</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1867">
      <a href="#L1867">1867</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (l &gt; wmax)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1868">
      <a href="#L1868">1868</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Automatic line break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1869">
      <a href="#L1869">1869</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (sep == <span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1870">
      <a href="#L1870">1870</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (to_index == from_j)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1871">
      <a href="#L1871">1871</a>
    </th>
    <td class="line-code">
      <pre>                                                to_index += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1872">
      <a href="#L1872">1872</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1873">
      <a href="#L1873">1873</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (<span class="instance-variable">@ws</span> &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1874">
      <a href="#L1874">1874</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@ws</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1875">
      <a href="#L1875">1875</a>
    </th>
    <td class="line-code">
      <pre>                                                out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1876">
      <a href="#L1876">1876</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1877">
      <a href="#L1877">1877</a>
    </th>
    <td class="line-code">
      <pre>          Cell(w, h, s[from_j..to_index-<span class="integer">1</span>], b, <span class="integer">2</span>, align, fill) <span class="comment"># my FPDF version</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1878">
      <a href="#L1878">1878</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1879">
      <a href="#L1879">1879</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (align==<span class="string"><span class="delimiter">'</span><span class="content">J</span><span class="delimiter">'</span></span> || align==<span class="string"><span class="delimiter">'</span><span class="content">justify</span><span class="delimiter">'</span></span> || align==<span class="string"><span class="delimiter">'</span><span class="content">justified</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1880">
      <a href="#L1880">1880</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@ws</span> = (ns&gt;<span class="integer">1</span>) ? (wmax-ls)/(ns-<span class="integer">1</span>) : <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1881">
      <a href="#L1881">1881</a>
    </th>
    <td class="line-code">
      <pre>                                                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f Tw</span><span class="delimiter">'</span></span>, <span class="instance-variable">@ws</span> * <span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1882">
      <a href="#L1882">1882</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1883">
      <a href="#L1883">1883</a>
    </th>
    <td class="line-code">
      <pre>                                        Cell(w, h, s[from_j..sep], b, <span class="integer">2</span>, align, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1884">
      <a href="#L1884">1884</a>
    </th>
    <td class="line-code">
      <pre>                                        to_index = sep + <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1885">
      <a href="#L1885">1885</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1886">
      <a href="#L1886">1886</a>
    </th>
    <td class="line-code">
      <pre>                                sep=<span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1887">
      <a href="#L1887">1887</a>
    </th>
    <td class="line-code">
      <pre>                                from_j = to_index;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1888">
      <a href="#L1888">1888</a>
    </th>
    <td class="line-code">
      <pre>                                l=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1889">
      <a href="#L1889">1889</a>
    </th>
    <td class="line-code">
      <pre>                                ns=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1890">
      <a href="#L1890">1890</a>
    </th>
    <td class="line-code">
      <pre>                                nl += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1891">
      <a href="#L1891">1891</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (border <span class="keyword">and</span> (nl==<span class="integer">2</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1892">
      <a href="#L1892">1892</a>
    </th>
    <td class="line-code">
      <pre>                                        b = b2;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1893">
      <a href="#L1893">1893</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1894">
      <a href="#L1894">1894</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1895">
      <a href="#L1895">1895</a>
    </th>
    <td class="line-code">
      <pre>                                to_index += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1896">
      <a href="#L1896">1896</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1897">
      <a href="#L1897">1897</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1898">
      <a href="#L1898">1898</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Last chunk</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1899">
      <a href="#L1899">1899</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@ws</span>&gt;<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1900">
      <a href="#L1900">1900</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@ws</span>=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1901">
      <a href="#L1901">1901</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1902">
      <a href="#L1902">1902</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1903">
      <a href="#L1903">1903</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (border.is_a?(<span class="constant">String</span>) <span class="keyword">and</span> border.include?(<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1904">
      <a href="#L1904">1904</a>
    </th>
    <td class="line-code">
      <pre>                        b&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1905">
      <a href="#L1905">1905</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1906">
      <a href="#L1906">1906</a>
    </th>
    <td class="line-code">
      <pre>                Cell(w, h, s[from_j, to_index-from_j], b, <span class="integer">2</span>, align, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1907">
      <a href="#L1907">1907</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1908">
      <a href="#L1908">1908</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># move cursor to specified position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1909">
      <a href="#L1909">1909</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># since 2007-03-03</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1910">
      <a href="#L1910">1910</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ln == <span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1911">
      <a href="#L1911">1911</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the beginning of the next line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1912">
      <a href="#L1912">1912</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1913">
      <a href="#L1913">1913</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ln == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1914">
      <a href="#L1914">1914</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the top-right of the cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1915">
      <a href="#L1915">1915</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@page</span> = prevpage;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1916">
      <a href="#L1916">1916</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> = prevy;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1917">
      <a href="#L1917">1917</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = prevx + w;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1918">
      <a href="#L1918">1918</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ln == <span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1919">
      <a href="#L1919">1919</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the bottom-left of the cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1920">
      <a href="#L1920">1920</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = prevx;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1921">
      <a href="#L1921">1921</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1922">
      <a href="#L1922">1922</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1923">
      <a href="#L1923">1923</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:multi_cell</span>, <span class="symbol">:MultiCell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1924">
      <a href="#L1924">1924</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1925">
      <a href="#L1925">1925</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1926">
      <a href="#L1926">1926</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># This method prints text from the current position. When the right margin is reached (or the \n character is met) a line break occurs and text continues from the left margin. Upon method exit, the current position is left just at the end of the text. It is possible to put a link on the text.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1927">
      <a href="#L1927">1927</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;b&gt;Example:&lt;/b&gt;&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1928">
      <a href="#L1928">1928</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1929">
      <a href="#L1929">1929</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Begin with regular font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1930">
      <a href="#L1930">1930</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('Arial','',14);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1931">
      <a href="#L1931">1931</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;Write(5,'Visit ');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1932">
      <a href="#L1932">1932</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># #Then put a blue underlined link</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1933">
      <a href="#L1933">1933</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetTextColor(0,0,255);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1934">
      <a href="#L1934">1934</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;SetFont('','U');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1935">
      <a href="#L1935">1935</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># :pdf-&gt;Write(5,'www.tecnick.com','http://www.tecnick.com');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1936">
      <a href="#L1936">1936</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1937">
      <a href="#L1937">1937</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Line height</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1938">
      <a href="#L1938">1938</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :txt String to print</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1939">
      <a href="#L1939">1939</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :link URL or identifier returned by AddLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1940">
      <a href="#L1940">1940</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1941">
      <a href="#L1941">1941</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.5</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1942">
      <a href="#L1942">1942</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetFont(), SetTextColor(), AddLink(), MultiCell(), SetAutoPageBreak()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1943">
      <a href="#L1943">1943</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1944">
      <a href="#L1944">1944</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Write</span>(h, txt, link=<span class="predefined-constant">nil</span>, fill=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1945">
      <a href="#L1945">1945</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1946">
      <a href="#L1946">1946</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Output text in flowing mode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1947">
      <a href="#L1947">1947</a>
    </th>
    <td class="line-code">
      <pre>                w = <span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1948">
      <a href="#L1948">1948</a>
    </th>
    <td class="line-code">
      <pre>                wmax = (w - <span class="integer">2</span> * <span class="instance-variable">@c_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1949">
      <a href="#L1949">1949</a>
    </th>
    <td class="line-code">
      <pre>    
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1950">
      <a href="#L1950">1950</a>
    </th>
    <td class="line-code">
      <pre>                s = txt.gsub(<span class="string"><span class="delimiter">&quot;</span><span class="char">\r</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1951">
      <a href="#L1951">1951</a>
    </th>
    <td class="line-code">
      <pre>                nb = s.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1952">
      <a href="#L1952">1952</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1953">
      <a href="#L1953">1953</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># handle single space character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1954">
      <a href="#L1954">1954</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((nb==<span class="integer">1</span>) <span class="keyword">and</span> (s == <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1955">
      <a href="#L1955">1955</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> += GetStringWidth(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1956">
      <a href="#L1956">1956</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1957">
      <a href="#L1957">1957</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1958">
      <a href="#L1958">1958</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1959">
      <a href="#L1959">1959</a>
    </th>
    <td class="line-code">
      <pre>                sep=<span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1960">
      <a href="#L1960">1960</a>
    </th>
    <td class="line-code">
      <pre>                i=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1961">
      <a href="#L1961">1961</a>
    </th>
    <td class="line-code">
      <pre>                j=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1962">
      <a href="#L1962">1962</a>
    </th>
    <td class="line-code">
      <pre>                l=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1963">
      <a href="#L1963">1963</a>
    </th>
    <td class="line-code">
      <pre>                nl=<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1964">
      <a href="#L1964">1964</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">while</span>(i&lt;nb)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1965">
      <a href="#L1965">1965</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Get next character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1966">
      <a href="#L1966">1966</a>
    </th>
    <td class="line-code">
      <pre>                        c = s[i];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1967">
      <a href="#L1967">1967</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (c == <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>[<span class="integer">0</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1968">
      <a href="#L1968">1968</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Explicit line break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1969">
      <a href="#L1969">1969</a>
    </th>
    <td class="line-code">
      <pre>                                Cell(w, h, s[j,i-j], <span class="integer">0</span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1970">
      <a href="#L1970">1970</a>
    </th>
    <td class="line-code">
      <pre>                                i += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1971">
      <a href="#L1971">1971</a>
    </th>
    <td class="line-code">
      <pre>                                sep = <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1972">
      <a href="#L1972">1972</a>
    </th>
    <td class="line-code">
      <pre>                                j = i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1973">
      <a href="#L1973">1973</a>
    </th>
    <td class="line-code">
      <pre>                                l = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1974">
      <a href="#L1974">1974</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (nl == <span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1975">
      <a href="#L1975">1975</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1976">
      <a href="#L1976">1976</a>
    </th>
    <td class="line-code">
      <pre>                                        w = <span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1977">
      <a href="#L1977">1977</a>
    </th>
    <td class="line-code">
      <pre>                                        wmax = (w - <span class="integer">2</span> * <span class="instance-variable">@c_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1978">
      <a href="#L1978">1978</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1979">
      <a href="#L1979">1979</a>
    </th>
    <td class="line-code">
      <pre>                                nl += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1980">
      <a href="#L1980">1980</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">next</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1981">
      <a href="#L1981">1981</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1982">
      <a href="#L1982">1982</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (c == <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>[<span class="integer">0</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1983">
      <a href="#L1983">1983</a>
    </th>
    <td class="line-code">
      <pre>                                sep= i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1984">
      <a href="#L1984">1984</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1985">
      <a href="#L1985">1985</a>
    </th>
    <td class="line-code">
      <pre>                        l = GetStringWidth(s[j, i - j + <span class="integer">1</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1986">
      <a href="#L1986">1986</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (l &gt; wmax)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1987">
      <a href="#L1987">1987</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Automatic line break (word wrapping)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1988">
      <a href="#L1988">1988</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (sep == <span class="integer">-1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1989">
      <a href="#L1989">1989</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (<span class="instance-variable">@x</span> &gt; <span class="instance-variable">@l_margin</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1990">
      <a href="#L1990">1990</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment">#Move to next line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1991">
      <a href="#L1991">1991</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1992">
      <a href="#L1992">1992</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@y</span> += h;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1993">
      <a href="#L1993">1993</a>
    </th>
    <td class="line-code">
      <pre>                                                w=<span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1994">
      <a href="#L1994">1994</a>
    </th>
    <td class="line-code">
      <pre>                                                wmax=(w - <span class="integer">2</span> * <span class="instance-variable">@c_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1995">
      <a href="#L1995">1995</a>
    </th>
    <td class="line-code">
      <pre>                                                i += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1996">
      <a href="#L1996">1996</a>
    </th>
    <td class="line-code">
      <pre>                                                nl += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1997">
      <a href="#L1997">1997</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">next</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1998">
      <a href="#L1998">1998</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L1999">
      <a href="#L1999">1999</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (i == j)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2000">
      <a href="#L2000">2000</a>
    </th>
    <td class="line-code">
      <pre>                                                i += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2001">
      <a href="#L2001">2001</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2002">
      <a href="#L2002">2002</a>
    </th>
    <td class="line-code">
      <pre>                                        Cell(w, h, s[j, (i-<span class="integer">1</span>)], <span class="integer">0</span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2003">
      <a href="#L2003">2003</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2004">
      <a href="#L2004">2004</a>
    </th>
    <td class="line-code">
      <pre>                                        Cell(w, h, s[j, (sep-j)], <span class="integer">0</span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2005">
      <a href="#L2005">2005</a>
    </th>
    <td class="line-code">
      <pre>                                        i = sep+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2006">
      <a href="#L2006">2006</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2007">
      <a href="#L2007">2007</a>
    </th>
    <td class="line-code">
      <pre>                                sep = <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2008">
      <a href="#L2008">2008</a>
    </th>
    <td class="line-code">
      <pre>                                j = i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2009">
      <a href="#L2009">2009</a>
    </th>
    <td class="line-code">
      <pre>                                l = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2010">
      <a href="#L2010">2010</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (nl==<span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2011">
      <a href="#L2011">2011</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2012">
      <a href="#L2012">2012</a>
    </th>
    <td class="line-code">
      <pre>                                        w = <span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2013">
      <a href="#L2013">2013</a>
    </th>
    <td class="line-code">
      <pre>                                        wmax = (w - <span class="integer">2</span> * <span class="instance-variable">@c_margin</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2014">
      <a href="#L2014">2014</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2015">
      <a href="#L2015">2015</a>
    </th>
    <td class="line-code">
      <pre>                                nl += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2016">
      <a href="#L2016">2016</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2017">
      <a href="#L2017">2017</a>
    </th>
    <td class="line-code">
      <pre>                                i += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2018">
      <a href="#L2018">2018</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2019">
      <a href="#L2019">2019</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2020">
      <a href="#L2020">2020</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Last chunk</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2021">
      <a href="#L2021">2021</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (i != j)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2022">
      <a href="#L2022">2022</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(GetStringWidth(s[j..i]), h, s[j..i], <span class="integer">0</span>, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2023">
      <a href="#L2023">2023</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2024">
      <a href="#L2024">2024</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2025">
      <a href="#L2025">2025</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:write</span>, <span class="symbol">:Write</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2026">
      <a href="#L2026">2026</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2027">
      <a href="#L2027">2027</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2028">
      <a href="#L2028">2028</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Puts an image in the page. The upper-left corner must be given. The dimensions can be specified in different ways:&lt;ul&gt;&lt;li&gt;explicit width and height (expressed in user unit)&lt;/li&gt;&lt;li&gt;one explicit dimension, the other being calculated automatically in order to keep the original proportions&lt;/li&gt;&lt;li&gt;no explicit dimension, in which case the image is put at 72 dpi&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2029">
      <a href="#L2029">2029</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Supported formats are JPEG and PNG.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2030">
      <a href="#L2030">2030</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># For JPEG, all flavors are allowed:&lt;ul&gt;&lt;li&gt;gray scales&lt;/li&gt;&lt;li&gt;true colors (24 bits)&lt;/li&gt;&lt;li&gt;CMYK (32 bits)&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2031">
      <a href="#L2031">2031</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># For PNG, are allowed:&lt;ul&gt;&lt;li&gt;gray scales on at most 8 bits (256 levels)&lt;/li&gt;&lt;li&gt;indexed colors&lt;/li&gt;&lt;li&gt;true colors (24 bits)&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2032">
      <a href="#L2032">2032</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># but are not supported:&lt;ul&gt;&lt;li&gt;Interlacing&lt;/li&gt;&lt;li&gt;Alpha channel&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2033">
      <a href="#L2033">2033</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># If a transparent color is defined, it will be taken into account (but will be only interpreted by Acrobat 4 and above).&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2034">
      <a href="#L2034">2034</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The format can be specified explicitly or inferred from the file extension.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2035">
      <a href="#L2035">2035</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># It is possible to put a link on the image.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2036">
      <a href="#L2036">2036</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Remark: if an image is used several times, only one copy will be embedded in the file.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2037">
      <a href="#L2037">2037</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :file Name of the file containing the image.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2038">
      <a href="#L2038">2038</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x Abscissa of the upper-left corner.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2039">
      <a href="#L2039">2039</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y Ordinate of the upper-left corner.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2040">
      <a href="#L2040">2040</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Width of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2041">
      <a href="#L2041">2041</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Height of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2042">
      <a href="#L2042">2042</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :type Image format. Possible values are (case insensitive): JPG, JPEG, PNG. If not specified, the type is inferred from the file extension.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2043">
      <a href="#L2043">2043</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :link URL or identifier returned by AddLink().</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2044">
      <a href="#L2044">2044</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2045">
      <a href="#L2045">2045</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see AddLink()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2046">
      <a href="#L2046">2046</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2047">
      <a href="#L2047">2047</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Image</span>(file, x, y, w=<span class="integer">0</span>, h=<span class="integer">0</span>, type=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, link=<span class="predefined-constant">nil</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2048">
      <a href="#L2048">2048</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Put an image on the page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2049">
      <a href="#L2049">2049</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@images</span>[file].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2050">
      <a href="#L2050">2050</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#First use of image, get info</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2051">
      <a href="#L2051">2051</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (type == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2052">
      <a href="#L2052">2052</a>
    </th>
    <td class="line-code">
      <pre>                                pos = <span class="constant">File</span>::basename(file).rindex(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2053">
      <a href="#L2053">2053</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (pos.nil? <span class="keyword">or</span> pos == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2054">
      <a href="#L2054">2054</a>
    </th>
    <td class="line-code">
      <pre>                                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Image file has no extension and no type was specified: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2055">
      <a href="#L2055">2055</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2056">
      <a href="#L2056">2056</a>
    </th>
    <td class="line-code">
      <pre>                                pos = file.rindex(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2057">
      <a href="#L2057">2057</a>
    </th>
    <td class="line-code">
      <pre>                                type = file[pos+<span class="integer">1</span>..<span class="integer">-1</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2058">
      <a href="#L2058">2058</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2059">
      <a href="#L2059">2059</a>
    </th>
    <td class="line-code">
      <pre>                        type.downcase!
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2060">
      <a href="#L2060">2060</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (type == <span class="string"><span class="delimiter">'</span><span class="content">jpg</span><span class="delimiter">'</span></span> <span class="keyword">or</span> type == <span class="string"><span class="delimiter">'</span><span class="content">jpeg</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2061">
      <a href="#L2061">2061</a>
    </th>
    <td class="line-code">
      <pre>                                info=parsejpg(file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2062">
      <a href="#L2062">2062</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (type == <span class="string"><span class="delimiter">'</span><span class="content">png</span><span class="delimiter">'</span></span> <span class="keyword">or</span> type == <span class="string"><span class="delimiter">'</span><span class="content">gif</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2063">
      <a href="#L2063">2063</a>
    </th>
    <td class="line-code">
      <pre>                                img = <span class="constant">Magick</span>::<span class="constant">ImageList</span>.new(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2064">
      <a href="#L2064">2064</a>
    </th>
    <td class="line-code">
      <pre>                                img.format = <span class="string"><span class="delimiter">&quot;</span><span class="content">PNG</span><span class="delimiter">&quot;</span></span>     <span class="comment"># convert to PNG from gif </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2065">
      <a href="#L2065">2065</a>
    </th>
    <td class="line-code">
      <pre>                                img.opacity = <span class="integer">0</span>        <span class="comment"># PNG alpha channel delete</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2066">
      <a href="#L2066">2066</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="constant">File</span>.open( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file), <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>){|f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2067">
      <a href="#L2067">2067</a>
    </th>
    <td class="line-code">
      <pre>                                        f.binmode
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2068">
      <a href="#L2068">2068</a>
    </th>
    <td class="line-code">
      <pre>                                        f.print img.to_blob
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2069">
      <a href="#L2069">2069</a>
    </th>
    <td class="line-code">
      <pre>                                        f.close
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2070">
      <a href="#L2070">2070</a>
    </th>
    <td class="line-code">
      <pre>                                }
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2071">
      <a href="#L2071">2071</a>
    </th>
    <td class="line-code">
      <pre>                                info=parsepng( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2072">
      <a href="#L2072">2072</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="constant">File</span>.delete( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2073">
      <a href="#L2073">2073</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2074">
      <a href="#L2074">2074</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Allow for additional formats</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2075">
      <a href="#L2075">2075</a>
    </th>
    <td class="line-code">
      <pre>                                mtd=<span class="string"><span class="delimiter">'</span><span class="content">parse</span><span class="delimiter">'</span></span> + type;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2076">
      <a href="#L2076">2076</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!<span class="predefined-constant">self</span>.respond_to?(mtd))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2077">
      <a href="#L2077">2077</a>
    </th>
    <td class="line-code">
      <pre>                                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Unsupported image type: </span><span class="delimiter">'</span></span> + type);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2078">
      <a href="#L2078">2078</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2079">
      <a href="#L2079">2079</a>
    </th>
    <td class="line-code">
      <pre>                                info=send(mtd, file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2080">
      <a href="#L2080">2080</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2081">
      <a href="#L2081">2081</a>
    </th>
    <td class="line-code">
      <pre>                        info[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>]=<span class="instance-variable">@images</span>.length+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2082">
      <a href="#L2082">2082</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@images</span>[file] = info;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2083">
      <a href="#L2083">2083</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2084">
      <a href="#L2084">2084</a>
    </th>
    <td class="line-code">
      <pre>                        info=<span class="instance-variable">@images</span>[file];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2085">
      <a href="#L2085">2085</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2086">
      <a href="#L2086">2086</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Automatic width and height calculation if needed</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2087">
      <a href="#L2087">2087</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> ((w == <span class="integer">0</span>) <span class="keyword">and</span> (h == <span class="integer">0</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2088">
      <a href="#L2088">2088</a>
    </th>
    <td class="line-code">
      <pre>                        rescale_x = (<span class="instance-variable">@w</span> - <span class="instance-variable">@r_margin</span> - x) / (info[<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>] / (<span class="instance-variable">@img_scale</span> * <span class="instance-variable">@k</span>)) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2089">
      <a href="#L2089">2089</a>
    </th>
    <td class="line-code">
      <pre>                        rescale_x = <span class="integer">1</span> <span class="keyword">if</span> rescale_x &gt;= <span class="integer">1</span> 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2090">
      <a href="#L2090">2090</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (y + info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>] * rescale_x / (<span class="instance-variable">@img_scale</span> * <span class="instance-variable">@k</span>) &gt; <span class="instance-variable">@page_break_trigger</span> <span class="keyword">and</span> !<span class="instance-variable">@in_footer</span> <span class="keyword">and</span> AcceptPageBreak())
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2091">
      <a href="#L2091">2091</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Automatic page break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2092">
      <a href="#L2092">2092</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@pages</span>[<span class="instance-variable">@page</span>+<span class="integer">1</span>].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2093">
      <a href="#L2093">2093</a>
    </th>
    <td class="line-code">
      <pre>                                        ws = <span class="instance-variable">@ws</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2094">
      <a href="#L2094">2094</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2095">
      <a href="#L2095">2095</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@ws</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2096">
      <a href="#L2096">2096</a>
    </th>
    <td class="line-code">
      <pre>                                                out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2097">
      <a href="#L2097">2097</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2098">
      <a href="#L2098">2098</a>
    </th>
    <td class="line-code">
      <pre>                                        AddPage(<span class="instance-variable">@cur_orientation</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2099">
      <a href="#L2099">2099</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2100">
      <a href="#L2100">2100</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@ws</span> = ws;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2101">
      <a href="#L2101">2101</a>
    </th>
    <td class="line-code">
      <pre>                                                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f Tw</span><span class="delimiter">'</span></span>, ws * <span class="instance-variable">@k</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2102">
      <a href="#L2102">2102</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2103">
      <a href="#L2103">2103</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2104">
      <a href="#L2104">2104</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2105">
      <a href="#L2105">2105</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2106">
      <a href="#L2106">2106</a>
    </th>
    <td class="line-code">
      <pre>                                y=<span class="instance-variable">@t_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2107">
      <a href="#L2107">2107</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2108">
      <a href="#L2108">2108</a>
    </th>
    <td class="line-code">
      <pre>                        rescale_y = (<span class="instance-variable">@page_break_trigger</span> - y) / (info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>] / (<span class="instance-variable">@img_scale</span> * <span class="instance-variable">@k</span>)) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2109">
      <a href="#L2109">2109</a>
    </th>
    <td class="line-code">
      <pre>                        rescale_y = <span class="integer">1</span> <span class="keyword">if</span> rescale_y &gt;= <span class="integer">1</span> 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2110">
      <a href="#L2110">2110</a>
    </th>
    <td class="line-code">
      <pre>                        rescale = rescale_y &gt;= rescale_x ? rescale_x : rescale_y
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2111">
      <a href="#L2111">2111</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2112">
      <a href="#L2112">2112</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Put image at 72 dpi</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2113">
      <a href="#L2113">2113</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># 2004-06-14 :: Nicola Asuni, scale factor where added</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2114">
      <a href="#L2114">2114</a>
    </th>
    <td class="line-code">
      <pre>                        w = info[<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>] * rescale / (<span class="instance-variable">@img_scale</span> * <span class="instance-variable">@k</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2115">
      <a href="#L2115">2115</a>
    </th>
    <td class="line-code">
      <pre>                        h = info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>] * rescale / (<span class="instance-variable">@img_scale</span> * <span class="instance-variable">@k</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2116">
      <a href="#L2116">2116</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (w == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2117">
      <a href="#L2117">2117</a>
    </th>
    <td class="line-code">
      <pre>                        w = h * info[<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>] / info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2118">
      <a href="#L2118">2118</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (h == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2119">
      <a href="#L2119">2119</a>
    </th>
    <td class="line-code">
      <pre>                        h = w * info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>] / info[<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2120">
      <a href="#L2120">2120</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2121">
      <a href="#L2121">2121</a>
    </th>
    <td class="line-code">
      <pre>                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">q %.2f 0 0 %.2f %.2f %.2f cm /I%d Do Q</span><span class="delimiter">'</span></span>, w*<span class="instance-variable">@k</span>, h*<span class="instance-variable">@k</span>, x*<span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span>-(y+h))*<span class="instance-variable">@k</span>, info[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>]));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2122">
      <a href="#L2122">2122</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (link)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2123">
      <a href="#L2123">2123</a>
    </th>
    <td class="line-code">
      <pre>                        Link(x, y, w, h, link);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2124">
      <a href="#L2124">2124</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2125">
      <a href="#L2125">2125</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2126">
      <a href="#L2126">2126</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#2002-07-31 - Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2127">
      <a href="#L2127">2127</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># set right-bottom corner coordinates</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2128">
      <a href="#L2128">2128</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@img_rb_x</span> = x + w;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2129">
      <a href="#L2129">2129</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@img_rb_y</span> = y + h;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2130">
      <a href="#L2130">2130</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2131">
      <a href="#L2131">2131</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:image</span>, <span class="symbol">:Image</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2132">
      <a href="#L2132">2132</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2133">
      <a href="#L2133">2133</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2134">
      <a href="#L2134">2134</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Performs a line break. The current abscissa goes back to the left margin and the ordinate increases by the amount passed in parameter.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2135">
      <a href="#L2135">2135</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h The height of the break. By default, the value equals the height of the last printed cell.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2136">
      <a href="#L2136">2136</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2137">
      <a href="#L2137">2137</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Cell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2138">
      <a href="#L2138">2138</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2139">
      <a href="#L2139">2139</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Ln</span>(h=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2140">
      <a href="#L2140">2140</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Line feed; default value is last cell height</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2141">
      <a href="#L2141">2141</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@x</span>=<span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2142">
      <a href="#L2142">2142</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (h.is_a?(<span class="constant">String</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2143">
      <a href="#L2143">2143</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> += <span class="instance-variable">@lasth</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2144">
      <a href="#L2144">2144</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2145">
      <a href="#L2145">2145</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> += h;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2146">
      <a href="#L2146">2146</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2147">
      <a href="#L2147">2147</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2148">
      <a href="#L2148">2148</a>
    </th>
    <td class="line-code">
      <pre>                k=<span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2149">
      <a href="#L2149">2149</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@y</span> &gt; <span class="instance-variable">@page_break_trigger</span> <span class="keyword">and</span> !<span class="instance-variable">@in_footer</span> <span class="keyword">and</span> AcceptPageBreak())
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2150">
      <a href="#L2150">2150</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Automatic page break</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2151">
      <a href="#L2151">2151</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> <span class="instance-variable">@pages</span>[<span class="instance-variable">@page</span>+<span class="integer">1</span>].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2152">
      <a href="#L2152">2152</a>
    </th>
    <td class="line-code">
      <pre>                                x = <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2153">
      <a href="#L2153">2153</a>
    </th>
    <td class="line-code">
      <pre>                                ws = <span class="instance-variable">@ws</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2154">
      <a href="#L2154">2154</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2155">
      <a href="#L2155">2155</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@ws</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2156">
      <a href="#L2156">2156</a>
    </th>
    <td class="line-code">
      <pre>                                        out(<span class="string"><span class="delimiter">'</span><span class="content">0 Tw</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2157">
      <a href="#L2157">2157</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2158">
      <a href="#L2158">2158</a>
    </th>
    <td class="line-code">
      <pre>                                AddPage(<span class="instance-variable">@cur_orientation</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2159">
      <a href="#L2159">2159</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2160">
      <a href="#L2160">2160</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (ws &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2161">
      <a href="#L2161">2161</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@ws</span> = ws;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2162">
      <a href="#L2162">2162</a>
    </th>
    <td class="line-code">
      <pre>                                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.3f Tw</span><span class="delimiter">'</span></span>, ws * k));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2163">
      <a href="#L2163">2163</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2164">
      <a href="#L2164">2164</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2165">
      <a href="#L2165">2165</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2166">
      <a href="#L2166">2166</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@y</span>=<span class="instance-variable">@t_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2167">
      <a href="#L2167">2167</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2168">
      <a href="#L2168">2168</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2169">
      <a href="#L2169">2169</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2170">
      <a href="#L2170">2170</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2171">
      <a href="#L2171">2171</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:ln</span>, <span class="symbol">:Ln</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2172">
      <a href="#L2172">2172</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2173">
      <a href="#L2173">2173</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2174">
      <a href="#L2174">2174</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the abscissa of the current position.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2175">
      <a href="#L2175">2175</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return float</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2176">
      <a href="#L2176">2176</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2177">
      <a href="#L2177">2177</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetX(), GetY(), SetY()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2178">
      <a href="#L2178">2178</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2179">
      <a href="#L2179">2179</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetX</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2180">
      <a href="#L2180">2180</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Get x position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2181">
      <a href="#L2181">2181</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2182">
      <a href="#L2182">2182</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2183">
      <a href="#L2183">2183</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_x</span>, <span class="symbol">:GetX</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2184">
      <a href="#L2184">2184</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2185">
      <a href="#L2185">2185</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2186">
      <a href="#L2186">2186</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the abscissa of the current position. If the passed value is negative, it is relative to the right of the page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2187">
      <a href="#L2187">2187</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x The value of the abscissa.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2188">
      <a href="#L2188">2188</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2189">
      <a href="#L2189">2189</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see GetX(), GetY(), SetY(), SetXY()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2190">
      <a href="#L2190">2190</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2191">
      <a href="#L2191">2191</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetX</span>(x)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2192">
      <a href="#L2192">2192</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set x position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2193">
      <a href="#L2193">2193</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (x&gt;=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2194">
      <a href="#L2194">2194</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2195">
      <a href="#L2195">2195</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2196">
      <a href="#L2196">2196</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span>=<span class="instance-variable">@w</span>+x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2197">
      <a href="#L2197">2197</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2198">
      <a href="#L2198">2198</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2199">
      <a href="#L2199">2199</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_x</span>, <span class="symbol">:SetX</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2200">
      <a href="#L2200">2200</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2201">
      <a href="#L2201">2201</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2202">
      <a href="#L2202">2202</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns the ordinate of the current position.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2203">
      <a href="#L2203">2203</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return float</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2204">
      <a href="#L2204">2204</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2205">
      <a href="#L2205">2205</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetY(), GetX(), SetX()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2206">
      <a href="#L2206">2206</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2207">
      <a href="#L2207">2207</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetY</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2208">
      <a href="#L2208">2208</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Get y position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2209">
      <a href="#L2209">2209</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2210">
      <a href="#L2210">2210</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2211">
      <a href="#L2211">2211</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:get_y</span>, <span class="symbol">:GetY</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2212">
      <a href="#L2212">2212</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2213">
      <a href="#L2213">2213</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2214">
      <a href="#L2214">2214</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Moves the current abscissa back to the left margin and sets the ordinate. If the passed value is negative, it is relative to the bottom of the page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2215">
      <a href="#L2215">2215</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y The value of the ordinate.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2216">
      <a href="#L2216">2216</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2217">
      <a href="#L2217">2217</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see GetX(), GetY(), SetY(), SetXY()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2218">
      <a href="#L2218">2218</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2219">
      <a href="#L2219">2219</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetY</span>(y)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2220">
      <a href="#L2220">2220</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set y position and reset x</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2221">
      <a href="#L2221">2221</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@x</span>=<span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2222">
      <a href="#L2222">2222</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (y&gt;=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2223">
      <a href="#L2223">2223</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> = y;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2224">
      <a href="#L2224">2224</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2225">
      <a href="#L2225">2225</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span>=<span class="instance-variable">@h</span>+y;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2226">
      <a href="#L2226">2226</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2227">
      <a href="#L2227">2227</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2228">
      <a href="#L2228">2228</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_y</span>, <span class="symbol">:SetY</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2229">
      <a href="#L2229">2229</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2230">
      <a href="#L2230">2230</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2231">
      <a href="#L2231">2231</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Defines the abscissa and ordinate of the current position. If the passed values are negative, they are relative respectively to the right and bottom of the page.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2232">
      <a href="#L2232">2232</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x The value of the abscissa</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2233">
      <a href="#L2233">2233</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y The value of the ordinate</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2234">
      <a href="#L2234">2234</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2235">
      <a href="#L2235">2235</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see SetX(), SetY()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2236">
      <a href="#L2236">2236</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2237">
      <a href="#L2237">2237</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetXY</span>(x, y)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2238">
      <a href="#L2238">2238</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Set x and y positions</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2239">
      <a href="#L2239">2239</a>
    </th>
    <td class="line-code">
      <pre>                SetY(y);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2240">
      <a href="#L2240">2240</a>
    </th>
    <td class="line-code">
      <pre>                SetX(x);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2241">
      <a href="#L2241">2241</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2242">
      <a href="#L2242">2242</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:set_xy</span>, <span class="symbol">:SetXY</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2243">
      <a href="#L2243">2243</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2244">
      <a href="#L2244">2244</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2245">
      <a href="#L2245">2245</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Send the document to a given destination: string, local file or browser. In the last case, the plug-in may be used (if present) or a download (&quot;Save as&quot; dialog box) may be forced.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2246">
      <a href="#L2246">2246</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># The method first calls Close() if necessary to terminate the document.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2247">
      <a href="#L2247">2247</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :name The name of the file. If not given, the document will be sent to the browser (destination I) with the name doc.pdf.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2248">
      <a href="#L2248">2248</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :dest Destination where to send the document. It can take one of the following values:&lt;ul&gt;&lt;li&gt;I: send the file inline to the browser. The plug-in is used if available. The name given by name is used when one selects the &quot;Save as&quot; option on the link generating the PDF.&lt;/li&gt;&lt;li&gt;D: send to the browser and force a file download with the name given by name.&lt;/li&gt;&lt;li&gt;F: save to a local file with the name given by name.&lt;/li&gt;&lt;li&gt;S: return the document as a string. name is ignored.&lt;/li&gt;&lt;/ul&gt;If the parameter is not specified but a name is given, destination is F. If no parameter is specified at all, destination is I.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2249">
      <a href="#L2249">2249</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2250">
      <a href="#L2250">2250</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Close()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2251">
      <a href="#L2251">2251</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2252">
      <a href="#L2252">2252</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">Output</span>(name=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, dest=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2253">
      <a href="#L2253">2253</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Output PDF to some destination</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2254">
      <a href="#L2254">2254</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Finish document if necessary</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2255">
      <a href="#L2255">2255</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@state</span> &lt; <span class="integer">3</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2256">
      <a href="#L2256">2256</a>
    </th>
    <td class="line-code">
      <pre>                        Close();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2257">
      <a href="#L2257">2257</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2258">
      <a href="#L2258">2258</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Normalize parameters</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2259">
      <a href="#L2259">2259</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># Boolean no longer supported</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2260">
      <a href="#L2260">2260</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># if (dest.is_a?(Boolean))</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2261">
      <a href="#L2261">2261</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#         dest = dest ? 'D' : 'F';</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2262">
      <a href="#L2262">2262</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2263">
      <a href="#L2263">2263</a>
    </th>
    <td class="line-code">
      <pre>                dest = dest.upcase
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2264">
      <a href="#L2264">2264</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (dest==<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2265">
      <a href="#L2265">2265</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (name==<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2266">
      <a href="#L2266">2266</a>
    </th>
    <td class="line-code">
      <pre>                                name=<span class="string"><span class="delimiter">'</span><span class="content">doc.pdf</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2267">
      <a href="#L2267">2267</a>
    </th>
    <td class="line-code">
      <pre>                                dest=<span class="string"><span class="delimiter">'</span><span class="content">I</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2268">
      <a href="#L2268">2268</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2269">
      <a href="#L2269">2269</a>
    </th>
    <td class="line-code">
      <pre>                                dest=<span class="string"><span class="delimiter">'</span><span class="content">F</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2270">
      <a href="#L2270">2270</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2271">
      <a href="#L2271">2271</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2272">
      <a href="#L2272">2272</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (dest)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2273">
      <a href="#L2273">2273</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">I</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2274">
      <a href="#L2274">2274</a>
    </th>
    <td class="line-code">
      <pre>                          <span class="comment"># This is PHP specific code</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2275">
      <a href="#L2275">2275</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">##Send to standard output</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2276">
      <a href="#L2276">2276</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># if (ob_get_contents())</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2277">
      <a href="#L2277">2277</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         Error('Some data has already been output, can\'t send PDF file');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2278">
      <a href="#L2278">2278</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2279">
      <a href="#L2279">2279</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># if (php_sapi_name()!='cli')</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2280">
      <a href="#L2280">2280</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         #We send to a browser</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2281">
      <a href="#L2281">2281</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         header('Content-Type: application/pdf');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2282">
      <a href="#L2282">2282</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         if (headers_sent())</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2283">
      <a href="#L2283">2283</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#                 Error('Some data has already been output to browser, can\'t send PDF file');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2284">
      <a href="#L2284">2284</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2285">
      <a href="#L2285">2285</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         header('Content-Length: ' + @buffer.length);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2286">
      <a href="#L2286">2286</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         header('Content-disposition: inline; filename=&quot;' + name + '&quot;');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2287">
      <a href="#L2287">2287</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2288">
      <a href="#L2288">2288</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">return</span> <span class="instance-variable">@buffer</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2289">
      <a href="#L2289">2289</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2290">
      <a href="#L2290">2290</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">D</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2291">
      <a href="#L2291">2291</a>
    </th>
    <td class="line-code">
      <pre>                          <span class="comment"># PHP specific</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2292">
      <a href="#L2292">2292</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Download file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2293">
      <a href="#L2293">2293</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># if (ob_get_contents())</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2294">
      <a href="#L2294">2294</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         Error('Some data has already been output, can\'t send PDF file');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2295">
      <a href="#L2295">2295</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2296">
      <a href="#L2296">2296</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># if (!_SERVER['HTTP_USER_AGENT'].nil? &amp;&amp; SERVER['HTTP_USER_AGENT'].include?('MSIE'))</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2297">
      <a href="#L2297">2297</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         header('Content-Type: application/force-download');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2298">
      <a href="#L2298">2298</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2299">
      <a href="#L2299">2299</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         header('Content-Type: application/octet-stream');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2300">
      <a href="#L2300">2300</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2301">
      <a href="#L2301">2301</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># if (headers_sent())</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2302">
      <a href="#L2302">2302</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#         Error('Some data has already been output to browser, can\'t send PDF file');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2303">
      <a href="#L2303">2303</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2304">
      <a href="#L2304">2304</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># header('Content-Length: '+ @buffer.length);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2305">
      <a href="#L2305">2305</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># header('Content-disposition: attachment; filename=&quot;' + name + '&quot;');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2306">
      <a href="#L2306">2306</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">return</span> <span class="instance-variable">@buffer</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2307">
      <a href="#L2307">2307</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2308">
      <a href="#L2308">2308</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">F</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2309">
      <a href="#L2309">2309</a>
    </th>
    <td class="line-code">
      <pre>        open(name,<span class="string"><span class="delimiter">'</span><span class="content">wb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2310">
      <a href="#L2310">2310</a>
    </th>
    <td class="line-code">
      <pre>          f.write(<span class="instance-variable">@buffer</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2311">
      <a href="#L2311">2311</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2312">
      <a href="#L2312">2312</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment"># PHP code</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2313">
      <a href="#L2313">2313</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 #Save to local file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2314">
      <a href="#L2314">2314</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 f=open(name,'wb');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2315">
      <a href="#L2315">2315</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 if (!f)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2316">
      <a href="#L2316">2316</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                         Error('Unable to create output file: ' + name);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2317">
      <a href="#L2317">2317</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2318">
      <a href="#L2318">2318</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 fwrite(f,@buffer,@buffer.length);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2319">
      <a href="#L2319">2319</a>
    </th>
    <td class="line-code">
      <pre>                           <span class="comment">#                                 f.close</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2320">
      <a href="#L2320">2320</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2321">
      <a href="#L2321">2321</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">S</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2322">
      <a href="#L2322">2322</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Return as a string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2323">
      <a href="#L2323">2323</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">return</span> <span class="instance-variable">@buffer</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2324">
      <a href="#L2324">2324</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2325">
      <a href="#L2325">2325</a>
    </th>
    <td class="line-code">
      <pre>                                Error(<span class="string"><span class="delimiter">'</span><span class="content">Incorrect output destination: </span><span class="delimiter">'</span></span> + dest);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2326">
      <a href="#L2326">2326</a>
    </th>
    <td class="line-code">
      <pre>                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2327">
      <a href="#L2327">2327</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2328">
      <a href="#L2328">2328</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2329">
      <a href="#L2329">2329</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2330">
      <a href="#L2330">2330</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:output</span>, <span class="symbol">:Output</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2331">
      <a href="#L2331">2331</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2332">
      <a href="#L2332">2332</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Protected methods</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2333">
      <a href="#L2333">2333</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2334">
      <a href="#L2334">2334</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2335">
      <a href="#L2335">2335</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Check for locale-related bug</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2336">
      <a href="#L2336">2336</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2337">
      <a href="#L2337">2337</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2338">
      <a href="#L2338">2338</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">dochecks</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2339">
      <a href="#L2339">2339</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Check for locale-related bug</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2340">
      <a href="#L2340">2340</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="float">1.1</span>==<span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2341">
      <a href="#L2341">2341</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Don</span><span class="char">\'</span><span class="content">t alter the locale before including class file</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2342">
      <a href="#L2342">2342</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2343">
      <a href="#L2343">2343</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Check for decimal separator</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2344">
      <a href="#L2344">2344</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.1f</span><span class="delimiter">'</span></span>,<span class="float">1.0</span>)!=<span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2345">
      <a href="#L2345">2345</a>
    </th>
    <td class="line-code">
      <pre>                        setlocale(<span class="constant">LC_NUMERIC</span>,<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2346">
      <a href="#L2346">2346</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2347">
      <a href="#L2347">2347</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2348">
      <a href="#L2348">2348</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2349">
      <a href="#L2349">2349</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2350">
      <a href="#L2350">2350</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Return fonts path</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2351">
      <a href="#L2351">2351</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2352">
      <a href="#L2352">2352</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2353">
      <a href="#L2353">2353</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">getfontpath</span>(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2354">
      <a href="#L2354">2354</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Is it in the @@font_path?</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2355">
      <a href="#L2355">2355</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">if</span> <span class="class-variable">@@font_path</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2356">
      <a href="#L2356">2356</a>
    </th>
    <td class="line-code">
      <pre>                  fpath = <span class="constant">File</span>.join <span class="class-variable">@@font_path</span>, file
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2357">
      <a href="#L2357">2357</a>
    </th>
    <td class="line-code">
      <pre>            <span class="keyword">if</span> <span class="constant">File</span>.exists?(fpath)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2358">
      <a href="#L2358">2358</a>
    </th>
    <td class="line-code">
      <pre>              <span class="keyword">return</span> fpath
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2359">
      <a href="#L2359">2359</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2360">
      <a href="#L2360">2360</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2361">
      <a href="#L2361">2361</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Is it in this plugin's font folder?</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2362">
      <a href="#L2362">2362</a>
    </th>
    <td class="line-code">
      <pre>                fpath = <span class="constant">File</span>.join <span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>), <span class="string"><span class="delimiter">'</span><span class="content">fonts</span><span class="delimiter">'</span></span>, file
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2363">
      <a href="#L2363">2363</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">if</span> <span class="constant">File</span>.exists?(fpath)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2364">
      <a href="#L2364">2364</a>
    </th>
    <td class="line-code">
      <pre>            <span class="keyword">return</span> fpath
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2365">
      <a href="#L2365">2365</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2366">
      <a href="#L2366">2366</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Could not find it.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2367">
      <a href="#L2367">2367</a>
    </th>
    <td class="line-code">
      <pre>    <span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2368">
      <a href="#L2368">2368</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2369">
      <a href="#L2369">2369</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2370">
      <a href="#L2370">2370</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2371">
      <a href="#L2371">2371</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Start document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2372">
      <a href="#L2372">2372</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2373">
      <a href="#L2373">2373</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2374">
      <a href="#L2374">2374</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">begindoc</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2375">
      <a href="#L2375">2375</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Start document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2376">
      <a href="#L2376">2376</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span>=<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2377">
      <a href="#L2377">2377</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">%PDF-1.3</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2378">
      <a href="#L2378">2378</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2379">
      <a href="#L2379">2379</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2380">
      <a href="#L2380">2380</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2381">
      <a href="#L2381">2381</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putpages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2382">
      <a href="#L2382">2382</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2383">
      <a href="#L2383">2383</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2384">
      <a href="#L2384">2384</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putpages</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2385">
      <a href="#L2385">2385</a>
    </th>
    <td class="line-code">
      <pre>                nb = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2386">
      <a href="#L2386">2386</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@alias_nb_pages</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2387">
      <a href="#L2387">2387</a>
    </th>
    <td class="line-code">
      <pre>                        nbstr = UTF8ToUTF16BE(nb.to_s, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2388">
      <a href="#L2388">2388</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Replace number of pages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2389">
      <a href="#L2389">2389</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="integer">1</span>.upto(nb) <span class="keyword">do</span> |n|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2390">
      <a href="#L2390">2390</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@pages</span>[n].gsub!(<span class="instance-variable">@alias_nb_pages</span>, nbstr)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2391">
      <a href="#L2391">2391</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2392">
      <a href="#L2392">2392</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2393">
      <a href="#L2393">2393</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> <span class="instance-variable">@def_orientation</span>==<span class="string"><span class="delimiter">'</span><span class="content">P</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2394">
      <a href="#L2394">2394</a>
    </th>
    <td class="line-code">
      <pre>                        w_pt=<span class="instance-variable">@fw_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2395">
      <a href="#L2395">2395</a>
    </th>
    <td class="line-code">
      <pre>                        h_pt=<span class="instance-variable">@fh_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2396">
      <a href="#L2396">2396</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2397">
      <a href="#L2397">2397</a>
    </th>
    <td class="line-code">
      <pre>                        w_pt=<span class="instance-variable">@fh_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2398">
      <a href="#L2398">2398</a>
    </th>
    <td class="line-code">
      <pre>                        h_pt=<span class="instance-variable">@fw_pt</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2399">
      <a href="#L2399">2399</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2400">
      <a href="#L2400">2400</a>
    </th>
    <td class="line-code">
      <pre>                filter=(<span class="instance-variable">@compress</span>) ? <span class="string"><span class="delimiter">'</span><span class="content">/Filter /FlateDecode </span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2401">
      <a href="#L2401">2401</a>
    </th>
    <td class="line-code">
      <pre>                <span class="integer">1</span>.upto(nb) <span class="keyword">do</span> |n|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2402">
      <a href="#L2402">2402</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2403">
      <a href="#L2403">2403</a>
    </th>
    <td class="line-code">
      <pre>                        newobj
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2404">
      <a href="#L2404">2404</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Page</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2405">
      <a href="#L2405">2405</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Parent 1 0 R</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2406">
      <a href="#L2406">2406</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">unless</span> <span class="instance-variable">@orientation_changes</span>[n].nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2407">
      <a href="#L2407">2407</a>
    </th>
    <td class="line-code">
      <pre>                                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">/MediaBox [0 0 %.2f %.2f]</span><span class="delimiter">'</span></span>, h_pt, w_pt))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2408">
      <a href="#L2408">2408</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2409">
      <a href="#L2409">2409</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Resources 2 0 R</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2410">
      <a href="#L2410">2410</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> <span class="instance-variable">@page_links</span>[n]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2411">
      <a href="#L2411">2411</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Links</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2412">
      <a href="#L2412">2412</a>
    </th>
    <td class="line-code">
      <pre>                                annots=<span class="string"><span class="delimiter">'</span><span class="content">/Annots [</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2413">
      <a href="#L2413">2413</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@page_links</span>[n].each <span class="keyword">do</span> |pl|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2414">
      <a href="#L2414">2414</a>
    </th>
    <td class="line-code">
      <pre>                                        rect=sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f %.2f %.2f</span><span class="delimiter">'</span></span>, pl[<span class="integer">0</span>], pl[<span class="integer">1</span>], pl[<span class="integer">0</span>]+pl[<span class="integer">2</span>], pl[<span class="integer">1</span>]-pl[<span class="integer">3</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2415">
      <a href="#L2415">2415</a>
    </th>
    <td class="line-code">
      <pre>                                        annots&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Annot /Subtype /Link /Rect [</span><span class="delimiter">'</span></span> + rect + <span class="string"><span class="delimiter">'</span><span class="content">] /Border [0 0 0] </span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2416">
      <a href="#L2416">2416</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (pl[<span class="integer">4</span>].is_a?(<span class="constant">String</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2417">
      <a href="#L2417">2417</a>
    </th>
    <td class="line-code">
      <pre>                                                annots&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">/A &lt;&lt;/S /URI /URI (</span><span class="delimiter">'</span></span> + escape(pl[<span class="integer">4</span>]) + <span class="string"><span class="delimiter">'</span><span class="content">)&gt;&gt;&gt;&gt;</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2418">
      <a href="#L2418">2418</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2419">
      <a href="#L2419">2419</a>
    </th>
    <td class="line-code">
      <pre>                                                l=<span class="instance-variable">@links</span>[pl[<span class="integer">4</span>]];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2420">
      <a href="#L2420">2420</a>
    </th>
    <td class="line-code">
      <pre>                                                h=!<span class="instance-variable">@orientation_changes</span>[l[<span class="integer">0</span>]].nil? ? w_pt : h_pt;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2421">
      <a href="#L2421">2421</a>
    </th>
    <td class="line-code">
      <pre>                                                annots&lt;&lt;sprintf(<span class="string"><span class="delimiter">'</span><span class="content">/Dest [%d 0 R /XYZ 0 %.2f null]&gt;&gt;</span><span class="delimiter">'</span></span>,<span class="integer">1</span>+<span class="integer">2</span>*l[<span class="integer">0</span>], h-l[<span class="integer">1</span>]*<span class="instance-variable">@k</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2422">
      <a href="#L2422">2422</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2423">
      <a href="#L2423">2423</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2424">
      <a href="#L2424">2424</a>
    </th>
    <td class="line-code">
      <pre>                                out(annots + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2425">
      <a href="#L2425">2425</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2426">
      <a href="#L2426">2426</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Contents </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2427">
      <a href="#L2427">2427</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2428">
      <a href="#L2428">2428</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Page content</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2429">
      <a href="#L2429">2429</a>
    </th>
    <td class="line-code">
      <pre>                        p=(<span class="instance-variable">@compress</span>) ? gzcompress(<span class="instance-variable">@pages</span>[n]) : <span class="instance-variable">@pages</span>[n];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2430">
      <a href="#L2430">2430</a>
    </th>
    <td class="line-code">
      <pre>                        newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2431">
      <a href="#L2431">2431</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span> + filter + <span class="string"><span class="delimiter">'</span><span class="content">/Length </span><span class="delimiter">'</span></span>+ p.length.to_s + <span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2432">
      <a href="#L2432">2432</a>
    </th>
    <td class="line-code">
      <pre>                        putstream(p);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2433">
      <a href="#L2433">2433</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2434">
      <a href="#L2434">2434</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2435">
      <a href="#L2435">2435</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Pages root</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2436">
      <a href="#L2436">2436</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@offsets</span>[<span class="integer">1</span>]=<span class="instance-variable">@buffer</span>.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2437">
      <a href="#L2437">2437</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">1 0 obj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2438">
      <a href="#L2438">2438</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Pages</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2439">
      <a href="#L2439">2439</a>
    </th>
    <td class="line-code">
      <pre>                kids=<span class="string"><span class="delimiter">'</span><span class="content">/Kids [</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2440">
      <a href="#L2440">2440</a>
    </th>
    <td class="line-code">
      <pre>                <span class="integer">0</span>.upto(nb) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2441">
      <a href="#L2441">2441</a>
    </th>
    <td class="line-code">
      <pre>                        kids&lt;&lt;(<span class="integer">3</span>+<span class="integer">2</span>*i).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R </span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2442">
      <a href="#L2442">2442</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2443">
      <a href="#L2443">2443</a>
    </th>
    <td class="line-code">
      <pre>                out(kids + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2444">
      <a href="#L2444">2444</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Count </span><span class="delimiter">'</span></span> + nb.to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2445">
      <a href="#L2445">2445</a>
    </th>
    <td class="line-code">
      <pre>                out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">/MediaBox [0 0 %.2f %.2f]</span><span class="delimiter">'</span></span>, w_pt, h_pt));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2446">
      <a href="#L2446">2446</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2447">
      <a href="#L2447">2447</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2448">
      <a href="#L2448">2448</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2449">
      <a href="#L2449">2449</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2450">
      <a href="#L2450">2450</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2451">
      <a href="#L2451">2451</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Adds fonts</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2452">
      <a href="#L2452">2452</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putfonts</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2453">
      <a href="#L2453">2453</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2454">
      <a href="#L2454">2454</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2455">
      <a href="#L2455">2455</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putfonts</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2456">
      <a href="#L2456">2456</a>
    </th>
    <td class="line-code">
      <pre>                nf=<span class="instance-variable">@n</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2457">
      <a href="#L2457">2457</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@diffs</span>.each <span class="keyword">do</span> |diff|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2458">
      <a href="#L2458">2458</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Encodings</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2459">
      <a href="#L2459">2459</a>
    </th>
    <td class="line-code">
      <pre>                        newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2460">
      <a href="#L2460">2460</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences [</span><span class="delimiter">'</span></span> + diff + <span class="string"><span class="delimiter">'</span><span class="content">]&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2461">
      <a href="#L2461">2461</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2462">
      <a href="#L2462">2462</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2463">
      <a href="#L2463">2463</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_files</span>.each <span class="keyword">do</span> |file, info|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2464">
      <a href="#L2464">2464</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Font file embedding</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2465">
      <a href="#L2465">2465</a>
    </th>
    <td class="line-code">
      <pre>                        newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2466">
      <a href="#L2466">2466</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@font_files</span>[file][<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>]=<span class="instance-variable">@n</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2467">
      <a href="#L2467">2467</a>
    </th>
    <td class="line-code">
      <pre>                        font=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2468">
      <a href="#L2468">2468</a>
    </th>
    <td class="line-code">
      <pre>                        open(getfontpath(file),<span class="string"><span class="delimiter">'</span><span class="content">rb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2469">
      <a href="#L2469">2469</a>
    </th>
    <td class="line-code">
      <pre>                                font = f.read();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2470">
      <a href="#L2470">2470</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2471">
      <a href="#L2471">2471</a>
    </th>
    <td class="line-code">
      <pre>                        compressed=(file[<span class="integer">-2</span>,<span class="integer">2</span>]==<span class="string"><span class="delimiter">'</span><span class="content">.z</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2472">
      <a href="#L2472">2472</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!compressed &amp;&amp; !info[<span class="string"><span class="delimiter">'</span><span class="content">length2</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2473">
      <a href="#L2473">2473</a>
    </th>
    <td class="line-code">
      <pre>                                header=((font[<span class="integer">0</span>][<span class="integer">0</span>])==<span class="integer">128</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2474">
      <a href="#L2474">2474</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (header)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2475">
      <a href="#L2475">2475</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#Strip first binary header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2476">
      <a href="#L2476">2476</a>
    </th>
    <td class="line-code">
      <pre>                                        font=font[<span class="integer">6</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2477">
      <a href="#L2477">2477</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2478">
      <a href="#L2478">2478</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> header &amp;&amp; (font[info[<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span>]][<span class="integer">0</span>] == <span class="integer">128</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2479">
      <a href="#L2479">2479</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#Strip second binary header</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2480">
      <a href="#L2480">2480</a>
    </th>
    <td class="line-code">
      <pre>                                        font=font[<span class="integer">0</span>..info[<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span>]] + font[info[<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span>]+<span class="integer">6</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2481">
      <a href="#L2481">2481</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2482">
      <a href="#L2482">2482</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2483">
      <a href="#L2483">2483</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Length </span><span class="delimiter">'</span></span>+ font.length.to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2484">
      <a href="#L2484">2484</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (compressed)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2485">
      <a href="#L2485">2485</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Filter /FlateDecode</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2486">
      <a href="#L2486">2486</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2487">
      <a href="#L2487">2487</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Length1 </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">length1</span><span class="delimiter">'</span></span>].to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2488">
      <a href="#L2488">2488</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!info[<span class="string"><span class="delimiter">'</span><span class="content">length2</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2489">
      <a href="#L2489">2489</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Length2 </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">length2</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> /Length3 0</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2490">
      <a href="#L2490">2490</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2491">
      <a href="#L2491">2491</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2492">
      <a href="#L2492">2492</a>
    </th>
    <td class="line-code">
      <pre>                        open(getfontpath(file),<span class="string"><span class="delimiter">'</span><span class="content">rb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2493">
      <a href="#L2493">2493</a>
    </th>
    <td class="line-code">
      <pre>        putstream(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2494">
      <a href="#L2494">2494</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2495">
      <a href="#L2495">2495</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2496">
      <a href="#L2496">2496</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2497">
      <a href="#L2497">2497</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fonts</span>.each <span class="keyword">do</span> |k, font|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2498">
      <a href="#L2498">2498</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Font objects</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2499">
      <a href="#L2499">2499</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@fonts</span>[k][<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>]=<span class="instance-variable">@n</span>+<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2500">
      <a href="#L2500">2500</a>
    </th>
    <td class="line-code">
      <pre>                        type = font[<span class="string"><span class="delimiter">'</span><span class="content">type</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2501">
      <a href="#L2501">2501</a>
    </th>
    <td class="line-code">
      <pre>                        name = font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2502">
      <a href="#L2502">2502</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">core</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2503">
      <a href="#L2503">2503</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Standard font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2504">
      <a href="#L2504">2504</a>
    </th>
    <td class="line-code">
      <pre>                                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2505">
      <a href="#L2505">2505</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2506">
      <a href="#L2506">2506</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span> + name);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2507">
      <a href="#L2507">2507</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /Type1</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2508">
      <a href="#L2508">2508</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (name!=<span class="string"><span class="delimiter">'</span><span class="content">Symbol</span><span class="delimiter">'</span></span> &amp;&amp; name!=<span class="string"><span class="delimiter">'</span><span class="content">ZapfDingbats</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2509">
      <a href="#L2509">2509</a>
    </th>
    <td class="line-code">
      <pre>                                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Encoding /WinAnsiEncoding</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2510">
      <a href="#L2510">2510</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2511">
      <a href="#L2511">2511</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2512">
      <a href="#L2512">2512</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2513">
      <a href="#L2513">2513</a>
    </th>
    <td class="line-code">
      <pre>            <span class="keyword">elsif</span> type == <span class="string"><span class="delimiter">'</span><span class="content">Type0</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2514">
      <a href="#L2514">2514</a>
    </th>
    <td class="line-code">
      <pre>                    putType0(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2515">
      <a href="#L2515">2515</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">Type1</span><span class="delimiter">'</span></span> || type==<span class="string"><span class="delimiter">'</span><span class="content">TrueType</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2516">
      <a href="#L2516">2516</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Additional Type1 or TrueType font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2517">
      <a href="#L2517">2517</a>
    </th>
    <td class="line-code">
      <pre>                                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2518">
      <a href="#L2518">2518</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2519">
      <a href="#L2519">2519</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span> + name);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2520">
      <a href="#L2520">2520</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /</span><span class="delimiter">'</span></span> + type);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2521">
      <a href="#L2521">2521</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/FirstChar 32 /LastChar 255</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2522">
      <a href="#L2522">2522</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Widths </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2523">
      <a href="#L2523">2523</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/FontDescriptor </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">2</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2524">
      <a href="#L2524">2524</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (font[<span class="string"><span class="delimiter">'</span><span class="content">enc</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2525">
      <a href="#L2525">2525</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (!font[<span class="string"><span class="delimiter">'</span><span class="content">diff</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2526">
      <a href="#L2526">2526</a>
    </th>
    <td class="line-code">
      <pre>                                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Encoding </span><span class="delimiter">'</span></span> + (nf+font[<span class="string"><span class="delimiter">'</span><span class="content">diff</span><span class="delimiter">'</span></span>]).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2527">
      <a href="#L2527">2527</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2528">
      <a href="#L2528">2528</a>
    </th>
    <td class="line-code">
      <pre>                                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Encoding /WinAnsiEncoding</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2529">
      <a href="#L2529">2529</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2530">
      <a href="#L2530">2530</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2531">
      <a href="#L2531">2531</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2532">
      <a href="#L2532">2532</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2533">
      <a href="#L2533">2533</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Widths</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2534">
      <a href="#L2534">2534</a>
    </th>
    <td class="line-code">
      <pre>                                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2535">
      <a href="#L2535">2535</a>
    </th>
    <td class="line-code">
      <pre>                                cw=font[<span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span>]; <span class="comment"># &amp;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2536">
      <a href="#L2536">2536</a>
    </th>
    <td class="line-code">
      <pre>                                s=<span class="string"><span class="delimiter">'</span><span class="content">[</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2537">
      <a href="#L2537">2537</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="integer">32</span>.upto(<span class="integer">255</span>) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2538">
      <a href="#L2538">2538</a>
    </th>
    <td class="line-code">
      <pre>                                        s &lt;&lt; cw[i.chr] + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2539">
      <a href="#L2539">2539</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2540">
      <a href="#L2540">2540</a>
    </th>
    <td class="line-code">
      <pre>                                out(s + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2541">
      <a href="#L2541">2541</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2542">
      <a href="#L2542">2542</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Descriptor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2543">
      <a href="#L2543">2543</a>
    </th>
    <td class="line-code">
      <pre>                                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2544">
      <a href="#L2544">2544</a>
    </th>
    <td class="line-code">
      <pre>                                s=<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /FontDescriptor /FontName /</span><span class="delimiter">'</span></span> + name;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2545">
      <a href="#L2545">2545</a>
    </th>
    <td class="line-code">
      <pre>                                font[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |k, v|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2546">
      <a href="#L2546">2546</a>
    </th>
    <td class="line-code">
      <pre>                                        s&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content"> /</span><span class="delimiter">'</span></span> + k + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + v;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2547">
      <a href="#L2547">2547</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2548">
      <a href="#L2548">2548</a>
    </th>
    <td class="line-code">
      <pre>                                file = font[<span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2549">
      <a href="#L2549">2549</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2550">
      <a href="#L2550">2550</a>
    </th>
    <td class="line-code">
      <pre>                                        s&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content"> /FontFile</span><span class="delimiter">'</span></span> + (type==<span class="string"><span class="delimiter">'</span><span class="content">Type1</span><span class="delimiter">'</span></span> ? <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="content">2</span><span class="delimiter">'</span></span>) + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + <span class="instance-variable">@font_files</span>[file][<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>] + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2551">
      <a href="#L2551">2551</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2552">
      <a href="#L2552">2552</a>
    </th>
    <td class="line-code">
      <pre>                                out(s + <span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2553">
      <a href="#L2553">2553</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2554">
      <a href="#L2554">2554</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2555">
      <a href="#L2555">2555</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Allow for additional types</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2556">
      <a href="#L2556">2556</a>
    </th>
    <td class="line-code">
      <pre>                                mtd=<span class="string"><span class="delimiter">'</span><span class="content">put</span><span class="delimiter">'</span></span> + type.downcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2557">
      <a href="#L2557">2557</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!<span class="predefined-constant">self</span>.respond_to?(mtd))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2558">
      <a href="#L2558">2558</a>
    </th>
    <td class="line-code">
      <pre>                                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Unsupported font type: </span><span class="delimiter">'</span></span> + type)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2559">
      <a href="#L2559">2559</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2560">
      <a href="#L2560">2560</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="predefined-constant">self</span>.send(mtd,font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2561">
      <a href="#L2561">2561</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2562">
      <a href="#L2562">2562</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2563">
      <a href="#L2563">2563</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2564">
      <a href="#L2564">2564</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2565">
      <a href="#L2565">2565</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2566">
      <a href="#L2566">2566</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">def</span> <span class="function">putType0</span>(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2567">
      <a href="#L2567">2567</a>
    </th>
    <td class="line-code">
      <pre>          <span class="comment">#Type0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2568">
      <a href="#L2568">2568</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2569">
      <a href="#L2569">2569</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2570">
      <a href="#L2570">2570</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /Type0</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2571">
      <a href="#L2571">2571</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>]+<span class="string"><span class="delimiter">'</span><span class="content">-</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">cMap</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2572">
      <a href="#L2572">2572</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Encoding /</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">cMap</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2573">
      <a href="#L2573">2573</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/DescendantFonts [</span><span class="delimiter">'</span></span>+(<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s+<span class="string"><span class="delimiter">'</span><span class="content"> 0 R]</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2574">
      <a href="#L2574">2574</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2575">
      <a href="#L2575">2575</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2576">
      <a href="#L2576">2576</a>
    </th>
    <td class="line-code">
      <pre>          <span class="comment">#CIDFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2577">
      <a href="#L2577">2577</a>
    </th>
    <td class="line-code">
      <pre>          newobj()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2578">
      <a href="#L2578">2578</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2579">
      <a href="#L2579">2579</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /CIDFontType0</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2580">
      <a href="#L2580">2580</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2581">
      <a href="#L2581">2581</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/CIDSystemInfo &lt;&lt;/Registry (Adobe) /Ordering (</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">registry</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">ordering</span><span class="delimiter">'</span></span>]+<span class="string"><span class="delimiter">'</span><span class="content">) /Supplement </span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">registry</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">supplement</span><span class="delimiter">'</span></span>].to_s+<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2582">
      <a href="#L2582">2582</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/FontDescriptor </span><span class="delimiter">'</span></span>+(<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s+<span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2583">
      <a href="#L2583">2583</a>
    </th>
    <td class="line-code">
      <pre>          w=<span class="string"><span class="delimiter">'</span><span class="content">/W [1 [</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2584">
      <a href="#L2584">2584</a>
    </th>
    <td class="line-code">
      <pre>                font[<span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span>].keys.sort.each {|key|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2585">
      <a href="#L2585">2585</a>
    </th>
    <td class="line-code">
      <pre>                  w+=font[<span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span>][key].to_s + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2586">
      <a href="#L2586">2586</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># ActionController::Base::logger.debug key.to_s</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2587">
      <a href="#L2587">2587</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># ActionController::Base::logger.debug font['cw'][key].to_s</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2588">
      <a href="#L2588">2588</a>
    </th>
    <td class="line-code">
      <pre>                }
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2589">
      <a href="#L2589">2589</a>
    </th>
    <td class="line-code">
      <pre>          out(w+<span class="string"><span class="delimiter">'</span><span class="content">] 231 325 500 631 [500] 326 389 500]</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2590">
      <a href="#L2590">2590</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2591">
      <a href="#L2591">2591</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2592">
      <a href="#L2592">2592</a>
    </th>
    <td class="line-code">
      <pre>          <span class="comment">#Font descriptor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2593">
      <a href="#L2593">2593</a>
    </th>
    <td class="line-code">
      <pre>          newobj()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2594">
      <a href="#L2594">2594</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /FontDescriptor</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2595">
      <a href="#L2595">2595</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/FontName /</span><span class="delimiter">'</span></span>+font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2596">
      <a href="#L2596">2596</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Flags 6</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2597">
      <a href="#L2597">2597</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/FontBBox [0 -200 1000 900]</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2598">
      <a href="#L2598">2598</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/ItalicAngle 0</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2599">
      <a href="#L2599">2599</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Ascent 800</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2600">
      <a href="#L2600">2600</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/Descent -200</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2601">
      <a href="#L2601">2601</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/CapHeight 800</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2602">
      <a href="#L2602">2602</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">/StemV 60</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2603">
      <a href="#L2603">2603</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2604">
      <a href="#L2604">2604</a>
    </th>
    <td class="line-code">
      <pre>          out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2605">
      <a href="#L2605">2605</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2606">
      <a href="#L2606">2606</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2607">
      <a href="#L2607">2607</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2608">
      <a href="#L2608">2608</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putimages</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2609">
      <a href="#L2609">2609</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2610">
      <a href="#L2610">2610</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2611">
      <a href="#L2611">2611</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putimages</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2612">
      <a href="#L2612">2612</a>
    </th>
    <td class="line-code">
      <pre>                filter=(<span class="instance-variable">@compress</span>) ? <span class="string"><span class="delimiter">'</span><span class="content">/Filter /FlateDecode </span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2613">
      <a href="#L2613">2613</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@images</span>.each <span class="keyword">do</span> |file, info| <span class="comment"># was while(list(file, info)=each(@images))</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2614">
      <a href="#L2614">2614</a>
    </th>
    <td class="line-code">
      <pre>                        newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2615">
      <a href="#L2615">2615</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@images</span>[file][<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>]=<span class="instance-variable">@n</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2616">
      <a href="#L2616">2616</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /XObject</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2617">
      <a href="#L2617">2617</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /Image</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2618">
      <a href="#L2618">2618</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Width </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>].to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2619">
      <a href="#L2619">2619</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Height </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>].to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2620">
      <a href="#L2620">2620</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (info[<span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span>]==<span class="string"><span class="delimiter">'</span><span class="content">Indexed</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2621">
      <a href="#L2621">2621</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/ColorSpace [/Indexed /DeviceRGB </span><span class="delimiter">'</span></span> + (info[<span class="string"><span class="delimiter">'</span><span class="content">pal</span><span class="delimiter">'</span></span>].length/<span class="integer">3</span>-<span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2622">
      <a href="#L2622">2622</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2623">
      <a href="#L2623">2623</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/ColorSpace /</span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2624">
      <a href="#L2624">2624</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (info[<span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span>]==<span class="string"><span class="delimiter">'</span><span class="content">DeviceCMYK</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2625">
      <a href="#L2625">2625</a>
    </th>
    <td class="line-code">
      <pre>                                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Decode [1 0 1 0 1 0 1 0]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2626">
      <a href="#L2626">2626</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2627">
      <a href="#L2627">2627</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2628">
      <a href="#L2628">2628</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/BitsPerComponent </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">bpc</span><span class="delimiter">'</span></span>].to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2629">
      <a href="#L2629">2629</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!info[<span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2630">
      <a href="#L2630">2630</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Filter /</span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2631">
      <a href="#L2631">2631</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2632">
      <a href="#L2632">2632</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!info[<span class="string"><span class="delimiter">'</span><span class="content">parms</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2633">
      <a href="#L2633">2633</a>
    </th>
    <td class="line-code">
      <pre>                                out(info[<span class="string"><span class="delimiter">'</span><span class="content">parms</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2634">
      <a href="#L2634">2634</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2635">
      <a href="#L2635">2635</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (!info[<span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span>].nil? <span class="keyword">and</span> info[<span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span>].kind_of?(<span class="constant">Array</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2636">
      <a href="#L2636">2636</a>
    </th>
    <td class="line-code">
      <pre>                                trns=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2637">
      <a href="#L2637">2637</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="integer">0</span>.upto(info[<span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span>].length) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2638">
      <a href="#L2638">2638</a>
    </th>
    <td class="line-code">
      <pre>                                        trns &lt;&lt; info[<span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span>][i] + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span>][i] + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2639">
      <a href="#L2639">2639</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2640">
      <a href="#L2640">2640</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">/Mask [</span><span class="delimiter">'</span></span> + trns + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2641">
      <a href="#L2641">2641</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2642">
      <a href="#L2642">2642</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Length </span><span class="delimiter">'</span></span> + info[<span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span>].length.to_s + <span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2643">
      <a href="#L2643">2643</a>
    </th>
    <td class="line-code">
      <pre>                        putstream(info[<span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2644">
      <a href="#L2644">2644</a>
    </th>
    <td class="line-code">
      <pre>      <span class="instance-variable">@images</span>[file][<span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span>]=<span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2645">
      <a href="#L2645">2645</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2646">
      <a href="#L2646">2646</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Palette</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2647">
      <a href="#L2647">2647</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (info[<span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span>]==<span class="string"><span class="delimiter">'</span><span class="content">Indexed</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2648">
      <a href="#L2648">2648</a>
    </th>
    <td class="line-code">
      <pre>                                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2649">
      <a href="#L2649">2649</a>
    </th>
    <td class="line-code">
      <pre>                                pal=(<span class="instance-variable">@compress</span>) ? gzcompress(info[<span class="string"><span class="delimiter">'</span><span class="content">pal</span><span class="delimiter">'</span></span>]) : info[<span class="string"><span class="delimiter">'</span><span class="content">pal</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2650">
      <a href="#L2650">2650</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span> + filter + <span class="string"><span class="delimiter">'</span><span class="content">/Length </span><span class="delimiter">'</span></span> + pal.length.to_s + <span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2651">
      <a href="#L2651">2651</a>
    </th>
    <td class="line-code">
      <pre>                                putstream(pal);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2652">
      <a href="#L2652">2652</a>
    </th>
    <td class="line-code">
      <pre>                                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2653">
      <a href="#L2653">2653</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2654">
      <a href="#L2654">2654</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2655">
      <a href="#L2655">2655</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2656">
      <a href="#L2656">2656</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2657">
      <a href="#L2657">2657</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2658">
      <a href="#L2658">2658</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putxobjectdict</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2659">
      <a href="#L2659">2659</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2660">
      <a href="#L2660">2660</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2661">
      <a href="#L2661">2661</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putxobjectdict</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2662">
      <a href="#L2662">2662</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@images</span>.each_value <span class="keyword">do</span> |image|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2663">
      <a href="#L2663">2663</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/I</span><span class="delimiter">'</span></span> + image[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + image[<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2664">
      <a href="#L2664">2664</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2665">
      <a href="#L2665">2665</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2666">
      <a href="#L2666">2666</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2667">
      <a href="#L2667">2667</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2668">
      <a href="#L2668">2668</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putresourcedict</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2669">
      <a href="#L2669">2669</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2670">
      <a href="#L2670">2670</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2671">
      <a href="#L2671">2671</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putresourcedict</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2672">
      <a href="#L2672">2672</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2673">
      <a href="#L2673">2673</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Font &lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2674">
      <a href="#L2674">2674</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@fonts</span>.each_value <span class="keyword">do</span> |font|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2675">
      <a href="#L2675">2675</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/F</span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2676">
      <a href="#L2676">2676</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2677">
      <a href="#L2677">2677</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2678">
      <a href="#L2678">2678</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/XObject &lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2679">
      <a href="#L2679">2679</a>
    </th>
    <td class="line-code">
      <pre>                putxobjectdict();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2680">
      <a href="#L2680">2680</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2681">
      <a href="#L2681">2681</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2682">
      <a href="#L2682">2682</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2683">
      <a href="#L2683">2683</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2684">
      <a href="#L2684">2684</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putresources</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2685">
      <a href="#L2685">2685</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2686">
      <a href="#L2686">2686</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2687">
      <a href="#L2687">2687</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putresources</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2688">
      <a href="#L2688">2688</a>
    </th>
    <td class="line-code">
      <pre>                putfonts();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2689">
      <a href="#L2689">2689</a>
    </th>
    <td class="line-code">
      <pre>                putimages();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2690">
      <a href="#L2690">2690</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Resource dictionary</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2691">
      <a href="#L2691">2691</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@offsets</span>[<span class="integer">2</span>]=<span class="instance-variable">@buffer</span>.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2692">
      <a href="#L2692">2692</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">2 0 obj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2693">
      <a href="#L2693">2693</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2694">
      <a href="#L2694">2694</a>
    </th>
    <td class="line-code">
      <pre>                putresourcedict();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2695">
      <a href="#L2695">2695</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2696">
      <a href="#L2696">2696</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2697">
      <a href="#L2697">2697</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2698">
      <a href="#L2698">2698</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2699">
      <a href="#L2699">2699</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2700">
      <a href="#L2700">2700</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putinfo</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2701">
      <a href="#L2701">2701</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2702">
      <a href="#L2702">2702</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2703">
      <a href="#L2703">2703</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putinfo</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2704">
      <a href="#L2704">2704</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Producer </span><span class="delimiter">'</span></span> + textstring(<span class="constant">PDF_PRODUCER</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2705">
      <a href="#L2705">2705</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@title</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2706">
      <a href="#L2706">2706</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Title </span><span class="delimiter">'</span></span> + textstring(<span class="instance-variable">@title</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2707">
      <a href="#L2707">2707</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2708">
      <a href="#L2708">2708</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@subject</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2709">
      <a href="#L2709">2709</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Subject </span><span class="delimiter">'</span></span> + textstring(<span class="instance-variable">@subject</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2710">
      <a href="#L2710">2710</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2711">
      <a href="#L2711">2711</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@author</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2712">
      <a href="#L2712">2712</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Author </span><span class="delimiter">'</span></span> + textstring(<span class="instance-variable">@author</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2713">
      <a href="#L2713">2713</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2714">
      <a href="#L2714">2714</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@keywords</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2715">
      <a href="#L2715">2715</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Keywords </span><span class="delimiter">'</span></span> + textstring(<span class="instance-variable">@keywords</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2716">
      <a href="#L2716">2716</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2717">
      <a href="#L2717">2717</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@creator</span>.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2718">
      <a href="#L2718">2718</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Creator </span><span class="delimiter">'</span></span> + textstring(<span class="instance-variable">@creator</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2719">
      <a href="#L2719">2719</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2720">
      <a href="#L2720">2720</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CreationDate </span><span class="delimiter">'</span></span> + textstring(<span class="string"><span class="delimiter">'</span><span class="content">D:</span><span class="delimiter">'</span></span> + <span class="constant">Time</span>.now.strftime(<span class="string"><span class="delimiter">'</span><span class="content">%Y%m%d%H%M%S</span><span class="delimiter">'</span></span>)));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2721">
      <a href="#L2721">2721</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2722">
      <a href="#L2722">2722</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2723">
      <a href="#L2723">2723</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2724">
      <a href="#L2724">2724</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putcatalog</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2725">
      <a href="#L2725">2725</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2726">
      <a href="#L2726">2726</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2727">
      <a href="#L2727">2727</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putcatalog</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2728">
      <a href="#L2728">2728</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Type /Catalog</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2729">
      <a href="#L2729">2729</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Pages 1 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2730">
      <a href="#L2730">2730</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@zoom_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">fullpage</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2731">
      <a href="#L2731">2731</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/OpenAction [3 0 R /Fit]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2732">
      <a href="#L2732">2732</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (<span class="instance-variable">@zoom_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">fullwidth</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2733">
      <a href="#L2733">2733</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/OpenAction [3 0 R /FitH null]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2734">
      <a href="#L2734">2734</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (<span class="instance-variable">@zoom_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">real</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2735">
      <a href="#L2735">2735</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/OpenAction [3 0 R /XYZ null null 1]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2736">
      <a href="#L2736">2736</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (!<span class="instance-variable">@zoom_mode</span>.is_a?(<span class="constant">String</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2737">
      <a href="#L2737">2737</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/OpenAction [3 0 R /XYZ null null </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@zoom_mode</span>/<span class="integer">100</span>) + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2738">
      <a href="#L2738">2738</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2739">
      <a href="#L2739">2739</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@layout_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">single</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2740">
      <a href="#L2740">2740</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/PageLayout /SinglePage</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2741">
      <a href="#L2741">2741</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (<span class="instance-variable">@layout_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">continuous</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2742">
      <a href="#L2742">2742</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/PageLayout /OneColumn</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2743">
      <a href="#L2743">2743</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (<span class="instance-variable">@layout_mode</span>==<span class="string"><span class="delimiter">'</span><span class="content">two</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2744">
      <a href="#L2744">2744</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/PageLayout /TwoColumnLeft</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2745">
      <a href="#L2745">2745</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2746">
      <a href="#L2746">2746</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2747">
      <a href="#L2747">2747</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2748">
      <a href="#L2748">2748</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2749">
      <a href="#L2749">2749</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># puttrailer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2750">
      <a href="#L2750">2750</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2751">
      <a href="#L2751">2751</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2752">
      <a href="#L2752">2752</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">puttrailer</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2753">
      <a href="#L2753">2753</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Size </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2754">
      <a href="#L2754">2754</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Root </span><span class="delimiter">'</span></span> + <span class="instance-variable">@n</span>.to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2755">
      <a href="#L2755">2755</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Info </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>-<span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2756">
      <a href="#L2756">2756</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2757">
      <a href="#L2757">2757</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2758">
      <a href="#L2758">2758</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2759">
      <a href="#L2759">2759</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># putheader</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2760">
      <a href="#L2760">2760</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2761">
      <a href="#L2761">2761</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2762">
      <a href="#L2762">2762</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putheader</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2763">
      <a href="#L2763">2763</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">%PDF-</span><span class="delimiter">'</span></span> + <span class="instance-variable">@pdf_version</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2764">
      <a href="#L2764">2764</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2765">
      <a href="#L2765">2765</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2766">
      <a href="#L2766">2766</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2767">
      <a href="#L2767">2767</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># enddoc</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2768">
      <a href="#L2768">2768</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2769">
      <a href="#L2769">2769</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2770">
      <a href="#L2770">2770</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">enddoc</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2771">
      <a href="#L2771">2771</a>
    </th>
    <td class="line-code">
      <pre>                putheader();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2772">
      <a href="#L2772">2772</a>
    </th>
    <td class="line-code">
      <pre>                putpages();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2773">
      <a href="#L2773">2773</a>
    </th>
    <td class="line-code">
      <pre>                putresources();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2774">
      <a href="#L2774">2774</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Info</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2775">
      <a href="#L2775">2775</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2776">
      <a href="#L2776">2776</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2777">
      <a href="#L2777">2777</a>
    </th>
    <td class="line-code">
      <pre>                putinfo();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2778">
      <a href="#L2778">2778</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2779">
      <a href="#L2779">2779</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2780">
      <a href="#L2780">2780</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Catalog</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2781">
      <a href="#L2781">2781</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2782">
      <a href="#L2782">2782</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2783">
      <a href="#L2783">2783</a>
    </th>
    <td class="line-code">
      <pre>                putcatalog();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2784">
      <a href="#L2784">2784</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2785">
      <a href="#L2785">2785</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2786">
      <a href="#L2786">2786</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Cross-ref</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2787">
      <a href="#L2787">2787</a>
    </th>
    <td class="line-code">
      <pre>                o=<span class="instance-variable">@buffer</span>.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2788">
      <a href="#L2788">2788</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">xref</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2789">
      <a href="#L2789">2789</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">0 </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span>+<span class="integer">1</span>).to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2790">
      <a href="#L2790">2790</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">0000000000 65535 f </span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2791">
      <a href="#L2791">2791</a>
    </th>
    <td class="line-code">
      <pre>                <span class="integer">1</span>.upto(<span class="instance-variable">@n</span>) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2792">
      <a href="#L2792">2792</a>
    </th>
    <td class="line-code">
      <pre>                        out(sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%010d 00000 n </span><span class="delimiter">'</span></span>,<span class="instance-variable">@offsets</span>[i]));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2793">
      <a href="#L2793">2793</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2794">
      <a href="#L2794">2794</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Trailer</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2795">
      <a href="#L2795">2795</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">trailer</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2796">
      <a href="#L2796">2796</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2797">
      <a href="#L2797">2797</a>
    </th>
    <td class="line-code">
      <pre>                puttrailer();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2798">
      <a href="#L2798">2798</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2799">
      <a href="#L2799">2799</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">startxref</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2800">
      <a href="#L2800">2800</a>
    </th>
    <td class="line-code">
      <pre>                out(o);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2801">
      <a href="#L2801">2801</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">%%EOF</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2802">
      <a href="#L2802">2802</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span>=<span class="integer">3</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2803">
      <a href="#L2803">2803</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2804">
      <a href="#L2804">2804</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2805">
      <a href="#L2805">2805</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2806">
      <a href="#L2806">2806</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># beginpage</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2807">
      <a href="#L2807">2807</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2808">
      <a href="#L2808">2808</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2809">
      <a href="#L2809">2809</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">beginpage</span>(orientation)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2810">
      <a href="#L2810">2810</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2811">
      <a href="#L2811">2811</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@pages</span>[<span class="instance-variable">@page</span>]=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2812">
      <a href="#L2812">2812</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span>=<span class="integer">2</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2813">
      <a href="#L2813">2813</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@x</span>=<span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2814">
      <a href="#L2814">2814</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@y</span>=<span class="instance-variable">@t_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2815">
      <a href="#L2815">2815</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@font_family</span>=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2816">
      <a href="#L2816">2816</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Page orientation</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2817">
      <a href="#L2817">2817</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (orientation.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2818">
      <a href="#L2818">2818</a>
    </th>
    <td class="line-code">
      <pre>                        orientation=<span class="instance-variable">@def_orientation</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2819">
      <a href="#L2819">2819</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2820">
      <a href="#L2820">2820</a>
    </th>
    <td class="line-code">
      <pre>                        orientation.upcase!
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2821">
      <a href="#L2821">2821</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (orientation!=<span class="instance-variable">@def_orientation</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2822">
      <a href="#L2822">2822</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@orientation_changes</span>[<span class="instance-variable">@page</span>]=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2823">
      <a href="#L2823">2823</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2824">
      <a href="#L2824">2824</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2825">
      <a href="#L2825">2825</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (orientation!=<span class="instance-variable">@cur_orientation</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2826">
      <a href="#L2826">2826</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Change orientation</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2827">
      <a href="#L2827">2827</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (orientation==<span class="string"><span class="delimiter">'</span><span class="content">P</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2828">
      <a href="#L2828">2828</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@w_pt</span>=<span class="instance-variable">@fw_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2829">
      <a href="#L2829">2829</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@h_pt</span>=<span class="instance-variable">@fh_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2830">
      <a href="#L2830">2830</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@w</span>=<span class="instance-variable">@fw</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2831">
      <a href="#L2831">2831</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@h</span>=<span class="instance-variable">@fh</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2832">
      <a href="#L2832">2832</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2833">
      <a href="#L2833">2833</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@w_pt</span>=<span class="instance-variable">@fh_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2834">
      <a href="#L2834">2834</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@h_pt</span>=<span class="instance-variable">@fw_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2835">
      <a href="#L2835">2835</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@w</span>=<span class="instance-variable">@fh</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2836">
      <a href="#L2836">2836</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@h</span>=<span class="instance-variable">@fw</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2837">
      <a href="#L2837">2837</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2838">
      <a href="#L2838">2838</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@page_break_trigger</span>=<span class="instance-variable">@h</span>-<span class="instance-variable">@b_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2839">
      <a href="#L2839">2839</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@cur_orientation</span> = orientation;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2840">
      <a href="#L2840">2840</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2841">
      <a href="#L2841">2841</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2842">
      <a href="#L2842">2842</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2843">
      <a href="#L2843">2843</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2844">
      <a href="#L2844">2844</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># End of page contents</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2845">
      <a href="#L2845">2845</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2846">
      <a href="#L2846">2846</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2847">
      <a href="#L2847">2847</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">endpage</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2848">
      <a href="#L2848">2848</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@state</span>=<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2849">
      <a href="#L2849">2849</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2850">
      <a href="#L2850">2850</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2851">
      <a href="#L2851">2851</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2852">
      <a href="#L2852">2852</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Begin a new object</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2853">
      <a href="#L2853">2853</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2854">
      <a href="#L2854">2854</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2855">
      <a href="#L2855">2855</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">newobj</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2856">
      <a href="#L2856">2856</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@n</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2857">
      <a href="#L2857">2857</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@offsets</span>[<span class="instance-variable">@n</span>]=<span class="instance-variable">@buffer</span>.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2858">
      <a href="#L2858">2858</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="instance-variable">@n</span>.to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 obj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2859">
      <a href="#L2859">2859</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2860">
      <a href="#L2860">2860</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2861">
      <a href="#L2861">2861</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2862">
      <a href="#L2862">2862</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Underline and Deleted text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2863">
      <a href="#L2863">2863</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2864">
      <a href="#L2864">2864</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2865">
      <a href="#L2865">2865</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">dolinetxt</span>(x, y, txt)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2866">
      <a href="#L2866">2866</a>
    </th>
    <td class="line-code">
      <pre>                up = <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">up</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2867">
      <a href="#L2867">2867</a>
    </th>
    <td class="line-code">
      <pre>                ut = <span class="instance-variable">@current_font</span>[<span class="string"><span class="delimiter">'</span><span class="content">ut</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2868">
      <a href="#L2868">2868</a>
    </th>
    <td class="line-code">
      <pre>                w = GetStringWidth(txt) + <span class="instance-variable">@ws</span> * txt.count(<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2869">
      <a href="#L2869">2869</a>
    </th>
    <td class="line-code">
      <pre>                sprintf(<span class="string"><span class="delimiter">'</span><span class="content">%.2f %.2f %.2f %.2f re f</span><span class="delimiter">'</span></span>, x * <span class="instance-variable">@k</span>, (<span class="instance-variable">@h</span> - (y - up / <span class="float">1000.0</span> * <span class="instance-variable">@font_size</span>)) * <span class="instance-variable">@k</span>, w * <span class="instance-variable">@k</span>, -ut / <span class="float">1000.0</span> * <span class="instance-variable">@font_size_pt</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2870">
      <a href="#L2870">2870</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2871">
      <a href="#L2871">2871</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2872">
      <a href="#L2872">2872</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2873">
      <a href="#L2873">2873</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Extract info from a JPEG file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2874">
      <a href="#L2874">2874</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2875">
      <a href="#L2875">2875</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2876">
      <a href="#L2876">2876</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">parsejpg</span>(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2877">
      <a href="#L2877">2877</a>
    </th>
    <td class="line-code">
      <pre>                a=getimagesize(file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2878">
      <a href="#L2878">2878</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (a.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2879">
      <a href="#L2879">2879</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Missing or incorrect image file: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2880">
      <a href="#L2880">2880</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2881">
      <a href="#L2881">2881</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!a[<span class="integer">2</span>].nil? <span class="keyword">and</span> a[<span class="integer">2</span>]!=<span class="string"><span class="delimiter">'</span><span class="content">JPEG</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2882">
      <a href="#L2882">2882</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Not a JPEG file: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2883">
      <a href="#L2883">2883</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2884">
      <a href="#L2884">2884</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (a[<span class="string"><span class="delimiter">'</span><span class="content">channels</span><span class="delimiter">'</span></span>].nil? <span class="keyword">or</span> a[<span class="string"><span class="delimiter">'</span><span class="content">channels</span><span class="delimiter">'</span></span>]==<span class="integer">3</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2885">
      <a href="#L2885">2885</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">DeviceRGB</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2886">
      <a href="#L2886">2886</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (a[<span class="string"><span class="delimiter">'</span><span class="content">channels</span><span class="delimiter">'</span></span>]==<span class="integer">4</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2887">
      <a href="#L2887">2887</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">DeviceCMYK</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2888">
      <a href="#L2888">2888</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2889">
      <a href="#L2889">2889</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">DeviceGray</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2890">
      <a href="#L2890">2890</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2891">
      <a href="#L2891">2891</a>
    </th>
    <td class="line-code">
      <pre>                bpc=!a[<span class="string"><span class="delimiter">'</span><span class="content">bits</span><span class="delimiter">'</span></span>].nil? ? a[<span class="string"><span class="delimiter">'</span><span class="content">bits</span><span class="delimiter">'</span></span>] : <span class="integer">8</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2892">
      <a href="#L2892">2892</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Read whole file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2893">
      <a href="#L2893">2893</a>
    </th>
    <td class="line-code">
      <pre>                data=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2894">
      <a href="#L2894">2894</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2895">
      <a href="#L2895">2895</a>
    </th>
    <td class="line-code">
      <pre>                open( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file),<span class="string"><span class="delimiter">'</span><span class="content">rb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2896">
      <a href="#L2896">2896</a>
    </th>
    <td class="line-code">
      <pre>                        data&lt;&lt;f.read();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2897">
      <a href="#L2897">2897</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2898">
      <a href="#L2898">2898</a>
    </th>
    <td class="line-code">
      <pre>                <span class="constant">File</span>.delete( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2899">
      <a href="#L2899">2899</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2900">
      <a href="#L2900">2900</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> {<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span> =&gt; a[<span class="integer">0</span>],<span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span> =&gt; a[<span class="integer">1</span>],<span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span> =&gt; colspace,<span class="string"><span class="delimiter">'</span><span class="content">bpc</span><span class="delimiter">'</span></span> =&gt; bpc,<span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">DCTDecode</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span> =&gt; data}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2901">
      <a href="#L2901">2901</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2902">
      <a href="#L2902">2902</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2903">
      <a href="#L2903">2903</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2904">
      <a href="#L2904">2904</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Extract info from a PNG file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2905">
      <a href="#L2905">2905</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2906">
      <a href="#L2906">2906</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2907">
      <a href="#L2907">2907</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">parsepng</span>(file)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2908">
      <a href="#L2908">2908</a>
    </th>
    <td class="line-code">
      <pre>                f=open(file,<span class="string"><span class="delimiter">'</span><span class="content">rb</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2909">
      <a href="#L2909">2909</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Check signature</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2910">
      <a href="#L2910">2910</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (f.read(<span class="integer">8</span>)!=<span class="integer">137</span>.chr + <span class="string"><span class="delimiter">'</span><span class="content">PNG</span><span class="delimiter">'</span></span> + <span class="integer">13</span>.chr + <span class="integer">10</span>.chr + <span class="integer">26</span>.chr + <span class="integer">10</span>.chr)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2911">
      <a href="#L2911">2911</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Not a PNG file: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2912">
      <a href="#L2912">2912</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2913">
      <a href="#L2913">2913</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Read header chunk</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2914">
      <a href="#L2914">2914</a>
    </th>
    <td class="line-code">
      <pre>                f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2915">
      <a href="#L2915">2915</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (f.read(<span class="integer">4</span>)!=<span class="string"><span class="delimiter">'</span><span class="content">IHDR</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2916">
      <a href="#L2916">2916</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Incorrect PNG file: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2917">
      <a href="#L2917">2917</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2918">
      <a href="#L2918">2918</a>
    </th>
    <td class="line-code">
      <pre>                w=freadint(f);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2919">
      <a href="#L2919">2919</a>
    </th>
    <td class="line-code">
      <pre>                h=freadint(f);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2920">
      <a href="#L2920">2920</a>
    </th>
    <td class="line-code">
      <pre>                bpc=f.read(<span class="integer">1</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2921">
      <a href="#L2921">2921</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (bpc&gt;<span class="integer">8</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2922">
      <a href="#L2922">2922</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">16-bit depth not supported: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2923">
      <a href="#L2923">2923</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2924">
      <a href="#L2924">2924</a>
    </th>
    <td class="line-code">
      <pre>                ct=f.read(<span class="integer">1</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2925">
      <a href="#L2925">2925</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ct==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2926">
      <a href="#L2926">2926</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">DeviceGray</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2927">
      <a href="#L2927">2927</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ct==<span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2928">
      <a href="#L2928">2928</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">DeviceRGB</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2929">
      <a href="#L2929">2929</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ct==<span class="integer">3</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2930">
      <a href="#L2930">2930</a>
    </th>
    <td class="line-code">
      <pre>                        colspace=<span class="string"><span class="delimiter">'</span><span class="content">Indexed</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2931">
      <a href="#L2931">2931</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2932">
      <a href="#L2932">2932</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Alpha channel not supported: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2933">
      <a href="#L2933">2933</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2934">
      <a href="#L2934">2934</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (f.read(<span class="integer">1</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>] != <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2935">
      <a href="#L2935">2935</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Unknown compression method: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2936">
      <a href="#L2936">2936</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2937">
      <a href="#L2937">2937</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (f.read(<span class="integer">1</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>] != <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2938">
      <a href="#L2938">2938</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Unknown filter method: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2939">
      <a href="#L2939">2939</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2940">
      <a href="#L2940">2940</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (f.read(<span class="integer">1</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>] != <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2941">
      <a href="#L2941">2941</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Interlacing not supported: </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2942">
      <a href="#L2942">2942</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2943">
      <a href="#L2943">2943</a>
    </th>
    <td class="line-code">
      <pre>                f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2944">
      <a href="#L2944">2944</a>
    </th>
    <td class="line-code">
      <pre>                parms=<span class="string"><span class="delimiter">'</span><span class="content">/DecodeParms &lt;&lt;/Predictor 15 /Colors </span><span class="delimiter">'</span></span> + (ct==<span class="integer">2</span> ? <span class="integer">3</span> : <span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> /BitsPerComponent </span><span class="delimiter">'</span></span> + bpc.to_s + <span class="string"><span class="delimiter">'</span><span class="content"> /Columns </span><span class="delimiter">'</span></span> + w.to_s + <span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2945">
      <a href="#L2945">2945</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Scan chunks looking for palette, transparency and image data</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2946">
      <a href="#L2946">2946</a>
    </th>
    <td class="line-code">
      <pre>                pal=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2947">
      <a href="#L2947">2947</a>
    </th>
    <td class="line-code">
      <pre>                trns=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2948">
      <a href="#L2948">2948</a>
    </th>
    <td class="line-code">
      <pre>                data=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2949">
      <a href="#L2949">2949</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">begin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2950">
      <a href="#L2950">2950</a>
    </th>
    <td class="line-code">
      <pre>                        n=freadint(f);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2951">
      <a href="#L2951">2951</a>
    </th>
    <td class="line-code">
      <pre>                        type=f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2952">
      <a href="#L2952">2952</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">PLTE</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2953">
      <a href="#L2953">2953</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Read palette</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2954">
      <a href="#L2954">2954</a>
    </th>
    <td class="line-code">
      <pre>                                pal=f.read( n);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2955">
      <a href="#L2955">2955</a>
    </th>
    <td class="line-code">
      <pre>                                f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2956">
      <a href="#L2956">2956</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">tRNS</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2957">
      <a href="#L2957">2957</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Read transparency info</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2958">
      <a href="#L2958">2958</a>
    </th>
    <td class="line-code">
      <pre>                                t=f.read( n);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2959">
      <a href="#L2959">2959</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (ct==<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2960">
      <a href="#L2960">2960</a>
    </th>
    <td class="line-code">
      <pre>                                        trns = t[<span class="integer">1</span>].unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2961">
      <a href="#L2961">2961</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> (ct==<span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2962">
      <a href="#L2962">2962</a>
    </th>
    <td class="line-code">
      <pre>                                        trns = t[[<span class="integer">1</span>].unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>], t[<span class="integer">3</span>].unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>], t[<span class="integer">5</span>].unpack(<span class="string"><span class="delimiter">'</span><span class="content">C</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>]]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2963">
      <a href="#L2963">2963</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2964">
      <a href="#L2964">2964</a>
    </th>
    <td class="line-code">
      <pre>                                        pos=t.include?(<span class="integer">0</span>.chr);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2965">
      <a href="#L2965">2965</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (pos!=<span class="predefined-constant">false</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2966">
      <a href="#L2966">2966</a>
    </th>
    <td class="line-code">
      <pre>                                                trns = [pos]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2967">
      <a href="#L2967">2967</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2968">
      <a href="#L2968">2968</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2969">
      <a href="#L2969">2969</a>
    </th>
    <td class="line-code">
      <pre>                                f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2970">
      <a href="#L2970">2970</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">IDAT</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2971">
      <a href="#L2971">2971</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#Read image data block</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2972">
      <a href="#L2972">2972</a>
    </th>
    <td class="line-code">
      <pre>                                data&lt;&lt;f.read( n);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2973">
      <a href="#L2973">2973</a>
    </th>
    <td class="line-code">
      <pre>                                f.read(<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2974">
      <a href="#L2974">2974</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (type==<span class="string"><span class="delimiter">'</span><span class="content">IEND</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2975">
      <a href="#L2975">2975</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">break</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2976">
      <a href="#L2976">2976</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2977">
      <a href="#L2977">2977</a>
    </th>
    <td class="line-code">
      <pre>                                f.read( n+<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2978">
      <a href="#L2978">2978</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2979">
      <a href="#L2979">2979</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span> <span class="keyword">while</span>(n)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2980">
      <a href="#L2980">2980</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (colspace==<span class="string"><span class="delimiter">'</span><span class="content">Indexed</span><span class="delimiter">'</span></span> <span class="keyword">and</span> pal.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2981">
      <a href="#L2981">2981</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Missing palette in </span><span class="delimiter">'</span></span> + file);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2982">
      <a href="#L2982">2982</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2983">
      <a href="#L2983">2983</a>
    </th>
    <td class="line-code">
      <pre>                f.close
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2984">
      <a href="#L2984">2984</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> {<span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span> =&gt; w, <span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span> =&gt; h, <span class="string"><span class="delimiter">'</span><span class="content">cs</span><span class="delimiter">'</span></span> =&gt; colspace, <span class="string"><span class="delimiter">'</span><span class="content">bpc</span><span class="delimiter">'</span></span> =&gt; bpc, <span class="string"><span class="delimiter">'</span><span class="content">f</span><span class="delimiter">'</span></span>=&gt;<span class="string"><span class="delimiter">'</span><span class="content">FlateDecode</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">parms</span><span class="delimiter">'</span></span> =&gt; parms, <span class="string"><span class="delimiter">'</span><span class="content">pal</span><span class="delimiter">'</span></span> =&gt; pal, <span class="string"><span class="delimiter">'</span><span class="content">trns</span><span class="delimiter">'</span></span> =&gt; trns, <span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span> =&gt; data}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2985">
      <a href="#L2985">2985</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2986">
      <a href="#L2986">2986</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2987">
      <a href="#L2987">2987</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2988">
      <a href="#L2988">2988</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Read a 4-byte integer from file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2989">
      <a href="#L2989">2989</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2990">
      <a href="#L2990">2990</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2991">
      <a href="#L2991">2991</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">freadint</span>(f)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2992">
      <a href="#L2992">2992</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Read a 4-byte integer from file</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2993">
      <a href="#L2993">2993</a>
    </th>
    <td class="line-code">
      <pre>    a = f.read(<span class="integer">4</span>).unpack(<span class="string"><span class="delimiter">'</span><span class="content">N</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2994">
      <a href="#L2994">2994</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">return</span> a[<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2995">
      <a href="#L2995">2995</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2996">
      <a href="#L2996">2996</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2997">
      <a href="#L2997">2997</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2998">
      <a href="#L2998">2998</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Format a text string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L2999">
      <a href="#L2999">2999</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3000">
      <a href="#L3000">3000</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3001">
      <a href="#L3001">3001</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">textstring</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3002">
      <a href="#L3002">3002</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3003">
      <a href="#L3003">3003</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Convert string to UTF-16BE</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3004">
      <a href="#L3004">3004</a>
    </th>
    <td class="line-code">
      <pre>                        s = UTF8ToUTF16BE(s, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3005">
      <a href="#L3005">3005</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3006">
      <a href="#L3006">3006</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="string"><span class="delimiter">'</span><span class="content">(</span><span class="delimiter">'</span></span> +  escape(s) + <span class="string"><span class="delimiter">'</span><span class="content">)</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3007">
      <a href="#L3007">3007</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3008">
      <a href="#L3008">3008</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3009">
      <a href="#L3009">3009</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3010">
      <a href="#L3010">3010</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Format a text string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3011">
      <a href="#L3011">3011</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3012">
      <a href="#L3012">3012</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3013">
      <a href="#L3013">3013</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">escapetext</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3014">
      <a href="#L3014">3014</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3015">
      <a href="#L3015">3015</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#Convert string to UTF-16BE</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3016">
      <a href="#L3016">3016</a>
    </th>
    <td class="line-code">
      <pre>                        s = UTF8ToUTF16BE(s, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3017">
      <a href="#L3017">3017</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3018">
      <a href="#L3018">3018</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> escape(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3019">
      <a href="#L3019">3019</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3020">
      <a href="#L3020">3020</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3021">
      <a href="#L3021">3021</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3022">
      <a href="#L3022">3022</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Add \ before \, ( and )</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3023">
      <a href="#L3023">3023</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3024">
      <a href="#L3024">3024</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3025">
      <a href="#L3025">3025</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">escape</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3026">
      <a href="#L3026">3026</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># Add \ before \, ( and )</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3027">
      <a href="#L3027">3027</a>
    </th>
    <td class="line-code">
      <pre>    s.gsub(<span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="char">\\</span><span class="char">\\</span><span class="delimiter">'</span></span>).gsub(<span class="string"><span class="delimiter">'</span><span class="content">(</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="content">(</span><span class="delimiter">'</span></span>).gsub(<span class="string"><span class="delimiter">'</span><span class="content">)</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="content">)</span><span class="delimiter">'</span></span>).gsub(<span class="integer">13</span>.chr, <span class="string"><span class="delimiter">'</span><span class="content">\r</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3028">
      <a href="#L3028">3028</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3029">
      <a href="#L3029">3029</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3030">
      <a href="#L3030">3030</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3031">
      <a href="#L3031">3031</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3032">
      <a href="#L3032">3032</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3033">
      <a href="#L3033">3033</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3034">
      <a href="#L3034">3034</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">putstream</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3035">
      <a href="#L3035">3035</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">stream</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3036">
      <a href="#L3036">3036</a>
    </th>
    <td class="line-code">
      <pre>                out(s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3037">
      <a href="#L3037">3037</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endstream</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3038">
      <a href="#L3038">3038</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3039">
      <a href="#L3039">3039</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3040">
      <a href="#L3040">3040</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3041">
      <a href="#L3041">3041</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Add a line to the document</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3042">
      <a href="#L3042">3042</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3043">
      <a href="#L3043">3043</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3044">
      <a href="#L3044">3044</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">out</span>(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3045">
      <a href="#L3045">3045</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@state</span>==<span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3046">
      <a href="#L3046">3046</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@pages</span>[<span class="instance-variable">@page</span>] &lt;&lt; s.to_s + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3047">
      <a href="#L3047">3047</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3048">
      <a href="#L3048">3048</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@buffer</span> &lt;&lt; s.to_s + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3049">
      <a href="#L3049">3049</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3050">
      <a href="#L3050">3050</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3051">
      <a href="#L3051">3051</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3052">
      <a href="#L3052">3052</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3053">
      <a href="#L3053">3053</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Adds unicode fonts.&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3054">
      <a href="#L3054">3054</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Based on PDF Reference 1.3 (section 5)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3055">
      <a href="#L3055">3055</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3056">
      <a href="#L3056">3056</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3057">
      <a href="#L3057">3057</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.52.0.TC005 (2005-01-05)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3058">
      <a href="#L3058">3058</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3059">
      <a href="#L3059">3059</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">puttruetypeunicode</span>(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3060">
      <a href="#L3060">3060</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># Type0 Font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3061">
      <a href="#L3061">3061</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># A composite font composed of other fonts, organized hierarchically</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3062">
      <a href="#L3062">3062</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3063">
      <a href="#L3063">3063</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3064">
      <a href="#L3064">3064</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /Type0</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3065">
      <a href="#L3065">3065</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>] + <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3066">
      <a href="#L3066">3066</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Encoding /Identity-H</span><span class="delimiter">'</span></span>); <span class="comment">#The horizontal identity mapping for 2-byte CIDs; may be used with CIDFonts using any Registry, Ordering, and Supplement values.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3067">
      <a href="#L3067">3067</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/DescendantFonts [</span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span> + <span class="integer">1</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R]</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3068">
      <a href="#L3068">3068</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/ToUnicode </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span> + <span class="integer">2</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3069">
      <a href="#L3069">3069</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3070">
      <a href="#L3070">3070</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3071">
      <a href="#L3071">3071</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3072">
      <a href="#L3072">3072</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># CIDFontType2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3073">
      <a href="#L3073">3073</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># A CIDFont whose glyph descriptions are based on TrueType font technology</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3074">
      <a href="#L3074">3074</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3075">
      <a href="#L3075">3075</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /Font</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3076">
      <a href="#L3076">3076</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Subtype /CIDFontType2</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3077">
      <a href="#L3077">3077</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/BaseFont /</span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>] + <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3078">
      <a href="#L3078">3078</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CIDSystemInfo </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span> + <span class="integer">2</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>); 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3079">
      <a href="#L3079">3079</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/FontDescriptor </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span> + <span class="integer">3</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3080">
      <a href="#L3080">3080</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!font[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">MissingWidth</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3081">
      <a href="#L3081">3081</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/DW </span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">MissingWidth</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>); <span class="comment"># The default width for glyphs in the CIDFont MissingWidth</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3082">
      <a href="#L3082">3082</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3083">
      <a href="#L3083">3083</a>
    </th>
    <td class="line-code">
      <pre>                w = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3084">
      <a href="#L3084">3084</a>
    </th>
    <td class="line-code">
      <pre>                font[<span class="string"><span class="delimiter">'</span><span class="content">cw</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |cid, width|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3085">
      <a href="#L3085">3085</a>
    </th>
    <td class="line-code">
      <pre>                        w &lt;&lt; <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span> + cid.to_s + <span class="string"><span class="delimiter">'</span><span class="content"> [</span><span class="delimiter">'</span></span> + width.to_s + <span class="string"><span class="delimiter">'</span><span class="content">] </span><span class="delimiter">'</span></span>; <span class="comment"># define a specific width for each individual CID</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3086">
      <a href="#L3086">3086</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3087">
      <a href="#L3087">3087</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/W [</span><span class="delimiter">'</span></span> + w + <span class="string"><span class="delimiter">'</span><span class="content">]</span><span class="delimiter">'</span></span>); <span class="comment"># A description of the widths for the glyphs in the CIDFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3088">
      <a href="#L3088">3088</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CIDToGIDMap </span><span class="delimiter">'</span></span> + (<span class="instance-variable">@n</span> + <span class="integer">4</span>).to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3089">
      <a href="#L3089">3089</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3090">
      <a href="#L3090">3090</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3091">
      <a href="#L3091">3091</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3092">
      <a href="#L3092">3092</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># ToUnicode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3093">
      <a href="#L3093">3093</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># is a stream object that contains the definition of the CMap</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3094">
      <a href="#L3094">3094</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># (PDF Reference 1.3 chap. 5.9)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3095">
      <a href="#L3095">3095</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3096">
      <a href="#L3096">3096</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Length 383&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3097">
      <a href="#L3097">3097</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">stream</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3098">
      <a href="#L3098">3098</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CIDInit /ProcSet findresource begin</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3099">
      <a href="#L3099">3099</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">12 dict begin</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3100">
      <a href="#L3100">3100</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">begincmap</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3101">
      <a href="#L3101">3101</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CIDSystemInfo</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3102">
      <a href="#L3102">3102</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Registry (Adobe)</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3103">
      <a href="#L3103">3103</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Ordering (UCS)</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3104">
      <a href="#L3104">3104</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Supplement 0</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3105">
      <a href="#L3105">3105</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt; def</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3106">
      <a href="#L3106">3106</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CMapName /Adobe-Identity-UCS def</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3107">
      <a href="#L3107">3107</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/CMapType 2 def</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3108">
      <a href="#L3108">3108</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">1 begincodespacerange</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3109">
      <a href="#L3109">3109</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;0000&gt; &lt;FFFF&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3110">
      <a href="#L3110">3110</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endcodespacerange</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3111">
      <a href="#L3111">3111</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">1 beginbfrange</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3112">
      <a href="#L3112">3112</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;0000&gt; &lt;FFFF&gt; &lt;0000&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3113">
      <a href="#L3113">3113</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endbfrange</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3114">
      <a href="#L3114">3114</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endcmap</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3115">
      <a href="#L3115">3115</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">CMapName currentdict /CMap defineresource pop</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3116">
      <a href="#L3116">3116</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">end</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3117">
      <a href="#L3117">3117</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">end</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3118">
      <a href="#L3118">3118</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endstream</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3119">
      <a href="#L3119">3119</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3120">
      <a href="#L3120">3120</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3121">
      <a href="#L3121">3121</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># CIDSystemInfo dictionary</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3122">
      <a href="#L3122">3122</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># A dictionary containing entries that define the character collection of the CIDFont.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3123">
      <a href="#L3123">3123</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3124">
      <a href="#L3124">3124</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Registry (Adobe)</span><span class="delimiter">'</span></span>); <span class="comment"># A string identifying an issuer of character collections</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3125">
      <a href="#L3125">3125</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Ordering (UCS)</span><span class="delimiter">'</span></span>); <span class="comment"># A string that uniquely names a character collection issued by a specific registry</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3126">
      <a href="#L3126">3126</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/Supplement 0</span><span class="delimiter">'</span></span>); <span class="comment"># The supplement number of the character collection.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3127">
      <a href="#L3127">3127</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3128">
      <a href="#L3128">3128</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3129">
      <a href="#L3129">3129</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3130">
      <a href="#L3130">3130</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># Font descriptor</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3131">
      <a href="#L3131">3131</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># A font descriptor describing the CIDFont default metrics other than its glyph widths</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3132">
      <a href="#L3132">3132</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3133">
      <a href="#L3133">3133</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Type /FontDescriptor</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3134">
      <a href="#L3134">3134</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">/FontName /</span><span class="delimiter">'</span></span> + font[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3135">
      <a href="#L3135">3135</a>
    </th>
    <td class="line-code">
      <pre>                font[<span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |key, value|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3136">
      <a href="#L3136">3136</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> + key.to_s + <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span> + value.to_s);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3137">
      <a href="#L3137">3137</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3138">
      <a href="#L3138">3138</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (font[<span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3139">
      <a href="#L3139">3139</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># A stream containing a TrueType font program</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3140">
      <a href="#L3140">3140</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/FontFile2 </span><span class="delimiter">'</span></span> + <span class="instance-variable">@font_files</span>[font[<span class="string"><span class="delimiter">'</span><span class="content">file</span><span class="delimiter">'</span></span>]][<span class="string"><span class="delimiter">'</span><span class="content">n</span><span class="delimiter">'</span></span>].to_s + <span class="string"><span class="delimiter">'</span><span class="content"> 0 R</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3141">
      <a href="#L3141">3141</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3142">
      <a href="#L3142">3142</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3143">
      <a href="#L3143">3143</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3144">
      <a href="#L3144">3144</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3145">
      <a href="#L3145">3145</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># Embed CIDToGIDMap</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3146">
      <a href="#L3146">3146</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># A specification of the mapping from CIDs to glyph indices</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3147">
      <a href="#L3147">3147</a>
    </th>
    <td class="line-code">
      <pre>                newobj();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3148">
      <a href="#L3148">3148</a>
    </th>
    <td class="line-code">
      <pre>                ctgfile = getfontpath(font[<span class="string"><span class="delimiter">'</span><span class="content">ctg</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3149">
      <a href="#L3149">3149</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!ctgfile)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3150">
      <a href="#L3150">3150</a>
    </th>
    <td class="line-code">
      <pre>                        Error(<span class="string"><span class="delimiter">'</span><span class="content">Font file not found: </span><span class="delimiter">'</span></span> + ctgfile);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3151">
      <a href="#L3151">3151</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3152">
      <a href="#L3152">3152</a>
    </th>
    <td class="line-code">
      <pre>                size = <span class="constant">File</span>.size(ctgfile);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3153">
      <a href="#L3153">3153</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&lt;&lt;/Length </span><span class="delimiter">'</span></span> + size.to_s + <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3154">
      <a href="#L3154">3154</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ctgfile[<span class="integer">-2</span>,<span class="integer">2</span>] == <span class="string"><span class="delimiter">'</span><span class="content">.z</span><span class="delimiter">'</span></span>) <span class="comment"># check file extension</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3155">
      <a href="#L3155">3155</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># Decompresses data encoded using the public-domain </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3156">
      <a href="#L3156">3156</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># zlib/deflate compression method, reproducing the </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3157">
      <a href="#L3157">3157</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># original text or binary data#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3158">
      <a href="#L3158">3158</a>
    </th>
    <td class="line-code">
      <pre>                        out(<span class="string"><span class="delimiter">'</span><span class="content">/Filter /FlateDecode</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3159">
      <a href="#L3159">3159</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3160">
      <a href="#L3160">3160</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">&gt;&gt;</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3161">
      <a href="#L3161">3161</a>
    </th>
    <td class="line-code">
      <pre>    open(ctgfile, <span class="string"><span class="delimiter">&quot;</span><span class="content">rb</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |f|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3162">
      <a href="#L3162">3162</a>
    </th>
    <td class="line-code">
      <pre>      putstream(f.read())
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3163">
      <a href="#L3163">3163</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3164">
      <a href="#L3164">3164</a>
    </th>
    <td class="line-code">
      <pre>                out(<span class="string"><span class="delimiter">'</span><span class="content">endobj</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3165">
      <a href="#L3165">3165</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3166">
      <a href="#L3166">3166</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3167">
      <a href="#L3167">3167</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3168">
      <a href="#L3168">3168</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Converts UTF-8 strings to codepoints array.&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3169">
      <a href="#L3169">3169</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Invalid byte sequences will be replaced with 0xFFFD (replacement character)&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3170">
      <a href="#L3170">3170</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Based on: http://www.faqs.org/rfcs/rfc3629.html</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3171">
      <a href="#L3171">3171</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3172">
      <a href="#L3172">3172</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#           Char. number range  |        UTF-8 octet sequence</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3173">
      <a href="#L3173">3173</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       (hexadecimal)    |              (binary)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3174">
      <a href="#L3174">3174</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    --------------------+-----------------------------------------------</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3175">
      <a href="#L3175">3175</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    0000 0000-0000 007F | 0xxxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3176">
      <a href="#L3176">3176</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    0000 0080-0000 07FF | 110xxxxx 10xxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3177">
      <a href="#L3177">3177</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3178">
      <a href="#L3178">3178</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3179">
      <a href="#L3179">3179</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    ---------------------------------------------------------------------</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3180">
      <a href="#L3180">3180</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3181">
      <a href="#L3181">3181</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   ABFN notation:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3182">
      <a href="#L3182">3182</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   ---------------------------------------------------------------------</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3183">
      <a href="#L3183">3183</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-octets =#( UTF8-char )</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3184">
      <a href="#L3184">3184</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-char   = UTF8-1 / UTF8-2 / UTF8-3 / UTF8-4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3185">
      <a href="#L3185">3185</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-1      = %x00-7F</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3186">
      <a href="#L3186">3186</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-2      = %xC2-DF UTF8-tail</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3187">
      <a href="#L3187">3187</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3188">
      <a href="#L3188">3188</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-3      = %xE0 %xA0-BF UTF8-tail / %xE1-EC 2( UTF8-tail ) /</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3189">
      <a href="#L3189">3189</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 %xED %x80-9F UTF8-tail / %xEE-EF 2( UTF8-tail )</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3190">
      <a href="#L3190">3190</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-4      = %xF0 %x90-BF 2( UTF8-tail ) / %xF1-F3 3( UTF8-tail ) /</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3191">
      <a href="#L3191">3191</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#                 %xF4 %x80-8F 2( UTF8-tail )</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3192">
      <a href="#L3192">3192</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   UTF8-tail   = %x80-BF</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3193">
      <a href="#L3193">3193</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   ---------------------------------------------------------------------</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3194">
      <a href="#L3194">3194</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3195">
      <a href="#L3195">3195</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :str string to process.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3196">
      <a href="#L3196">3196</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return array containing codepoints (UTF-8 characters values)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3197">
      <a href="#L3197">3197</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3198">
      <a href="#L3198">3198</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3199">
      <a href="#L3199">3199</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.53.0.TC005 (2005-01-05)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3200">
      <a href="#L3200">3200</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3201">
      <a href="#L3201">3201</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">UTF8StringToArray</span>(str)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3202">
      <a href="#L3202">3202</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3203">
      <a href="#L3203">3203</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span> str; <span class="comment"># string is not in unicode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3204">
      <a href="#L3204">3204</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3205">
      <a href="#L3205">3205</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3206">
      <a href="#L3206">3206</a>
    </th>
    <td class="line-code">
      <pre>                unicode = [] <span class="comment"># array containing unicode values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3207">
      <a href="#L3207">3207</a>
    </th>
    <td class="line-code">
      <pre>                bytes  = [] <span class="comment"># array containing single character byte sequences</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3208">
      <a href="#L3208">3208</a>
    </th>
    <td class="line-code">
      <pre>                numbytes  = <span class="integer">1</span>; <span class="comment"># number of octetc needed to represent the UTF-8 character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3209">
      <a href="#L3209">3209</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3210">
      <a href="#L3210">3210</a>
    </th>
    <td class="line-code">
      <pre>                str = str.to_s; <span class="comment"># force :str to be a string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3211">
      <a href="#L3211">3211</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3212">
      <a href="#L3212">3212</a>
    </th>
    <td class="line-code">
      <pre>                str.each_byte <span class="keyword">do</span> |char|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3213">
      <a href="#L3213">3213</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (bytes.length == <span class="integer">0</span>) <span class="comment"># get starting octect</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3214">
      <a href="#L3214">3214</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (char &lt;= <span class="integer">0x7F</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3215">
      <a href="#L3215">3215</a>
    </th>
    <td class="line-code">
      <pre>                                        unicode &lt;&lt; char <span class="comment"># use the character &quot;as is&quot; because is ASCII</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3216">
      <a href="#L3216">3216</a>
    </th>
    <td class="line-code">
      <pre>                                        numbytes = <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3217">
      <a href="#L3217">3217</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> ((char &gt;&gt; <span class="integer">0x05</span>) == <span class="integer">0x06</span>) <span class="comment"># 2 bytes character (0x06 = 110 BIN)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3218">
      <a href="#L3218">3218</a>
    </th>
    <td class="line-code">
      <pre>                                        bytes &lt;&lt; ((char - <span class="integer">0xC0</span>) &lt;&lt; <span class="integer">0x06</span>) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3219">
      <a href="#L3219">3219</a>
    </th>
    <td class="line-code">
      <pre>                                        numbytes = <span class="integer">2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3220">
      <a href="#L3220">3220</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> ((char &gt;&gt; <span class="integer">0x04</span>) == <span class="integer">0x0E</span>) <span class="comment"># 3 bytes character (0x0E = 1110 BIN)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3221">
      <a href="#L3221">3221</a>
    </th>
    <td class="line-code">
      <pre>                                        bytes &lt;&lt; ((char - <span class="integer">0xE0</span>) &lt;&lt; <span class="integer">0x0C</span>) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3222">
      <a href="#L3222">3222</a>
    </th>
    <td class="line-code">
      <pre>                                        numbytes = <span class="integer">3</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3223">
      <a href="#L3223">3223</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> ((char &gt;&gt; <span class="integer">0x03</span>) == <span class="integer">0x1E</span>) <span class="comment"># 4 bytes character (0x1E = 11110 BIN)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3224">
      <a href="#L3224">3224</a>
    </th>
    <td class="line-code">
      <pre>                                        bytes &lt;&lt; ((char - <span class="integer">0xF0</span>) &lt;&lt; <span class="integer">0x12</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3225">
      <a href="#L3225">3225</a>
    </th>
    <td class="line-code">
      <pre>                                        numbytes = <span class="integer">4</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3226">
      <a href="#L3226">3226</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3227">
      <a href="#L3227">3227</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># use replacement character for other invalid sequences</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3228">
      <a href="#L3228">3228</a>
    </th>
    <td class="line-code">
      <pre>                                        unicode &lt;&lt; <span class="integer">0xFFFD</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3229">
      <a href="#L3229">3229</a>
    </th>
    <td class="line-code">
      <pre>                                        bytes = []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3230">
      <a href="#L3230">3230</a>
    </th>
    <td class="line-code">
      <pre>                                        numbytes = <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3231">
      <a href="#L3231">3231</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3232">
      <a href="#L3232">3232</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> ((char &gt;&gt; <span class="integer">0x06</span>) == <span class="integer">0x02</span>) <span class="comment"># bytes 2, 3 and 4 must start with 0x02 = 10 BIN</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3233">
      <a href="#L3233">3233</a>
    </th>
    <td class="line-code">
      <pre>                                bytes &lt;&lt; (char - <span class="integer">0x80</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3234">
      <a href="#L3234">3234</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (bytes.length == numbytes)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3235">
      <a href="#L3235">3235</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># compose UTF-8 bytes to a single unicode value</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3236">
      <a href="#L3236">3236</a>
    </th>
    <td class="line-code">
      <pre>                                        char = bytes[<span class="integer">0</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3237">
      <a href="#L3237">3237</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="integer">1</span>.upto(numbytes-<span class="integer">1</span>) <span class="keyword">do</span> |j|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3238">
      <a href="#L3238">3238</a>
    </th>
    <td class="line-code">
      <pre>                                                char += (bytes[j] &lt;&lt; ((numbytes - j - <span class="integer">1</span>) * <span class="integer">0x06</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3239">
      <a href="#L3239">3239</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3240">
      <a href="#L3240">3240</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (((char &gt;= <span class="integer">0xD800</span>) <span class="keyword">and</span> (char &lt;= <span class="integer">0xDFFF</span>)) <span class="keyword">or</span> (char &gt;= <span class="integer">0x10FFFF</span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3241">
      <a href="#L3241">3241</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment"># The definition of UTF-8 prohibits encoding character numbers between</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3242">
      <a href="#L3242">3242</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment"># U+D800 and U+DFFF, which are reserved for use with the UTF-16</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3243">
      <a href="#L3243">3243</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment"># encoding form (as surrogate pairs) and do not directly represent</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3244">
      <a href="#L3244">3244</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment"># characters</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3245">
      <a href="#L3245">3245</a>
    </th>
    <td class="line-code">
      <pre>                                                unicode &lt;&lt; <span class="integer">0xFFFD</span>; <span class="comment"># use replacement character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3246">
      <a href="#L3246">3246</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3247">
      <a href="#L3247">3247</a>
    </th>
    <td class="line-code">
      <pre>                                          unicode &lt;&lt; char; <span class="comment"># add char to array</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3248">
      <a href="#L3248">3248</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3249">
      <a href="#L3249">3249</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="comment"># reset data for next char</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3250">
      <a href="#L3250">3250</a>
    </th>
    <td class="line-code">
      <pre>                                  bytes = []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3251">
      <a href="#L3251">3251</a>
    </th>
    <td class="line-code">
      <pre>                                  numbytes = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3252">
      <a href="#L3252">3252</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3253">
      <a href="#L3253">3253</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3254">
      <a href="#L3254">3254</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># use replacement character for other invalid sequences</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3255">
      <a href="#L3255">3255</a>
    </th>
    <td class="line-code">
      <pre>                                unicode &lt;&lt; <span class="integer">0xFFFD</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3256">
      <a href="#L3256">3256</a>
    </th>
    <td class="line-code">
      <pre>                                bytes = []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3257">
      <a href="#L3257">3257</a>
    </th>
    <td class="line-code">
      <pre>                                numbytes = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3258">
      <a href="#L3258">3258</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3259">
      <a href="#L3259">3259</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3260">
      <a href="#L3260">3260</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> unicode;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3261">
      <a href="#L3261">3261</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3262">
      <a href="#L3262">3262</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3263">
      <a href="#L3263">3263</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3264">
      <a href="#L3264">3264</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Converts UTF-8 strings to UTF16-BE.&lt;br&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3265">
      <a href="#L3265">3265</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Based on: http://www.faqs.org/rfcs/rfc2781.html</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3266">
      <a href="#L3266">3266</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># &lt;pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3267">
      <a href="#L3267">3267</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   Encoding UTF-16:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3268">
      <a href="#L3268">3268</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3269">
      <a href="#L3269">3269</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#   Encoding of a single character from an ISO 10646 character value to</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3270">
      <a href="#L3270">3270</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    UTF-16 proceeds as follows. Let U be the character number, no greater</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3271">
      <a href="#L3271">3271</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    than 0x10FFFF.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3272">
      <a href="#L3272">3272</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3273">
      <a href="#L3273">3273</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    1) If U &lt; 0x10000, encode U as a 16-bit unsigned integer and</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3274">
      <a href="#L3274">3274</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       terminate.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3275">
      <a href="#L3275">3275</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3276">
      <a href="#L3276">3276</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    2) Let U' = U - 0x10000. Because U is less than or equal to 0x10FFFF,</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3277">
      <a href="#L3277">3277</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       U' must be less than or equal to 0xFFFFF. That is, U' can be</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3278">
      <a href="#L3278">3278</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       represented in 20 bits.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3279">
      <a href="#L3279">3279</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3280">
      <a href="#L3280">3280</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    3) Initialize two 16-bit unsigned integers, W1 and W2, to 0xD800 and</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3281">
      <a href="#L3281">3281</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       0xDC00, respectively. These integers each have 10 bits free to</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3282">
      <a href="#L3282">3282</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       encode the character value, for a total of 20 bits.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3283">
      <a href="#L3283">3283</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3284">
      <a href="#L3284">3284</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    4) Assign the 10 high-order bits of the 20-bit U' to the 10 low-order</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3285">
      <a href="#L3285">3285</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       bits of W1 and the 10 low-order bits of U' to the 10 low-order</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3286">
      <a href="#L3286">3286</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#       bits of W2. Terminate.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3287">
      <a href="#L3287">3287</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3288">
      <a href="#L3288">3288</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    Graphically, steps 2 through 4 look like:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3289">
      <a href="#L3289">3289</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    U' = yyyyyyyyyyxxxxxxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3290">
      <a href="#L3290">3290</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    W1 = 110110yyyyyyyyyy</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3291">
      <a href="#L3291">3291</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    W2 = 110111xxxxxxxxxx</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3292">
      <a href="#L3292">3292</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># &lt;/pre&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3293">
      <a href="#L3293">3293</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :str string to process.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3294">
      <a href="#L3294">3294</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :setbom if true set the Byte Order Mark (BOM = 0xFEFF)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3295">
      <a href="#L3295">3295</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return string</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3296">
      <a href="#L3296">3296</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access protected</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3297">
      <a href="#L3297">3297</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @author Nicola Asuni</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3298">
      <a href="#L3298">3298</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.53.0.TC005 (2005-01-05)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3299">
      <a href="#L3299">3299</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @uses UTF8StringToArray</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3300">
      <a href="#L3300">3300</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3301">
      <a href="#L3301">3301</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">UTF8ToUTF16BE</span>(str, setbom=<span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3302">
      <a href="#L3302">3302</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (!<span class="instance-variable">@is_unicode</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3303">
      <a href="#L3303">3303</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span> str; <span class="comment"># string is not in unicode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3304">
      <a href="#L3304">3304</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3305">
      <a href="#L3305">3305</a>
    </th>
    <td class="line-code">
      <pre>                outstr = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>; <span class="comment"># string to be returned</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3306">
      <a href="#L3306">3306</a>
    </th>
    <td class="line-code">
      <pre>                unicode = UTF8StringToArray(str); <span class="comment"># array containing UTF-8 unicode values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3307">
      <a href="#L3307">3307</a>
    </th>
    <td class="line-code">
      <pre>                numitems = unicode.length;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3308">
      <a href="#L3308">3308</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3309">
      <a href="#L3309">3309</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (setbom)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3310">
      <a href="#L3310">3310</a>
    </th>
    <td class="line-code">
      <pre>                        outstr &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="char">\xFE</span><span class="char">\xFF</span><span class="delimiter">&quot;</span></span>; <span class="comment"># Byte Order Mark (BOM)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3311">
      <a href="#L3311">3311</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3312">
      <a href="#L3312">3312</a>
    </th>
    <td class="line-code">
      <pre>                unicode.each <span class="keyword">do</span> |char|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3313">
      <a href="#L3313">3313</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (char == <span class="integer">0xFFFD</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3314">
      <a href="#L3314">3314</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="char">\xFF</span><span class="char">\xFD</span><span class="delimiter">&quot;</span></span>; <span class="comment"># replacement character</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3315">
      <a href="#L3315">3315</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> (char &lt; <span class="integer">0x10000</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3316">
      <a href="#L3316">3316</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (char &gt;&gt; <span class="integer">0x08</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3317">
      <a href="#L3317">3317</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (char &amp; <span class="integer">0xFF</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3318">
      <a href="#L3318">3318</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3319">
      <a href="#L3319">3319</a>
    </th>
    <td class="line-code">
      <pre>                                char -= <span class="integer">0x10000</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3320">
      <a href="#L3320">3320</a>
    </th>
    <td class="line-code">
      <pre>                                w1 = <span class="integer">0xD800</span> | (char &gt;&gt; <span class="integer">0x10</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3321">
      <a href="#L3321">3321</a>
    </th>
    <td class="line-code">
      <pre>                                w2 = <span class="integer">0xDC00</span> | (char &amp; <span class="integer">0x3FF</span>);        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3322">
      <a href="#L3322">3322</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (w1 &gt;&gt; <span class="integer">0x08</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3323">
      <a href="#L3323">3323</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (w1 &amp; <span class="integer">0xFF</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3324">
      <a href="#L3324">3324</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (w2 &gt;&gt; <span class="integer">0x08</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3325">
      <a href="#L3325">3325</a>
    </th>
    <td class="line-code">
      <pre>                                outstr &lt;&lt; (w2 &amp; <span class="integer">0xFF</span>).chr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3326">
      <a href="#L3326">3326</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3327">
      <a href="#L3327">3327</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3328">
      <a href="#L3328">3328</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> outstr;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3329">
      <a href="#L3329">3329</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3330">
      <a href="#L3330">3330</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3331">
      <a href="#L3331">3331</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># ====================================================</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3332">
      <a href="#L3332">3332</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3333">
      <a href="#L3333">3333</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3334">
      <a href="#L3334">3334</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set header font.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3335">
      <a href="#L3335">3335</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param array :font font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3336">
      <a href="#L3336">3336</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3337">
      <a href="#L3337">3337</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3338">
      <a href="#L3338">3338</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetHeaderFont</span>(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3339">
      <a href="#L3339">3339</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@header_font</span> = font;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3340">
      <a href="#L3340">3340</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3341">
      <a href="#L3341">3341</a>
    </th>
    <td class="line-code">
      <pre>        alias_method <span class="symbol">:set_header_font</span>, <span class="symbol">:SetHeaderFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3342">
      <a href="#L3342">3342</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3343">
      <a href="#L3343">3343</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3344">
      <a href="#L3344">3344</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set footer font.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3345">
      <a href="#L3345">3345</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param array :font font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3346">
      <a href="#L3346">3346</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3347">
      <a href="#L3347">3347</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3348">
      <a href="#L3348">3348</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetFooterFont</span>(font)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3349">
      <a href="#L3349">3349</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@footer_font</span> = font;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3350">
      <a href="#L3350">3350</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3351">
      <a href="#L3351">3351</a>
    </th>
    <td class="line-code">
      <pre>        alias_method <span class="symbol">:set_footer_font</span>, <span class="symbol">:SetFooterFont</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3352">
      <a href="#L3352">3352</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3353">
      <a href="#L3353">3353</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3354">
      <a href="#L3354">3354</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set language array.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3355">
      <a href="#L3355">3355</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param array :language</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3356">
      <a href="#L3356">3356</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @since 1.1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3357">
      <a href="#L3357">3357</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3358">
      <a href="#L3358">3358</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetLanguageArray</span>(language)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3359">
      <a href="#L3359">3359</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@l</span> = language;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3360">
      <a href="#L3360">3360</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3361">
      <a href="#L3361">3361</a>
    </th>
    <td class="line-code">
      <pre>        alias_method <span class="symbol">:set_language_array</span>, <span class="symbol">:SetLanguageArray</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3362">
      <a href="#L3362">3362</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3363">
      <a href="#L3363">3363</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Set document barcode.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3364">
      <a href="#L3364">3364</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :bc barcode</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3365">
      <a href="#L3365">3365</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3366">
      <a href="#L3366">3366</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetBarcode</span>(bc=<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3367">
      <a href="#L3367">3367</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@barcode</span> = bc;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3368">
      <a href="#L3368">3368</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3369">
      <a href="#L3369">3369</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3370">
      <a href="#L3370">3370</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3371">
      <a href="#L3371">3371</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Print Barcode.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3372">
      <a href="#L3372">3372</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :x x position in user units</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3373">
      <a href="#L3373">3373</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :y y position in user units</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3374">
      <a href="#L3374">3374</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :w width in user units</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3375">
      <a href="#L3375">3375</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :h height position in user units</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3376">
      <a href="#L3376">3376</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :type type of barcode (I25, C128A, C128B, C128C, C39)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3377">
      <a href="#L3377">3377</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :style barcode style</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3378">
      <a href="#L3378">3378</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :font font for text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3379">
      <a href="#L3379">3379</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :xres x resolution</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3380">
      <a href="#L3380">3380</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :code code to print</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3381">
      <a href="#L3381">3381</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3382">
      <a href="#L3382">3382</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">writeBarcode</span>(x, y, w, h, type, style, font, xres, code)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3383">
      <a href="#L3383">3383</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/barcode.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3384">
      <a href="#L3384">3384</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/i25object.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3385">
      <a href="#L3385">3385</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/c39object.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3386">
      <a href="#L3386">3386</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/c128aobject.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3387">
      <a href="#L3387">3387</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/c128bobject.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3388">
      <a href="#L3388">3388</a>
    </th>
    <td class="line-code">
      <pre>                require(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">/barcode/c128cobject.rb</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3389">
      <a href="#L3389">3389</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3390">
      <a href="#L3390">3390</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (code.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3391">
      <a href="#L3391">3391</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">return</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3392">
      <a href="#L3392">3392</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3393">
      <a href="#L3393">3393</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3394">
      <a href="#L3394">3394</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (style.empty?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3395">
      <a href="#L3395">3395</a>
    </th>
    <td class="line-code">
      <pre>                        style  = <span class="constant">BCS_ALIGN_LEFT</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3396">
      <a href="#L3396">3396</a>
    </th>
    <td class="line-code">
      <pre>                        style |= <span class="constant">BCS_IMAGE_PNG</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3397">
      <a href="#L3397">3397</a>
    </th>
    <td class="line-code">
      <pre>                        style |= <span class="constant">BCS_TRANSPARENT</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3398">
      <a href="#L3398">3398</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#:style |= BCS_BORDER;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3399">
      <a href="#L3399">3399</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#:style |= BCS_DRAW_TEXT;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3400">
      <a href="#L3400">3400</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#:style |= BCS_STRETCH_TEXT;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3401">
      <a href="#L3401">3401</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#:style |= BCS_REVERSE_COLOR;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3402">
      <a href="#L3402">3402</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3403">
      <a href="#L3403">3403</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (font.empty?) <span class="keyword">then</span> font = <span class="constant">BCD_DEFAULT_FONT</span>; <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3404">
      <a href="#L3404">3404</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (xres.empty?) <span class="keyword">then</span> xres = <span class="constant">BCD_DEFAULT_XRES</span>; <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3405">
      <a href="#L3405">3405</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3406">
      <a href="#L3406">3406</a>
    </th>
    <td class="line-code">
      <pre>                scale_factor = <span class="float">1.5</span> * xres * <span class="instance-variable">@k</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3407">
      <a href="#L3407">3407</a>
    </th>
    <td class="line-code">
      <pre>                bc_w = (w * scale_factor).round <span class="comment">#width in points</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3408">
      <a href="#L3408">3408</a>
    </th>
    <td class="line-code">
      <pre>                bc_h = (h * scale_factor).round <span class="comment">#height in points</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3409">
      <a href="#L3409">3409</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3410">
      <a href="#L3410">3410</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (type.upcase)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3411">
      <a href="#L3411">3411</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">I25</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3412">
      <a href="#L3412">3412</a>
    </th>
    <td class="line-code">
      <pre>                                obj = <span class="constant">I25Object</span>.new(bc_w, bc_h, style, code);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3413">
      <a href="#L3413">3413</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">C128A</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3414">
      <a href="#L3414">3414</a>
    </th>
    <td class="line-code">
      <pre>                                obj = <span class="constant">C128AObject</span>.new(bc_w, bc_h, style, code);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3415">
      <a href="#L3415">3415</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">C128B</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3416">
      <a href="#L3416">3416</a>
    </th>
    <td class="line-code">
      <pre>                                obj = <span class="constant">C128BObject</span>.new(bc_w, bc_h, style, code);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3417">
      <a href="#L3417">3417</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">C128C</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3418">
      <a href="#L3418">3418</a>
    </th>
    <td class="line-code">
      <pre>                                obj = <span class="constant">C128CObject</span>.new(bc_w, bc_h, style, code);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3419">
      <a href="#L3419">3419</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">C39</span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3420">
      <a href="#L3420">3420</a>
    </th>
    <td class="line-code">
      <pre>                                obj = <span class="constant">C39Object</span>.new(bc_w, bc_h, style, code);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3421">
      <a href="#L3421">3421</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3422">
      <a href="#L3422">3422</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3423">
      <a href="#L3423">3423</a>
    </th>
    <td class="line-code">
      <pre>                obj.SetFont(font);   
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3424">
      <a href="#L3424">3424</a>
    </th>
    <td class="line-code">
      <pre>                obj.DrawObject(xres);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3425">
      <a href="#L3425">3425</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3426">
      <a href="#L3426">3426</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#use a temporary file....</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3427">
      <a href="#L3427">3427</a>
    </th>
    <td class="line-code">
      <pre>                tmpName = tempnam(<span class="class-variable">@@k_path_cache</span>,<span class="string"><span class="delimiter">'</span><span class="content">img</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3428">
      <a href="#L3428">3428</a>
    </th>
    <td class="line-code">
      <pre>                imagepng(obj.getImage(), tmpName);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3429">
      <a href="#L3429">3429</a>
    </th>
    <td class="line-code">
      <pre>                Image(tmpName, x, y, w, h, <span class="string"><span class="delimiter">'</span><span class="content">png</span><span class="delimiter">'</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3430">
      <a href="#L3430">3430</a>
    </th>
    <td class="line-code">
      <pre>                obj.DestroyObject();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3431">
      <a href="#L3431">3431</a>
    </th>
    <td class="line-code">
      <pre>                obj = <span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3432">
      <a href="#L3432">3432</a>
    </th>
    <td class="line-code">
      <pre>                unlink(tmpName);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3433">
      <a href="#L3433">3433</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3434">
      <a href="#L3434">3434</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3435">
      <a href="#L3435">3435</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3436">
      <a href="#L3436">3436</a>
    </th>
    <td class="line-code">
      <pre>         <span class="comment"># Returns the PDF data.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3437">
      <a href="#L3437">3437</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3438">
      <a href="#L3438">3438</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">GetPDFData</span>()
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3439">
      <a href="#L3439">3439</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@state</span> &lt; <span class="integer">3</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3440">
      <a href="#L3440">3440</a>
    </th>
    <td class="line-code">
      <pre>                        Close();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3441">
      <a href="#L3441">3441</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3442">
      <a href="#L3442">3442</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="instance-variable">@buffer</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3443">
      <a href="#L3443">3443</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3444">
      <a href="#L3444">3444</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3445">
      <a href="#L3445">3445</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># --- HTML PARSER FUNCTIONS ---</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3446">
      <a href="#L3446">3446</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3447">
      <a href="#L3447">3447</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3448">
      <a href="#L3448">3448</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Allows to preserve some HTML formatting.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3449">
      <a href="#L3449">3449</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Supports: h1, h2, h3, h4, h5, h6, b, u, i, a, img, p, br, strong, em, ins, del, font, blockquote, li, ul, ol, hr, td, th, tr, table, sup, sub, small</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3450">
      <a href="#L3450">3450</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :html text to display</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3451">
      <a href="#L3451">3451</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :ln if true add a new line after text (default = true)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3452">
      <a href="#L3452">3452</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3453">
      <a href="#L3453">3453</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3454">
      <a href="#L3454">3454</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">writeHTML</span>(html, ln=<span class="predefined-constant">true</span>, fill=<span class="integer">0</span>, h=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3455">
      <a href="#L3455">3455</a>
    </th>
    <td class="line-code">
      <pre>    
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3456">
      <a href="#L3456">3456</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@lasth</span> = h <span class="keyword">if</span> h &gt; <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3457">
      <a href="#L3457">3457</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@lasth</span> == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3458">
      <a href="#L3458">3458</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set row height</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3459">
      <a href="#L3459">3459</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>; 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3460">
      <a href="#L3460">3460</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3461">
      <a href="#L3461">3461</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3462">
      <a href="#L3462">3462</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@href</span> = <span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3463">
      <a href="#L3463">3463</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@style</span> = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3464">
      <a href="#L3464">3464</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@t_cells</span> =  [[]];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3465">
      <a href="#L3465">3465</a>
    </th>
    <td class="line-code">
      <pre>    <span class="instance-variable">@table_id</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3466">
      <a href="#L3466">3466</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3467">
      <a href="#L3467">3467</a>
    </th>
    <td class="line-code">
      <pre>    <span class="comment"># pre calculate</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3468">
      <a href="#L3468">3468</a>
    </th>
    <td class="line-code">
      <pre>    html.split(<span class="regexp"><span class="delimiter">/</span><span class="content">(&lt;[^&gt;]+&gt;)</span><span class="delimiter">/</span></span>).each <span class="keyword">do</span> |element|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3469">
      <a href="#L3469">3469</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">if</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;</span><span class="delimiter">&quot;</span></span> == element[<span class="integer">0</span>,<span class="integer">1</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3470">
      <a href="#L3470">3470</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#Tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3471">
      <a href="#L3471">3471</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">if</span> (element[<span class="integer">1</span>, <span class="integer">1</span>] == <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3472">
      <a href="#L3472">3472</a>
    </th>
    <td class="line-code">
      <pre>                                        closedHTMLTagCalc(element[<span class="integer">2</span>..<span class="integer">-2</span>].downcase);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3473">
      <a href="#L3473">3473</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3474">
      <a href="#L3474">3474</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#Extract attributes</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3475">
      <a href="#L3475">3475</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># get tag name</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3476">
      <a href="#L3476">3476</a>
    </th>
    <td class="line-code">
      <pre>                                        tag = element.scan(<span class="regexp"><span class="delimiter">/</span><span class="content">([a-zA-Z0-9]*)</span><span class="delimiter">/</span></span>).flatten.delete_if {|x| x.length == <span class="integer">0</span>}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3477">
      <a href="#L3477">3477</a>
    </th>
    <td class="line-code">
      <pre>                                        tag = tag[<span class="integer">0</span>].downcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3478">
      <a href="#L3478">3478</a>
    </th>
    <td class="line-code">
      <pre>                                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3479">
      <a href="#L3479">3479</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># get attributes</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3480">
      <a href="#L3480">3480</a>
    </th>
    <td class="line-code">
      <pre>                                        attr_array = element.scan(<span class="regexp"><span class="delimiter">/</span><span class="content">([^=</span><span class="char">\s</span><span class="content">]*)=[&quot;</span><span class="char">\'</span><span class="content">]?([^&quot;</span><span class="char">\'</span><span class="content">]*)[&quot;</span><span class="char">\'</span><span class="content">]?</span><span class="delimiter">/</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3481">
      <a href="#L3481">3481</a>
    </th>
    <td class="line-code">
      <pre>          attrs = {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3482">
      <a href="#L3482">3482</a>
    </th>
    <td class="line-code">
      <pre>          attr_array.each <span class="keyword">do</span> |name, value|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3483">
      <a href="#L3483">3483</a>
    </th>
    <td class="line-code">
      <pre>                              attrs[name.downcase] = value;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3484">
      <a href="#L3484">3484</a>
    </th>
    <td class="line-code">
      <pre>                      <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3485">
      <a href="#L3485">3485</a>
    </th>
    <td class="line-code">
      <pre>                                        openHTMLTagCalc(tag, attrs);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3486">
      <a href="#L3486">3486</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3487">
      <a href="#L3487">3487</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3488">
      <a href="#L3488">3488</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3489">
      <a href="#L3489">3489</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@table_id</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3490">
      <a href="#L3490">3490</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3491">
      <a href="#L3491">3491</a>
    </th>
    <td class="line-code">
      <pre>    html.split(<span class="regexp"><span class="delimiter">/</span><span class="content">(&lt;[A-Za-z!?</span><span class="char">\/</span><span class="content">][^&gt;]*?&gt;)</span><span class="delimiter">/</span></span>).each <span class="keyword">do</span> |element|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3492">
      <a href="#L3492">3492</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">if</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;</span><span class="delimiter">&quot;</span></span> == element[<span class="integer">0</span>,<span class="integer">1</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3493">
      <a href="#L3493">3493</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#Tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3494">
      <a href="#L3494">3494</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">if</span> (element[<span class="integer">1</span>, <span class="integer">1</span>] == <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3495">
      <a href="#L3495">3495</a>
    </th>
    <td class="line-code">
      <pre>                                        closedHTMLTagHandler(element[<span class="integer">2</span>..<span class="integer">-2</span>].downcase);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3496">
      <a href="#L3496">3496</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3497">
      <a href="#L3497">3497</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#Extract attributes</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3498">
      <a href="#L3498">3498</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># get tag name</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3499">
      <a href="#L3499">3499</a>
    </th>
    <td class="line-code">
      <pre>                                        tag = element.scan(<span class="regexp"><span class="delimiter">/</span><span class="content">([a-zA-Z0-9]*)</span><span class="delimiter">/</span></span>).flatten.delete_if {|x| x.length == <span class="integer">0</span>}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3500">
      <a href="#L3500">3500</a>
    </th>
    <td class="line-code">
      <pre>                                        tag = tag[<span class="integer">0</span>].downcase;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3501">
      <a href="#L3501">3501</a>
    </th>
    <td class="line-code">
      <pre>                                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3502">
      <a href="#L3502">3502</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># get attributes</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3503">
      <a href="#L3503">3503</a>
    </th>
    <td class="line-code">
      <pre>                                        attr_array = element.scan(<span class="regexp"><span class="delimiter">/</span><span class="content">([^=</span><span class="char">\s</span><span class="content">]*)=[&quot;</span><span class="char">\'</span><span class="content">]?([^&quot;</span><span class="char">\'</span><span class="content">]*)[&quot;</span><span class="char">\'</span><span class="content">]?</span><span class="delimiter">/</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3504">
      <a href="#L3504">3504</a>
    </th>
    <td class="line-code">
      <pre>          attrs = {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3505">
      <a href="#L3505">3505</a>
    </th>
    <td class="line-code">
      <pre>          attr_array.each <span class="keyword">do</span> |name, value|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3506">
      <a href="#L3506">3506</a>
    </th>
    <td class="line-code">
      <pre>                              attrs[name.downcase] = value;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3507">
      <a href="#L3507">3507</a>
    </th>
    <td class="line-code">
      <pre>                      <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3508">
      <a href="#L3508">3508</a>
    </th>
    <td class="line-code">
      <pre>                                        openHTMLTagHandler(tag, attrs, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3509">
      <a href="#L3509">3509</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3510">
      <a href="#L3510">3510</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3511">
      <a href="#L3511">3511</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3512">
      <a href="#L3512">3512</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#Text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3513">
      <a href="#L3513">3513</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@href</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3514">
      <a href="#L3514">3514</a>
    </th>
    <td class="line-code">
      <pre>                                        element.gsub!(<span class="regexp"><span class="delimiter">/</span><span class="content">[</span><span class="char">\t</span><span class="char">\r</span><span class="char">\n</span><span class="char">\f</span><span class="content">]</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3515">
      <a href="#L3515">3515</a>
    </th>
    <td class="line-code">
      <pre>                                        addHtmlLink(<span class="instance-variable">@href</span>, element, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3516">
      <a href="#L3516">3516</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> (<span class="instance-variable">@tdbegin</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3517">
      <a href="#L3517">3517</a>
    </th>
    <td class="line-code">
      <pre>                                        element.gsub!(<span class="regexp"><span class="delimiter">/</span><span class="content">[</span><span class="char">\t</span><span class="char">\r</span><span class="char">\n</span><span class="char">\f</span><span class="content">]</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3518">
      <a href="#L3518">3518</a>
    </th>
    <td class="line-code">
      <pre>                                        element.gsub!(<span class="regexp"><span class="delimiter">/</span><span class="content">&amp;nbsp;</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3519">
      <a href="#L3519">3519</a>
    </th>
    <td class="line-code">
      <pre>                                        base_page = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3520">
      <a href="#L3520">3520</a>
    </th>
    <td class="line-code">
      <pre>                                        base_x = <span class="instance-variable">@x</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3521">
      <a href="#L3521">3521</a>
    </th>
    <td class="line-code">
      <pre>                                        base_y = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3522">
      <a href="#L3522">3522</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3523">
      <a href="#L3523">3523</a>
    </th>
    <td class="line-code">
      <pre>                                        MultiCell(<span class="instance-variable">@tdwidth</span>, <span class="instance-variable">@tdheight</span>, unhtmlentities(element.strip), <span class="instance-variable">@tableborder</span>, <span class="instance-variable">@tdalign</span>, <span class="instance-variable">@tdfill</span>, <span class="integer">1</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3524">
      <a href="#L3524">3524</a>
    </th>
    <td class="line-code">
      <pre>                                        tr_end = <span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][<span class="instance-variable">@tr_id</span>][<span class="instance-variable">@td_id</span>][<span class="string"><span class="delimiter">'</span><span class="content">j1</span><span class="delimiter">'</span></span>] + <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3525">
      <a href="#L3525">3525</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> <span class="instance-variable">@max_td_page</span>[tr_end].nil?  <span class="keyword">or</span> (<span class="instance-variable">@max_td_page</span>[tr_end] &lt; <span class="instance-variable">@page</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3526">
      <a href="#L3526">3526</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@max_td_page</span>[tr_end] = <span class="instance-variable">@page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3527">
      <a href="#L3527">3527</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@max_td_y</span>[tr_end] = <span class="instance-variable">@y</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3528">
      <a href="#L3528">3528</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">elsif</span> (<span class="instance-variable">@max_td_page</span>[tr_end] == <span class="instance-variable">@page</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3529">
      <a href="#L3529">3529</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@max_td_y</span>[tr_end] = <span class="instance-variable">@y</span> <span class="keyword">if</span> <span class="instance-variable">@max_td_y</span>[tr_end].nil? <span class="keyword">or</span> (<span class="instance-variable">@max_td_y</span>[tr_end] &lt; <span class="instance-variable">@y</span>) 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3530">
      <a href="#L3530">3530</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3531">
      <a href="#L3531">3531</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3532">
      <a href="#L3532">3532</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@page</span> = base_page;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3533">
      <a href="#L3533">3533</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@x</span> = base_x + <span class="instance-variable">@tdwidth</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3534">
      <a href="#L3534">3534</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@y</span> = base_y;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3535">
      <a href="#L3535">3535</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> (<span class="instance-variable">@pre_state</span> == <span class="predefined-constant">true</span> <span class="keyword">and</span> element.length &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3536">
      <a href="#L3536">3536</a>
    </th>
    <td class="line-code">
      <pre>                                        Write(<span class="instance-variable">@lasth</span>, unhtmlentities(element), <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3537">
      <a href="#L3537">3537</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">elsif</span> (element.strip.length &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3538">
      <a href="#L3538">3538</a>
    </th>
    <td class="line-code">
      <pre>                                        element.gsub!(<span class="regexp"><span class="delimiter">/</span><span class="content">[</span><span class="char">\t</span><span class="char">\r</span><span class="char">\n</span><span class="char">\f</span><span class="content">]</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3539">
      <a href="#L3539">3539</a>
    </th>
    <td class="line-code">
      <pre>                                        element.gsub!(<span class="regexp"><span class="delimiter">/</span><span class="content">&amp;nbsp;</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3540">
      <a href="#L3540">3540</a>
    </th>
    <td class="line-code">
      <pre>                                        Write(<span class="instance-variable">@lasth</span>, unhtmlentities(element), <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3541">
      <a href="#L3541">3541</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3542">
      <a href="#L3542">3542</a>
    </th>
    <td class="line-code">
      <pre>      <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3543">
      <a href="#L3543">3543</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3544">
      <a href="#L3544">3544</a>
    </th>
    <td class="line-code">
      <pre>    
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3545">
      <a href="#L3545">3545</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ln)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3546">
      <a href="#L3546">3546</a>
    </th>
    <td class="line-code">
      <pre>                        Ln(<span class="instance-variable">@lasth</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3547">
      <a href="#L3547">3547</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3548">
      <a href="#L3548">3548</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3549">
      <a href="#L3549">3549</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:write_html</span>, <span class="symbol">:writeHTML</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3550">
      <a href="#L3550">3550</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3551">
      <a href="#L3551">3551</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3552">
      <a href="#L3552">3552</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Prints a cell (rectangular area) with optional borders, background color and html text string. The upper-left corner of the cell corresponds to the current position. After the call, the current position moves to the right or to the next line.&lt;br /&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3553">
      <a href="#L3553">3553</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># If automatic page breaking is enabled and the cell goes beyond the limit, a page break is done before outputting.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3554">
      <a href="#L3554">3554</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :w Cell width. If 0, the cell extends up to the right margin.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3555">
      <a href="#L3555">3555</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :h Cell minimum height. The cell extends automatically if needed.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3556">
      <a href="#L3556">3556</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :x upper-left corner X coordinate</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3557">
      <a href="#L3557">3557</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param float :y upper-left corner Y coordinate</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3558">
      <a href="#L3558">3558</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :html html text to print. Default value: empty string.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3559">
      <a href="#L3559">3559</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param mixed :border Indicates if borders must be drawn around the cell. The value can be either a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt;or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3560">
      <a href="#L3560">3560</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :ln Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3561">
      <a href="#L3561">3561</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3562">
      <a href="#L3562">3562</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the cell background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3563">
      <a href="#L3563">3563</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @see Cell()</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3564">
      <a href="#L3564">3564</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3565">
      <a href="#L3565">3565</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">writeHTMLCell</span>(w, h, x, y, html=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, border=<span class="integer">0</span>, ln=<span class="integer">1</span>, fill=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3566">
      <a href="#L3566">3566</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3567">
      <a href="#L3567">3567</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@lasth</span> == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3568">
      <a href="#L3568">3568</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment">#set row height</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3569">
      <a href="#L3569">3569</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>; 
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3570">
      <a href="#L3570">3570</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3571">
      <a href="#L3571">3571</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3572">
      <a href="#L3572">3572</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (x == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3573">
      <a href="#L3573">3573</a>
    </th>
    <td class="line-code">
      <pre>                        x = GetX();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3574">
      <a href="#L3574">3574</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3575">
      <a href="#L3575">3575</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (y == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3576">
      <a href="#L3576">3576</a>
    </th>
    <td class="line-code">
      <pre>                        y = GetY();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3577">
      <a href="#L3577">3577</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3578">
      <a href="#L3578">3578</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3579">
      <a href="#L3579">3579</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># get current page number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3580">
      <a href="#L3580">3580</a>
    </th>
    <td class="line-code">
      <pre>                pagenum = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3581">
      <a href="#L3581">3581</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3582">
      <a href="#L3582">3582</a>
    </th>
    <td class="line-code">
      <pre>                SetX(x);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3583">
      <a href="#L3583">3583</a>
    </th>
    <td class="line-code">
      <pre>                SetY(y);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3584">
      <a href="#L3584">3584</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3585">
      <a href="#L3585">3585</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (w == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3586">
      <a href="#L3586">3586</a>
    </th>
    <td class="line-code">
      <pre>                        w = <span class="instance-variable">@fw</span> - x - <span class="instance-variable">@r_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3587">
      <a href="#L3587">3587</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3588">
      <a href="#L3588">3588</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3589">
      <a href="#L3589">3589</a>
    </th>
    <td class="line-code">
      <pre>                b=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3590">
      <a href="#L3590">3590</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (border)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3591">
      <a href="#L3591">3591</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border==<span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3592">
      <a href="#L3592">3592</a>
    </th>
    <td class="line-code">
      <pre>                                border=<span class="string"><span class="delimiter">'</span><span class="content">LTRB</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3593">
      <a href="#L3593">3593</a>
    </th>
    <td class="line-code">
      <pre>                                b=<span class="string"><span class="delimiter">'</span><span class="content">LRT</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3594">
      <a href="#L3594">3594</a>
    </th>
    <td class="line-code">
      <pre>                                b2=<span class="string"><span class="delimiter">'</span><span class="content">LR</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3595">
      <a href="#L3595">3595</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">elsif</span> border.is_a?(<span class="constant">String</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3596">
      <a href="#L3596">3596</a>
    </th>
    <td class="line-code">
      <pre>                                b2=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3597">
      <a href="#L3597">3597</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3598">
      <a href="#L3598">3598</a>
    </th>
    <td class="line-code">
      <pre>                                        b2&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3599">
      <a href="#L3599">3599</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3600">
      <a href="#L3600">3600</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (border.include?(<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3601">
      <a href="#L3601">3601</a>
    </th>
    <td class="line-code">
      <pre>                                        b2&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3602">
      <a href="#L3602">3602</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3603">
      <a href="#L3603">3603</a>
    </th>
    <td class="line-code">
      <pre>                                b=(border.include?(<span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span>)) ? b2 + <span class="string"><span class="delimiter">'</span><span class="content">T</span><span class="delimiter">'</span></span> : b2;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3604">
      <a href="#L3604">3604</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3605">
      <a href="#L3605">3605</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3606">
      <a href="#L3606">3606</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3607">
      <a href="#L3607">3607</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># store original margin values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3608">
      <a href="#L3608">3608</a>
    </th>
    <td class="line-code">
      <pre>                l_margin = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3609">
      <a href="#L3609">3609</a>
    </th>
    <td class="line-code">
      <pre>                r_margin = <span class="instance-variable">@r_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3610">
      <a href="#L3610">3610</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3611">
      <a href="#L3611">3611</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># set new margin values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3612">
      <a href="#L3612">3612</a>
    </th>
    <td class="line-code">
      <pre>                SetLeftMargin(x);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3613">
      <a href="#L3613">3613</a>
    </th>
    <td class="line-code">
      <pre>                SetRightMargin(<span class="instance-variable">@fw</span> - x - w);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3614">
      <a href="#L3614">3614</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3615">
      <a href="#L3615">3615</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># calculate remaining vertical space on page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3616">
      <a href="#L3616">3616</a>
    </th>
    <td class="line-code">
      <pre>                restspace = GetPageHeight() - GetY() - GetBreakMargin();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3617">
      <a href="#L3617">3617</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3618">
      <a href="#L3618">3618</a>
    </th>
    <td class="line-code">
      <pre>                writeHTML(html, <span class="predefined-constant">true</span>, fill); <span class="comment"># write html text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3619">
      <a href="#L3619">3619</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3620">
      <a href="#L3620">3620</a>
    </th>
    <td class="line-code">
      <pre>                currentY =  GetY();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3621">
      <a href="#L3621">3621</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3622">
      <a href="#L3622">3622</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@auto_page_break</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3623">
      <a href="#L3623">3623</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># check if a new page has been created</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3624">
      <a href="#L3624">3624</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (<span class="instance-variable">@page</span> &gt; pagenum)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3625">
      <a href="#L3625">3625</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># design a cell around the text on first page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3626">
      <a href="#L3626">3626</a>
    </th>
    <td class="line-code">
      <pre>                        currentpage = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3627">
      <a href="#L3627">3627</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@page</span> = pagenum;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3628">
      <a href="#L3628">3628</a>
    </th>
    <td class="line-code">
      <pre>                        SetY(GetPageHeight() - restspace - GetBreakMargin());
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3629">
      <a href="#L3629">3629</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(w, restspace - <span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, b, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3630">
      <a href="#L3630">3630</a>
    </th>
    <td class="line-code">
      <pre>                        b = b2;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3631">
      <a href="#L3631">3631</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3632">
      <a href="#L3632">3632</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">while</span> <span class="instance-variable">@page</span> &lt; currentpage
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3633">
      <a href="#L3633">3633</a>
    </th>
    <td class="line-code">
      <pre>                                SetY(<span class="instance-variable">@t_margin</span>); <span class="comment"># put cursor at the beginning of text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3634">
      <a href="#L3634">3634</a>
    </th>
    <td class="line-code">
      <pre>                                Cell(w, <span class="instance-variable">@page_break_trigger</span> - <span class="instance-variable">@t_margin</span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, b, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3635">
      <a href="#L3635">3635</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3636">
      <a href="#L3636">3636</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3637">
      <a href="#L3637">3637</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> (border.is_a?(<span class="constant">String</span>) <span class="keyword">and</span> border.include?(<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3638">
      <a href="#L3638">3638</a>
    </th>
    <td class="line-code">
      <pre>                                b&lt;&lt;<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3639">
      <a href="#L3639">3639</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3640">
      <a href="#L3640">3640</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># design a cell around the text on last page</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3641">
      <a href="#L3641">3641</a>
    </th>
    <td class="line-code">
      <pre>                        SetY(<span class="instance-variable">@t_margin</span>); <span class="comment"># put cursor at the beginning of text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3642">
      <a href="#L3642">3642</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(w, currentY - <span class="instance-variable">@t_margin</span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, b, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3643">
      <a href="#L3643">3643</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3644">
      <a href="#L3644">3644</a>
    </th>
    <td class="line-code">
      <pre>                        SetY(y); <span class="comment"># put cursor at the beginning of text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3645">
      <a href="#L3645">3645</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># design a cell around the text</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3646">
      <a href="#L3646">3646</a>
    </th>
    <td class="line-code">
      <pre>                        Cell(w, [h, (currentY - y)].max, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, border, <span class="integer">0</span>, <span class="string"><span class="delimiter">'</span><span class="content">L</span><span class="delimiter">'</span></span>, <span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3647">
      <a href="#L3647">3647</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3648">
      <a href="#L3648">3648</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@auto_page_break</span> = <span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3649">
      <a href="#L3649">3649</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3650">
      <a href="#L3650">3650</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># restore original margin values</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3651">
      <a href="#L3651">3651</a>
    </th>
    <td class="line-code">
      <pre>                SetLeftMargin(l_margin);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3652">
      <a href="#L3652">3652</a>
    </th>
    <td class="line-code">
      <pre>                SetRightMargin(r_margin);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3653">
      <a href="#L3653">3653</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3654">
      <a href="#L3654">3654</a>
    </th>
    <td class="line-code">
      <pre>                <span class="instance-variable">@lasth</span> = h
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3655">
      <a href="#L3655">3655</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3656">
      <a href="#L3656">3656</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment"># move cursor to specified position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3657">
      <a href="#L3657">3657</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">if</span> (ln == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3658">
      <a href="#L3658">3658</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the top-right of the cell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3659">
      <a href="#L3659">3659</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = x + w;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3660">
      <a href="#L3660">3660</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> = y;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3661">
      <a href="#L3661">3661</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ln == <span class="integer">1</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3662">
      <a href="#L3662">3662</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the beginning of the next line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3663">
      <a href="#L3663">3663</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3664">
      <a href="#L3664">3664</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> = currentY;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3665">
      <a href="#L3665">3665</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">elsif</span> (ln == <span class="integer">2</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3666">
      <a href="#L3666">3666</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="comment"># go to the bottom-left of the cell (below)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3667">
      <a href="#L3667">3667</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@x</span> = x;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3668">
      <a href="#L3668">3668</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="instance-variable">@y</span> = currentY;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3669">
      <a href="#L3669">3669</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3670">
      <a href="#L3670">3670</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3671">
      <a href="#L3671">3671</a>
    </th>
    <td class="line-code">
      <pre>  alias_method <span class="symbol">:write_html_cell</span>, <span class="symbol">:writeHTMLCell</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3672">
      <a href="#L3672">3672</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3673">
      <a href="#L3673">3673</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3674">
      <a href="#L3674">3674</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Check html table tag position.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3675">
      <a href="#L3675">3675</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3676">
      <a href="#L3676">3676</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param array :table potision array</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3677">
      <a href="#L3677">3677</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :current tr tag id number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3678">
      <a href="#L3678">3678</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :current td tag id number</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3679">
      <a href="#L3679">3679</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3680">
      <a href="#L3680">3680</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return int : next td_id position.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3681">
      <a href="#L3681">3681</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#               value 0 mean that can use position.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3682">
      <a href="#L3682">3682</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3683">
      <a href="#L3683">3683</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">checkTableBlockingCellPosition</span>(table, tr_id, td_id )
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3684">
      <a href="#L3684">3684</a>
    </th>
    <td class="line-code">
      <pre>                <span class="integer">0</span>.upto(tr_id) <span class="keyword">do</span> |j|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3685">
      <a href="#L3685">3685</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="integer">0</span>.upto(<span class="instance-variable">@t_cells</span>[table][j].size - <span class="integer">1</span>) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3686">
      <a href="#L3686">3686</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@t_cells</span>[table][j][i][<span class="string"><span class="delimiter">'</span><span class="content">i0</span><span class="delimiter">'</span></span>] &lt;= td_id <span class="keyword">and</span> td_id &lt;= <span class="instance-variable">@t_cells</span>[table][j][i][<span class="string"><span class="delimiter">'</span><span class="content">i1</span><span class="delimiter">'</span></span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3687">
      <a href="#L3687">3687</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> <span class="instance-variable">@t_cells</span>[table][j][i][<span class="string"><span class="delimiter">'</span><span class="content">j0</span><span class="delimiter">'</span></span>] &lt;= tr_id <span class="keyword">and</span> tr_id &lt;= <span class="instance-variable">@t_cells</span>[table][j][i][<span class="string"><span class="delimiter">'</span><span class="content">j1</span><span class="delimiter">'</span></span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3688">
      <a href="#L3688">3688</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">return</span> <span class="instance-variable">@t_cells</span>[table][j][i][<span class="string"><span class="delimiter">'</span><span class="content">i1</span><span class="delimiter">'</span></span>] - td_id + <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3689">
      <a href="#L3689">3689</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3690">
      <a href="#L3690">3690</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3691">
      <a href="#L3691">3691</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3692">
      <a href="#L3692">3692</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3693">
      <a href="#L3693">3693</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3694">
      <a href="#L3694">3694</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3695">
      <a href="#L3695">3695</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3696">
      <a href="#L3696">3696</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3697">
      <a href="#L3697">3697</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Calculate opening tags.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3698">
      <a href="#L3698">3698</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3699">
      <a href="#L3699">3699</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># html table cell array : @t_cells</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3700">
      <a href="#L3700">3700</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3701">
      <a href="#L3701">3701</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  i0: table cell start position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3702">
      <a href="#L3702">3702</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  i1: table cell end position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3703">
      <a href="#L3703">3703</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  j0: table row start position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3704">
      <a href="#L3704">3704</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  j1: table row end position</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3705">
      <a href="#L3705">3705</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3706">
      <a href="#L3706">3706</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  +------+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3707">
      <a href="#L3707">3707</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  |i0,j0 |</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3708">
      <a href="#L3708">3708</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  | i1,j1|</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3709">
      <a href="#L3709">3709</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  +------+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3710">
      <a href="#L3710">3710</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3711">
      <a href="#L3711">3711</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  example html:</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3712">
      <a href="#L3712">3712</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  &lt;table&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3713">
      <a href="#L3713">3713</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    &lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3714">
      <a href="#L3714">3714</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    &lt;tr&gt;&lt;td colspan=2&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3715">
      <a href="#L3715">3715</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    &lt;tr&gt;&lt;td rowspan=2&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3716">
      <a href="#L3716">3716</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#    &lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3717">
      <a href="#L3717">3717</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  &lt;/table&gt;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3718">
      <a href="#L3718">3718</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3719">
      <a href="#L3719">3719</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   i: 0    1    2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3720">
      <a href="#L3720">3720</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  j+----+----+----+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3721">
      <a href="#L3721">3721</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  :|0,0 |1,0 |2,0 |</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3722">
      <a href="#L3722">3722</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  0| 0,0| 1,0| 2,0|</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3723">
      <a href="#L3723">3723</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   +----+----+----+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3724">
      <a href="#L3724">3724</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   |0,1      |2,1 |</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3725">
      <a href="#L3725">3725</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  1|      1,1| 2,1|</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3726">
      <a href="#L3726">3726</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   +----+----+----+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3727">
      <a href="#L3727">3727</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   |0,2 |1,2 |2,2 |</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3728">
      <a href="#L3728">3728</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  2|    | 1,2| 2,2|</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3729">
      <a href="#L3729">3729</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   +    +----+----+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3730">
      <a href="#L3730">3730</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   |    |1,3 |2,3 |</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3731">
      <a href="#L3731">3731</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  3| 0,3| 1,3| 2,3|</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3732">
      <a href="#L3732">3732</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   +----+----+----+</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3733">
      <a href="#L3733">3733</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3734">
      <a href="#L3734">3734</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  html table cell array :</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3735">
      <a href="#L3735">3735</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#  [[[i0=&gt;0,j0=&gt;0,i1=&gt;0,j1=&gt;0],[i0=&gt;1,j0=&gt;0,i1=&gt;1,j1=&gt;0],[i0=&gt;2,j0=&gt;0,i1=&gt;2,j1=&gt;0]],</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3736">
      <a href="#L3736">3736</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   [[i0=&gt;0,j0=&gt;1,i1=&gt;1,j1=&gt;1],[i0=&gt;2,j0=&gt;1,i1=&gt;2,j1=&gt;1]],</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3737">
      <a href="#L3737">3737</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   [[i0=&gt;0,j0=&gt;2,i1=&gt;0,j1=&gt;3],[i0=&gt;1,j0=&gt;2,i1=&gt;1,j1=&gt;2],[i0=&gt;2,j0=&gt;2,i1=&gt;2,j1=&gt;2]]</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3738">
      <a href="#L3738">3738</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#   [[i0=&gt;1,j0=&gt;3,i1=&gt;1,j1=&gt;3],[i0=&gt;2,j0=&gt;3,i1=&gt;2,j1=&gt;3]]]</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3739">
      <a href="#L3739">3739</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3740">
      <a href="#L3740">3740</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :tag tag name (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3741">
      <a href="#L3741">3741</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :attr tag attribute (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3742">
      <a href="#L3742">3742</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3743">
      <a href="#L3743">3743</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3744">
      <a href="#L3744">3744</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">openHTMLTagCalc</span>(tag, attrs)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3745">
      <a href="#L3745">3745</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Opening tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3746">
      <a href="#L3746">3746</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3747">
      <a href="#L3747">3747</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">table</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3748">
      <a href="#L3748">3748</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>] = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3749">
      <a href="#L3749">3749</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@t_columns</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3750">
      <a href="#L3750">3750</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tr_id</span> = <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3751">
      <a href="#L3751">3751</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">tr</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3752">
      <a href="#L3752">3752</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>] &lt; <span class="instance-variable">@t_columns</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3753">
      <a href="#L3753">3753</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>] = <span class="instance-variable">@t_columns</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3754">
      <a href="#L3754">3754</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3755">
      <a href="#L3755">3755</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@t_columns</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3756">
      <a href="#L3756">3756</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tr_id</span> +=  <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3757">
      <a href="#L3757">3757</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@td_id</span> =  <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3758">
      <a href="#L3758">3758</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>].push []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3759">
      <a href="#L3759">3759</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">td</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">th</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3760">
      <a href="#L3760">3760</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@td_id</span> +=  <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3761">
      <a href="#L3761">3761</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">colspan</span><span class="delimiter">'</span></span>].nil? <span class="keyword">or</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">colspan</span><span class="delimiter">'</span></span>] == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3762">
      <a href="#L3762">3762</a>
    </th>
    <td class="line-code">
      <pre>                                        colspan = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3763">
      <a href="#L3763">3763</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3764">
      <a href="#L3764">3764</a>
    </th>
    <td class="line-code">
      <pre>                                        colspan = attrs[<span class="string"><span class="delimiter">'</span><span class="content">colspan</span><span class="delimiter">'</span></span>].to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3765">
      <a href="#L3765">3765</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3766">
      <a href="#L3766">3766</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">rowspan</span><span class="delimiter">'</span></span>].nil? <span class="keyword">or</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">rowspan</span><span class="delimiter">'</span></span>] == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3767">
      <a href="#L3767">3767</a>
    </th>
    <td class="line-code">
      <pre>                                        rowspan = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3768">
      <a href="#L3768">3768</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3769">
      <a href="#L3769">3769</a>
    </th>
    <td class="line-code">
      <pre>                                        rowspan = attrs[<span class="string"><span class="delimiter">'</span><span class="content">rowspan</span><span class="delimiter">'</span></span>].to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3770">
      <a href="#L3770">3770</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3771">
      <a href="#L3771">3771</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3772">
      <a href="#L3772">3772</a>
    </th>
    <td class="line-code">
      <pre>                                i = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3773">
      <a href="#L3773">3773</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">while</span> <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3774">
      <a href="#L3774">3774</a>
    </th>
    <td class="line-code">
      <pre>                                        next_i_distance = checkTableBlockingCellPosition(<span class="instance-variable">@table_id</span>, <span class="instance-variable">@tr_id</span>, <span class="instance-variable">@td_id</span> + i);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3775">
      <a href="#L3775">3775</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> next_i_distance == <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3776">
      <a href="#L3776">3776</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][<span class="instance-variable">@tr_id</span>].push <span class="string"><span class="delimiter">&quot;</span><span class="content">i0</span><span class="delimiter">&quot;</span></span>=&gt;<span class="instance-variable">@td_id</span> + i, <span class="string"><span class="delimiter">&quot;</span><span class="content">j0</span><span class="delimiter">&quot;</span></span>=&gt;<span class="instance-variable">@tr_id</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">i1</span><span class="delimiter">&quot;</span></span>=&gt;(<span class="instance-variable">@td_id</span> + i + colspan - <span class="integer">1</span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">j1</span><span class="delimiter">&quot;</span></span>=&gt;<span class="instance-variable">@tr_id</span> + rowspan - <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3777">
      <a href="#L3777">3777</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">break</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3778">
      <a href="#L3778">3778</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3779">
      <a href="#L3779">3779</a>
    </th>
    <td class="line-code">
      <pre>                                        i += next_i_distance;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3780">
      <a href="#L3780">3780</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3781">
      <a href="#L3781">3781</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3782">
      <a href="#L3782">3782</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@t_columns</span> += colspan;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3783">
      <a href="#L3783">3783</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3784">
      <a href="#L3784">3784</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3785">
      <a href="#L3785">3785</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3786">
      <a href="#L3786">3786</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3787">
      <a href="#L3787">3787</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Calculate closing tags.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3788">
      <a href="#L3788">3788</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :tag tag name (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3789">
      <a href="#L3789">3789</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3790">
      <a href="#L3790">3790</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3791">
      <a href="#L3791">3791</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">closedHTMLTagCalc</span>(tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3792">
      <a href="#L3792">3792</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Closing tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3793">
      <a href="#L3793">3793</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3794">
      <a href="#L3794">3794</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">table</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3795">
      <a href="#L3795">3795</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>] &lt; <span class="instance-variable">@t_columns</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3796">
      <a href="#L3796">3796</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>] = <span class="instance-variable">@t_columns</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3797">
      <a href="#L3797">3797</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3798">
      <a href="#L3798">3798</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@table_id</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3799">
      <a href="#L3799">3799</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@t_cells</span>.push []
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3800">
      <a href="#L3800">3800</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3801">
      <a href="#L3801">3801</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3802">
      <a href="#L3802">3802</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3803">
      <a href="#L3803">3803</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3804">
      <a href="#L3804">3804</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Convert to accessible file path</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3805">
      <a href="#L3805">3805</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :attrname image file name</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3806">
      <a href="#L3806">3806</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3807">
      <a href="#L3807">3807</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">getImageFilename</span>( attrname )
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3808">
      <a href="#L3808">3808</a>
    </th>
    <td class="line-code">
      <pre>                <span class="predefined-constant">nil</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3809">
      <a href="#L3809">3809</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3810">
      <a href="#L3810">3810</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3811">
      <a href="#L3811">3811</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3812">
      <a href="#L3812">3812</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Process opening tags.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3813">
      <a href="#L3813">3813</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :tag tag name (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3814">
      <a href="#L3814">3814</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :attr tag attribute (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3815">
      <a href="#L3815">3815</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the cell background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3816">
      <a href="#L3816">3816</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3817">
      <a href="#L3817">3817</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3818">
      <a href="#L3818">3818</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">openHTMLTagHandler</span>(tag, attrs, fill=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3819">
      <a href="#L3819">3819</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Opening tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3820">
      <a href="#L3820">3820</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3821">
      <a href="#L3821">3821</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">pre</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3822">
      <a href="#L3822">3822</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@pre_state</span> = <span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3823">
      <a href="#L3823">3823</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@l_margin</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3824">
      <a href="#L3824">3824</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@r_margin</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3825">
      <a href="#L3825">3825</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3826">
      <a href="#L3826">3826</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3827">
      <a href="#L3827">3827</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">table</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3828">
      <a href="#L3828">3828</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@default_table_columns</span> &lt; <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3829">
      <a href="#L3829">3829</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@table_columns</span> = <span class="instance-variable">@max_table_columns</span>[<span class="instance-variable">@table_id</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3830">
      <a href="#L3830">3830</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3831">
      <a href="#L3831">3831</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@table_columns</span> = <span class="instance-variable">@default_table_columns</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3832">
      <a href="#L3832">3832</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3833">
      <a href="#L3833">3833</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@l_margin</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3834">
      <a href="#L3834">3834</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@r_margin</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3835">
      <a href="#L3835">3835</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3836">
      <a href="#L3836">3836</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3837">
      <a href="#L3837">3837</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">border</span><span class="delimiter">'</span></span>].nil? <span class="keyword">or</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">border</span><span class="delimiter">'</span></span>] == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3838">
      <a href="#L3838">3838</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tableborder</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3839">
      <a href="#L3839">3839</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3840">
      <a href="#L3840">3840</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tableborder</span> = attrs[<span class="string"><span class="delimiter">'</span><span class="content">border</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3841">
      <a href="#L3841">3841</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3842">
      <a href="#L3842">3842</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tr_id</span>        = <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3843">
      <a href="#L3843">3843</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@max_td_page</span>[<span class="integer">0</span>] = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3844">
      <a href="#L3844">3844</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@max_td_y</span>[<span class="integer">0</span>]    = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3845">
      <a href="#L3845">3845</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3846">
      <a href="#L3846">3846</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">tr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">td</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">th</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3847">
      <a href="#L3847">3847</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">th</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3848">
      <a href="#L3848">3848</a>
    </th>
    <td class="line-code">
      <pre>                                        SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3849">
      <a href="#L3849">3849</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdalign</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">C</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3850">
      <a href="#L3850">3850</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3851">
      <a href="#L3851">3851</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> ((!attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>].nil?) <span class="keyword">and</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>] != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3852">
      <a href="#L3852">3852</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdwidth</span> = (attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>].to_i/<span class="integer">4</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3853">
      <a href="#L3853">3853</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3854">
      <a href="#L3854">3854</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdwidth</span> = ((<span class="instance-variable">@w</span> - <span class="instance-variable">@l_margin</span> - <span class="instance-variable">@r_margin</span>) / <span class="instance-variable">@table_columns</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3855">
      <a href="#L3855">3855</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3856">
      <a href="#L3856">3856</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3857">
      <a href="#L3857">3857</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">tr</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3858">
      <a href="#L3858">3858</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tr_id</span> +=  <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3859">
      <a href="#L3859">3859</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@td_id</span>  = <span class="integer">-1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3860">
      <a href="#L3860">3860</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3861">
      <a href="#L3861">3861</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@td_id</span> +=  <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3862">
      <a href="#L3862">3862</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@x</span> =  <span class="instance-variable">@l_margin</span> + <span class="instance-variable">@tdwidth</span> * <span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][<span class="instance-variable">@tr_id</span>][<span class="instance-variable">@td_id</span>][<span class="string"><span class="delimiter">'</span><span class="content">i0</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3863">
      <a href="#L3863">3863</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3864">
      <a href="#L3864">3864</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3865">
      <a href="#L3865">3865</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">colspan</span><span class="delimiter">'</span></span>].nil? <span class="keyword">or</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">border</span><span class="delimiter">'</span></span>] == <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3866">
      <a href="#L3866">3866</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@colspan</span> = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3867">
      <a href="#L3867">3867</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3868">
      <a href="#L3868">3868</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@colspan</span> = attrs[<span class="string"><span class="delimiter">'</span><span class="content">colspan</span><span class="delimiter">'</span></span>].to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3869">
      <a href="#L3869">3869</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3870">
      <a href="#L3870">3870</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdwidth</span> *= <span class="instance-variable">@colspan</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3871">
      <a href="#L3871">3871</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> ((!attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>].nil?) <span class="keyword">and</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>] != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3872">
      <a href="#L3872">3872</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdheight</span>=(attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>].to_i / <span class="instance-variable">@k</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3873">
      <a href="#L3873">3873</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3874">
      <a href="#L3874">3874</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdheight</span> = <span class="instance-variable">@lasth</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3875">
      <a href="#L3875">3875</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3876">
      <a href="#L3876">3876</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> ((!attrs[<span class="string"><span class="delimiter">'</span><span class="content">align</span><span class="delimiter">'</span></span>].nil?) <span class="keyword">and</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">align</span><span class="delimiter">'</span></span>] != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3877">
      <a href="#L3877">3877</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">case</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">align</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3878">
      <a href="#L3878">3878</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">center</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3879">
      <a href="#L3879">3879</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="instance-variable">@tdalign</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">C</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3880">
      <a href="#L3880">3880</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">right</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3881">
      <a href="#L3881">3881</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="instance-variable">@tdalign</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">R</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3882">
      <a href="#L3882">3882</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">left</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3883">
      <a href="#L3883">3883</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="instance-variable">@tdalign</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">L</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3884">
      <a href="#L3884">3884</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3885">
      <a href="#L3885">3885</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3886">
      <a href="#L3886">3886</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> ((!attrs[<span class="string"><span class="delimiter">'</span><span class="content">bgcolor</span><span class="delimiter">'</span></span>].nil?) <span class="keyword">and</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">bgcolor</span><span class="delimiter">'</span></span>] != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3887">
      <a href="#L3887">3887</a>
    </th>
    <td class="line-code">
      <pre>                                        coul = convertColorHexToDec(attrs[<span class="string"><span class="delimiter">'</span><span class="content">bgcolor</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3888">
      <a href="#L3888">3888</a>
    </th>
    <td class="line-code">
      <pre>                                        SetFillColor(coul[<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>], coul[<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>], coul[<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3889">
      <a href="#L3889">3889</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@tdfill</span>=<span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3890">
      <a href="#L3890">3890</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3891">
      <a href="#L3891">3891</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdbegin</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3892">
      <a href="#L3892">3892</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3893">
      <a href="#L3893">3893</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">hr</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3894">
      <a href="#L3894">3894</a>
    </th>
    <td class="line-code">
      <pre>                                margin = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3895">
      <a href="#L3895">3895</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> ((!attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>].nil?) <span class="keyword">and</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>] != <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3896">
      <a href="#L3896">3896</a>
    </th>
    <td class="line-code">
      <pre>                                        hrWidth = attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3897">
      <a href="#L3897">3897</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3898">
      <a href="#L3898">3898</a>
    </th>
    <td class="line-code">
      <pre>                                        hrWidth = <span class="instance-variable">@w</span> - <span class="instance-variable">@l_margin</span> - <span class="instance-variable">@r_margin</span> - margin;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3899">
      <a href="#L3899">3899</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3900">
      <a href="#L3900">3900</a>
    </th>
    <td class="line-code">
      <pre>                                SetLineWidth(<span class="float">0.2</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3901">
      <a href="#L3901">3901</a>
    </th>
    <td class="line-code">
      <pre>                                Line(<span class="instance-variable">@x</span> + margin, <span class="instance-variable">@y</span>, <span class="instance-variable">@x</span> + hrWidth, <span class="instance-variable">@y</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3902">
      <a href="#L3902">3902</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3903">
      <a href="#L3903">3903</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3904">
      <a href="#L3904">3904</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">strong</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3905">
      <a href="#L3905">3905</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3906">
      <a href="#L3906">3906</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3907">
      <a href="#L3907">3907</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">em</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3908">
      <a href="#L3908">3908</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3909">
      <a href="#L3909">3909</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3910">
      <a href="#L3910">3910</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">ins</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3911">
      <a href="#L3911">3911</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3912">
      <a href="#L3912">3912</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3913">
      <a href="#L3913">3913</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">del</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3914">
      <a href="#L3914">3914</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">d</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3915">
      <a href="#L3915">3915</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3916">
      <a href="#L3916">3916</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3917">
      <a href="#L3917">3917</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(tag, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3918">
      <a href="#L3918">3918</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3919">
      <a href="#L3919">3919</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3920">
      <a href="#L3920">3920</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@href</span> = attrs[<span class="string"><span class="delimiter">'</span><span class="content">href</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3921">
      <a href="#L3921">3921</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3922">
      <a href="#L3922">3922</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">img</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3923">
      <a href="#L3923">3923</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!attrs[<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3924">
      <a href="#L3924">3924</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment"># Only generates image include a pdf if RMagick is avalaible</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3925">
      <a href="#L3925">3925</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">unless</span> <span class="constant">Object</span>.const_defined?(<span class="symbol">:Magick</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3926">
      <a href="#L3926">3926</a>
    </th>
    <td class="line-code">
      <pre>                                                Write(<span class="instance-variable">@lasth</span>, attrs[<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>], <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3927">
      <a href="#L3927">3927</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">return</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3928">
      <a href="#L3928">3928</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3929">
      <a href="#L3929">3929</a>
    </th>
    <td class="line-code">
      <pre>                                        file = getImageFilename(attrs[<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3930">
      <a href="#L3930">3930</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (file.nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3931">
      <a href="#L3931">3931</a>
    </th>
    <td class="line-code">
      <pre>                                                Write(<span class="instance-variable">@lasth</span>, attrs[<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>], <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3932">
      <a href="#L3932">3932</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">return</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3933">
      <a href="#L3933">3933</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3934">
      <a href="#L3934">3934</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3935">
      <a href="#L3935">3935</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3936">
      <a href="#L3936">3936</a>
    </th>
    <td class="line-code">
      <pre>                                                attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>] = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3937">
      <a href="#L3937">3937</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3938">
      <a href="#L3938">3938</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3939">
      <a href="#L3939">3939</a>
    </th>
    <td class="line-code">
      <pre>                                                attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>] = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3940">
      <a href="#L3940">3940</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3941">
      <a href="#L3941">3941</a>
    </th>
    <td class="line-code">
      <pre>                                        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3942">
      <a href="#L3942">3942</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">begin</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3943">
      <a href="#L3943">3943</a>
    </th>
    <td class="line-code">
      <pre>                                                Image(file, GetX(),GetY(), pixelsToMillimeters(attrs[<span class="string"><span class="delimiter">'</span><span class="content">width</span><span class="delimiter">'</span></span>]), pixelsToMillimeters(attrs[<span class="string"><span class="delimiter">'</span><span class="content">height</span><span class="delimiter">'</span></span>]));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3944">
      <a href="#L3944">3944</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="comment">#SetX(@img_rb_x);</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3945">
      <a href="#L3945">3945</a>
    </th>
    <td class="line-code">
      <pre>                                                SetY(<span class="instance-variable">@img_rb_y</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3946">
      <a href="#L3946">3946</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">rescue</span> =&gt; err
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3947">
      <a href="#L3947">3947</a>
    </th>
    <td class="line-code">
      <pre>                                                logger.error <span class="string"><span class="delimiter">&quot;</span><span class="content">pdf: Image: error: </span><span class="inline"><span class="inline-delimiter">#{</span>err.message<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3948">
      <a href="#L3948">3948</a>
    </th>
    <td class="line-code">
      <pre>                                                Write(<span class="instance-variable">@lasth</span>, attrs[<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>], <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3949">
      <a href="#L3949">3949</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">if</span> <span class="constant">File</span>.file?( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3950">
      <a href="#L3950">3950</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="constant">File</span>.delete( <span class="class-variable">@@k_path_cache</span> + <span class="constant">File</span>::basename(file))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3951">
      <a href="#L3951">3951</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3952">
      <a href="#L3952">3952</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3953">
      <a href="#L3953">3953</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3954">
      <a href="#L3954">3954</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3955">
      <a href="#L3955">3955</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">ul</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">ol</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3956">
      <a href="#L3956">3956</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@li_count</span> == <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3957">
      <a href="#L3957">3957</a>
    </th>
    <td class="line-code">
      <pre>                                        Ln() <span class="keyword">if</span> <span class="instance-variable">@prevquote_count</span> == <span class="instance-variable">@quote_count</span>; <span class="comment"># insert Ln for keeping quote lines</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3958">
      <a href="#L3958">3958</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@prevquote_count</span> = <span class="instance-variable">@quote_count</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3959">
      <a href="#L3959">3959</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3960">
      <a href="#L3960">3960</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@li_state</span> == <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3961">
      <a href="#L3961">3961</a>
    </th>
    <td class="line-code">
      <pre>                                        Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3962">
      <a href="#L3962">3962</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="instance-variable">@li_state</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3963">
      <a href="#L3963">3963</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3964">
      <a href="#L3964">3964</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">ul</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3965">
      <a href="#L3965">3965</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@list_ordered</span>[<span class="instance-variable">@li_count</span>] = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3966">
      <a href="#L3966">3966</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3967">
      <a href="#L3967">3967</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@list_ordered</span>[<span class="instance-variable">@li_count</span>] = <span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3968">
      <a href="#L3968">3968</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3969">
      <a href="#L3969">3969</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@list_count</span>[<span class="instance-variable">@li_count</span>] = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3970">
      <a href="#L3970">3970</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@li_count</span> += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3971">
      <a href="#L3971">3971</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3972">
      <a href="#L3972">3972</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">li</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3973">
      <a href="#L3973">3973</a>
    </th>
    <td class="line-code">
      <pre>                                Ln() <span class="keyword">if</span> <span class="instance-variable">@li_state</span> == <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3974">
      <a href="#L3974">3974</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@list_ordered</span>[<span class="instance-variable">@li_count</span> - <span class="integer">1</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3975">
      <a href="#L3975">3975</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@list_count</span>[<span class="instance-variable">@li_count</span> - <span class="integer">1</span>] += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3976">
      <a href="#L3976">3976</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@li_spacer</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">    </span><span class="delimiter">&quot;</span></span> * <span class="instance-variable">@li_count</span> + (<span class="instance-variable">@list_count</span>[<span class="instance-variable">@li_count</span> - <span class="integer">1</span>]).to_s + <span class="string"><span class="delimiter">&quot;</span><span class="content">. </span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3977">
      <a href="#L3977">3977</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3978">
      <a href="#L3978">3978</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="comment">#unordered list simbol</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3979">
      <a href="#L3979">3979</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@li_spacer</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">    </span><span class="delimiter">&quot;</span></span> * <span class="instance-variable">@li_count</span> + <span class="string"><span class="delimiter">&quot;</span><span class="content">-  </span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3980">
      <a href="#L3980">3980</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3981">
      <a href="#L3981">3981</a>
    </th>
    <td class="line-code">
      <pre>                                Write(<span class="instance-variable">@lasth</span>, <span class="instance-variable">@spacer</span> + <span class="instance-variable">@li_spacer</span>, <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3982">
      <a href="#L3982">3982</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@li_state</span> = <span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3983">
      <a href="#L3983">3983</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3984">
      <a href="#L3984">3984</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">blockquote</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3985">
      <a href="#L3985">3985</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@quote_count</span> == <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3986">
      <a href="#L3986">3986</a>
    </th>
    <td class="line-code">
      <pre>                                        SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3987">
      <a href="#L3987">3987</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@l_margin</span> += <span class="integer">5</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3988">
      <a href="#L3988">3988</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3989">
      <a href="#L3989">3989</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@l_margin</span> += <span class="integer">5</span> / <span class="integer">2</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3990">
      <a href="#L3990">3990</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3991">
      <a href="#L3991">3991</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3992">
      <a href="#L3992">3992</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@quote_top</span>[<span class="instance-variable">@quote_count</span>]  = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3993">
      <a href="#L3993">3993</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@quote_page</span>[<span class="instance-variable">@quote_count</span>] = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3994">
      <a href="#L3994">3994</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@quote_count</span> += <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3995">
      <a href="#L3995">3995</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">br</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3996">
      <a href="#L3996">3996</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3997">
      <a href="#L3997">3997</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3998">
      <a href="#L3998">3998</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@li_spacer</span>.length &gt; <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L3999">
      <a href="#L3999">3999</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@x</span> += GetStringWidth(<span class="instance-variable">@li_spacer</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4000">
      <a href="#L4000">4000</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4001">
      <a href="#L4001">4001</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4002">
      <a href="#L4002">4002</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">p</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4003">
      <a href="#L4003">4003</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4004">
      <a href="#L4004">4004</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="integer">0</span>.upto(<span class="instance-variable">@quote_count</span> - <span class="integer">1</span>) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4005">
      <a href="#L4005">4005</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="keyword">if</span> <span class="instance-variable">@quote_page</span>[i] == <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4006">
      <a href="#L4006">4006</a>
    </th>
    <td class="line-code">
      <pre>                                          <span class="keyword">if</span> <span class="instance-variable">@quote_top</span>[i] == <span class="instance-variable">@y</span> - <span class="instance-variable">@lasth</span>; <span class="comment"># fix start line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4007">
      <a href="#L4007">4007</a>
    </th>
    <td class="line-code">
      <pre>                                                  <span class="instance-variable">@quote_top</span>[i] = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4008">
      <a href="#L4008">4008</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4009">
      <a href="#L4009">4009</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4010">
      <a href="#L4010">4010</a>
    </th>
    <td class="line-code">
      <pre>                                          <span class="keyword">if</span> <span class="instance-variable">@quote_page</span>[i] == <span class="instance-variable">@page</span> - <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4011">
      <a href="#L4011">4011</a>
    </th>
    <td class="line-code">
      <pre>                                                  <span class="instance-variable">@quote_page</span>[i] = <span class="instance-variable">@page</span>; <span class="comment"># fix start line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4012">
      <a href="#L4012">4012</a>
    </th>
    <td class="line-code">
      <pre>                                                  <span class="instance-variable">@quote_top</span>[i] = <span class="instance-variable">@t_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4013">
      <a href="#L4013">4013</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4014">
      <a href="#L4014">4014</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4015">
      <a href="#L4015">4015</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4016">
      <a href="#L4016">4016</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4017">
      <a href="#L4017">4017</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">sup</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4018">
      <a href="#L4018">4018</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4019">
      <a href="#L4019">4019</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4020">
      <a href="#L4020">4020</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@font_size_pt</span> * <span class="class-variable">@@k_small_ratio</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4021">
      <a href="#L4021">4021</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() - ((currentfont_size - <span class="instance-variable">@font_size</span>)*(<span class="class-variable">@@k_small_ratio</span>)));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4022">
      <a href="#L4022">4022</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4023">
      <a href="#L4023">4023</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">sub</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4024">
      <a href="#L4024">4024</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4025">
      <a href="#L4025">4025</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4026">
      <a href="#L4026">4026</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@font_size_pt</span> * <span class="class-variable">@@k_small_ratio</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4027">
      <a href="#L4027">4027</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() + ((currentfont_size - <span class="instance-variable">@font_size</span>)*(<span class="class-variable">@@k_small_ratio</span>)));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4028">
      <a href="#L4028">4028</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4029">
      <a href="#L4029">4029</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">small</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4030">
      <a href="#L4030">4030</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4031">
      <a href="#L4031">4031</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4032">
      <a href="#L4032">4032</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@font_size_pt</span> * <span class="class-variable">@@k_small_ratio</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4033">
      <a href="#L4033">4033</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() + ((currentfont_size - <span class="instance-variable">@font_size</span>)/<span class="integer">3</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4034">
      <a href="#L4034">4034</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4035">
      <a href="#L4035">4035</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">font</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4036">
      <a href="#L4036">4036</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!attrs[<span class="string"><span class="delimiter">'</span><span class="content">color</span><span class="delimiter">'</span></span>].nil? <span class="keyword">and</span> attrs[<span class="string"><span class="delimiter">'</span><span class="content">color</span><span class="delimiter">'</span></span>]!=<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4037">
      <a href="#L4037">4037</a>
    </th>
    <td class="line-code">
      <pre>                                        coul = convertColorHexToDec(attrs[<span class="string"><span class="delimiter">'</span><span class="content">color</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4038">
      <a href="#L4038">4038</a>
    </th>
    <td class="line-code">
      <pre>                                        SetTextColor(coul[<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>], coul[<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>], coul[<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4039">
      <a href="#L4039">4039</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@issetcolor</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4040">
      <a href="#L4040">4040</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4041">
      <a href="#L4041">4041</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!attrs[<span class="string"><span class="delimiter">'</span><span class="content">face</span><span class="delimiter">'</span></span>].nil? <span class="keyword">and</span> <span class="instance-variable">@fontlist</span>.include?(attrs[<span class="string"><span class="delimiter">'</span><span class="content">face</span><span class="delimiter">'</span></span>].downcase))
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4042">
      <a href="#L4042">4042</a>
    </th>
    <td class="line-code">
      <pre>                                        SetFont(attrs[<span class="string"><span class="delimiter">'</span><span class="content">face</span><span class="delimiter">'</span></span>].downcase);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4043">
      <a href="#L4043">4043</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@issetfont</span>=<span class="predefined-constant">true</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4044">
      <a href="#L4044">4044</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4045">
      <a href="#L4045">4045</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (!attrs[<span class="string"><span class="delimiter">'</span><span class="content">size</span><span class="delimiter">'</span></span>].nil?)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4046">
      <a href="#L4046">4046</a>
    </th>
    <td class="line-code">
      <pre>                                        headsize = attrs[<span class="string"><span class="delimiter">'</span><span class="content">size</span><span class="delimiter">'</span></span>].to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4047">
      <a href="#L4047">4047</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4048">
      <a href="#L4048">4048</a>
    </th>
    <td class="line-code">
      <pre>                                        headsize = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4049">
      <a href="#L4049">4049</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4050">
      <a href="#L4050">4050</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4051">
      <a href="#L4051">4051</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4052">
      <a href="#L4052">4052</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@font_size_pt</span> + headsize);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4053">
      <a href="#L4053">4053</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4054">
      <a href="#L4054">4054</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4055">
      <a href="#L4055">4055</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">h1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h3</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h4</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h5</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h6</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4056">
      <a href="#L4056">4056</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4057">
      <a href="#L4057">4057</a>
    </th>
    <td class="line-code">
      <pre>                                headsize = (<span class="integer">4</span> - tag[<span class="integer">1</span>,<span class="integer">1</span>].to_f) * <span class="integer">2</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4058">
      <a href="#L4058">4058</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4059">
      <a href="#L4059">4059</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@font_size_pt</span> + headsize);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4060">
      <a href="#L4060">4060</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4061">
      <a href="#L4061">4061</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4062">
      <a href="#L4062">4062</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4063">
      <a href="#L4063">4063</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4064">
      <a href="#L4064">4064</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4065">
      <a href="#L4065">4065</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4066">
      <a href="#L4066">4066</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4067">
      <a href="#L4067">4067</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Process closing tags.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4068">
      <a href="#L4068">4068</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :tag tag name (in upcase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4069">
      <a href="#L4069">4069</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4070">
      <a href="#L4070">4070</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4071">
      <a href="#L4071">4071</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">closedHTMLTagHandler</span>(tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4072">
      <a href="#L4072">4072</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Closing tag</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4073">
      <a href="#L4073">4073</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">case</span> (tag)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4074">
      <a href="#L4074">4074</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">pre</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4075">
      <a href="#L4075">4075</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@pre_state</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4076">
      <a href="#L4076">4076</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@l_margin</span> -= <span class="integer">5</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4077">
      <a href="#L4077">4077</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@r_margin</span> -= <span class="integer">5</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4078">
      <a href="#L4078">4078</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4079">
      <a href="#L4079">4079</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4080">
      <a href="#L4080">4080</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4081">
      <a href="#L4081">4081</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">td</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">th</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4082">
      <a href="#L4082">4082</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdbegin</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4083">
      <a href="#L4083">4083</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdwidth</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4084">
      <a href="#L4084">4084</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdheight</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4085">
      <a href="#L4085">4085</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdalign</span> = <span class="string"><span class="delimiter">&quot;</span><span class="content">L</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4086">
      <a href="#L4086">4086</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4087">
      <a href="#L4087">4087</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tdfill</span> = <span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4088">
      <a href="#L4088">4088</a>
    </th>
    <td class="line-code">
      <pre>                                SetFillColor(<span class="instance-variable">@prevfill_color</span>[<span class="integer">0</span>], <span class="instance-variable">@prevfill_color</span>[<span class="integer">1</span>], <span class="instance-variable">@prevfill_color</span>[<span class="integer">2</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4089">
      <a href="#L4089">4089</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4090">
      <a href="#L4090">4090</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">tr</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4091">
      <a href="#L4091">4091</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@y</span> = <span class="instance-variable">@max_td_y</span>[<span class="instance-variable">@tr_id</span> + <span class="integer">1</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4092">
      <a href="#L4092">4092</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4093">
      <a href="#L4093">4093</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@page</span> = <span class="instance-variable">@max_td_page</span>[<span class="instance-variable">@tr_id</span> + <span class="integer">1</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4094">
      <a href="#L4094">4094</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4095">
      <a href="#L4095">4095</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">table</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4096">
      <a href="#L4096">4096</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment"># Write Table Line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4097">
      <a href="#L4097">4097</a>
    </th>
    <td class="line-code">
      <pre>                                width = (<span class="instance-variable">@w</span> - <span class="instance-variable">@l_margin</span> - <span class="instance-variable">@r_margin</span>) / <span class="instance-variable">@table_columns</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4098">
      <a href="#L4098">4098</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="integer">0</span>.upto(<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>].size - <span class="integer">1</span>) <span class="keyword">do</span> |j|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4099">
      <a href="#L4099">4099</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="integer">0</span>.upto(<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][j].size - <span class="integer">1</span>) <span class="keyword">do</span> |i|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4100">
      <a href="#L4100">4100</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@page</span> = <span class="instance-variable">@max_td_page</span>[j]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4101">
      <a href="#L4101">4101</a>
    </th>
    <td class="line-code">
      <pre>                                                i0=<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][j][i][<span class="string"><span class="delimiter">'</span><span class="content">i0</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4102">
      <a href="#L4102">4102</a>
    </th>
    <td class="line-code">
      <pre>                                                j0=<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][j][i][<span class="string"><span class="delimiter">'</span><span class="content">j0</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4103">
      <a href="#L4103">4103</a>
    </th>
    <td class="line-code">
      <pre>                                                i1=<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][j][i][<span class="string"><span class="delimiter">'</span><span class="content">i1</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4104">
      <a href="#L4104">4104</a>
    </th>
    <td class="line-code">
      <pre>                                                j1=<span class="instance-variable">@t_cells</span>[<span class="instance-variable">@table_id</span>][j][i][<span class="string"><span class="delimiter">'</span><span class="content">j1</span><span class="delimiter">'</span></span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4105">
      <a href="#L4105">4105</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4106">
      <a href="#L4106">4106</a>
    </th>
    <td class="line-code">
      <pre>                                                Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j0],   <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j0])   <span class="comment"># top</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4107">
      <a href="#L4107">4107</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">if</span> ( <span class="instance-variable">@page</span> == <span class="instance-variable">@max_td_page</span>[j1 + <span class="integer">1</span>])
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4108">
      <a href="#L4108">4108</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j0],   <span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>]) <span class="comment"># left</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4109">
      <a href="#L4109">4109</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j0],   <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>]) <span class="comment"># right</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4110">
      <a href="#L4110">4110</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4111">
      <a href="#L4111">4111</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j0],   <span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@page_break_trigger</span>) <span class="comment"># left</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4112">
      <a href="#L4112">4112</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j0],   <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@page_break_trigger</span>) <span class="comment"># right</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4113">
      <a href="#L4113">4113</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4114">
      <a href="#L4114">4114</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="keyword">while</span> <span class="instance-variable">@page</span> &lt; <span class="instance-variable">@max_td_page</span>[j1 + <span class="integer">1</span>]
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4115">
      <a href="#L4115">4115</a>
    </th>
    <td class="line-code">
      <pre>                                                                Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@t_margin</span>,   <span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@page_break_trigger</span>) <span class="comment"># left</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4116">
      <a href="#L4116">4116</a>
    </th>
    <td class="line-code">
      <pre>                                                                Line(<span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@t_margin</span>,   <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@page_break_trigger</span>) <span class="comment"># right</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4117">
      <a href="#L4117">4117</a>
    </th>
    <td class="line-code">
      <pre>                                                                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4118">
      <a href="#L4118">4118</a>
    </th>
    <td class="line-code">
      <pre>                                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4119">
      <a href="#L4119">4119</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@t_margin</span>,   <span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>]) <span class="comment"># left</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4120">
      <a href="#L4120">4120</a>
    </th>
    <td class="line-code">
      <pre>                                                        Line(<span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@t_margin</span>,   <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>]) <span class="comment"># right</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4121">
      <a href="#L4121">4121</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4122">
      <a href="#L4122">4122</a>
    </th>
    <td class="line-code">
      <pre>                                                Line(<span class="instance-variable">@l_margin</span> + width * i0,     <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>], <span class="instance-variable">@l_margin</span> + width * (i1+<span class="integer">1</span>), <span class="instance-variable">@max_td_y</span>[j1+<span class="integer">1</span>]) <span class="comment"># bottom</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4123">
      <a href="#L4123">4123</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4124">
      <a href="#L4124">4124</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4125">
      <a href="#L4125">4125</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4126">
      <a href="#L4126">4126</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@l_margin</span> -= <span class="integer">5</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4127">
      <a href="#L4127">4127</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@r_margin</span> -= <span class="integer">5</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4128">
      <a href="#L4128">4128</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tableborder</span>=<span class="integer">0</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4129">
      <a href="#L4129">4129</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4130">
      <a href="#L4130">4130</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@table_id</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4131">
      <a href="#L4131">4131</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4132">
      <a href="#L4132">4132</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">strong</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4133">
      <a href="#L4133">4133</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4134">
      <a href="#L4134">4134</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4135">
      <a href="#L4135">4135</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">em</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4136">
      <a href="#L4136">4136</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4137">
      <a href="#L4137">4137</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4138">
      <a href="#L4138">4138</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">ins</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4139">
      <a href="#L4139">4139</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4140">
      <a href="#L4140">4140</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4141">
      <a href="#L4141">4141</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">del</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4142">
      <a href="#L4142">4142</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">d</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4143">
      <a href="#L4143">4143</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4144">
      <a href="#L4144">4144</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4145">
      <a href="#L4145">4145</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(tag, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4146">
      <a href="#L4146">4146</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4147">
      <a href="#L4147">4147</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4148">
      <a href="#L4148">4148</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@href</span> = <span class="predefined-constant">nil</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4149">
      <a href="#L4149">4149</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4150">
      <a href="#L4150">4150</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">p</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4151">
      <a href="#L4151">4151</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4152">
      <a href="#L4152">4152</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4153">
      <a href="#L4153">4153</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">sup</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4154">
      <a href="#L4154">4154</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4155">
      <a href="#L4155">4155</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@tempfontsize</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4156">
      <a href="#L4156">4156</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4157">
      <a href="#L4157">4157</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() - ((currentfont_size - <span class="instance-variable">@font_size</span>)*(<span class="class-variable">@@k_small_ratio</span>)));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4158">
      <a href="#L4158">4158</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4159">
      <a href="#L4159">4159</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">sub</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4160">
      <a href="#L4160">4160</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4161">
      <a href="#L4161">4161</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@tempfontsize</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4162">
      <a href="#L4162">4162</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4163">
      <a href="#L4163">4163</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() + ((currentfont_size - <span class="instance-variable">@font_size</span>)*(<span class="class-variable">@@k_small_ratio</span>)));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4164">
      <a href="#L4164">4164</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4165">
      <a href="#L4165">4165</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">small</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4166">
      <a href="#L4166">4166</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4167">
      <a href="#L4167">4167</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@tempfontsize</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4168">
      <a href="#L4168">4168</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4169">
      <a href="#L4169">4169</a>
    </th>
    <td class="line-code">
      <pre>                                SetXY(GetX(), GetY() - ((<span class="instance-variable">@font_size</span> - currentfont_size)/<span class="integer">3</span>));
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4170">
      <a href="#L4170">4170</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4171">
      <a href="#L4171">4171</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">font</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4172">
      <a href="#L4172">4172</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@issetcolor</span> == <span class="predefined-constant">true</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4173">
      <a href="#L4173">4173</a>
    </th>
    <td class="line-code">
      <pre>                                        SetTextColor(<span class="instance-variable">@prevtext_color</span>[<span class="integer">0</span>], <span class="instance-variable">@prevtext_color</span>[<span class="integer">1</span>], <span class="instance-variable">@prevtext_color</span>[<span class="integer">2</span>]);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4174">
      <a href="#L4174">4174</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4175">
      <a href="#L4175">4175</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@issetfont</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4176">
      <a href="#L4176">4176</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@font_family</span> = <span class="instance-variable">@prevfont_family</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4177">
      <a href="#L4177">4177</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@font_style</span> = <span class="instance-variable">@prevfont_style</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4178">
      <a href="#L4178">4178</a>
    </th>
    <td class="line-code">
      <pre>                                        SetFont(<span class="instance-variable">@font_family</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4179">
      <a href="#L4179">4179</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@issetfont</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4180">
      <a href="#L4180">4180</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4181">
      <a href="#L4181">4181</a>
    </th>
    <td class="line-code">
      <pre>                                currentfont_size = <span class="instance-variable">@font_size</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4182">
      <a href="#L4182">4182</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@tempfontsize</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4183">
      <a href="#L4183">4183</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4184">
      <a href="#L4184">4184</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="comment">#@text_color = @prevtext_color;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4185">
      <a href="#L4185">4185</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4186">
      <a href="#L4186">4186</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4187">
      <a href="#L4187">4187</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">blockquote</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4188">
      <a href="#L4188">4188</a>
    </th>
    <td class="line-code">
      <pre>                          <span class="instance-variable">@quote_count</span> -= <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4189">
      <a href="#L4189">4189</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@quote_page</span>[<span class="instance-variable">@quote_count</span>] == <span class="instance-variable">@page</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4190">
      <a href="#L4190">4190</a>
    </th>
    <td class="line-code">
      <pre>                                        Line(<span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@quote_top</span>[<span class="instance-variable">@quote_count</span>], <span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@y</span>)  <span class="comment"># quoto line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4191">
      <a href="#L4191">4191</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4192">
      <a href="#L4192">4192</a>
    </th>
    <td class="line-code">
      <pre>                                        cur_page = <span class="instance-variable">@page</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4193">
      <a href="#L4193">4193</a>
    </th>
    <td class="line-code">
      <pre>                                        cur_y = <span class="instance-variable">@y</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4194">
      <a href="#L4194">4194</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@page</span> = <span class="instance-variable">@quote_page</span>[<span class="instance-variable">@quote_count</span>];
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4195">
      <a href="#L4195">4195</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> (<span class="instance-variable">@quote_top</span>[<span class="instance-variable">@quote_count</span>] &lt; <span class="instance-variable">@page_break_trigger</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4196">
      <a href="#L4196">4196</a>
    </th>
    <td class="line-code">
      <pre>                                                Line(<span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@quote_top</span>[<span class="instance-variable">@quote_count</span>], <span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@page_break_trigger</span>)  <span class="comment"># quoto line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4197">
      <a href="#L4197">4197</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4198">
      <a href="#L4198">4198</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4199">
      <a href="#L4199">4199</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">while</span> <span class="instance-variable">@page</span> &lt; cur_page
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4200">
      <a href="#L4200">4200</a>
    </th>
    <td class="line-code">
      <pre>                                                Line(<span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@t_margin</span>, <span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@page_break_trigger</span>)  <span class="comment"># quoto line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4201">
      <a href="#L4201">4201</a>
    </th>
    <td class="line-code">
      <pre>                                                <span class="instance-variable">@page</span> += <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4202">
      <a href="#L4202">4202</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4203">
      <a href="#L4203">4203</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@y</span> = cur_y;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4204">
      <a href="#L4204">4204</a>
    </th>
    <td class="line-code">
      <pre>                                        Line(<span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@t_margin</span>, <span class="instance-variable">@l_margin</span> - <span class="integer">1</span>, <span class="instance-variable">@y</span>)  <span class="comment"># quoto line</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4205">
      <a href="#L4205">4205</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4206">
      <a href="#L4206">4206</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> (<span class="instance-variable">@quote_count</span> &lt;= <span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4207">
      <a href="#L4207">4207</a>
    </th>
    <td class="line-code">
      <pre>                                        SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4208">
      <a href="#L4208">4208</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@l_margin</span> -= <span class="integer">5</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4209">
      <a href="#L4209">4209</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4210">
      <a href="#L4210">4210</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@l_margin</span> -= <span class="integer">5</span> / <span class="integer">2</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4211">
      <a href="#L4211">4211</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4212">
      <a href="#L4212">4212</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@x</span> = <span class="instance-variable">@l_margin</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4213">
      <a href="#L4213">4213</a>
    </th>
    <td class="line-code">
      <pre>                                Ln() <span class="keyword">if</span> <span class="instance-variable">@quote_count</span> == <span class="integer">0</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4214">
      <a href="#L4214">4214</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4215">
      <a href="#L4215">4215</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">ul</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">ol</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4216">
      <a href="#L4216">4216</a>
    </th>
    <td class="line-code">
      <pre>                          <span class="instance-variable">@li_count</span> -= <span class="integer">1</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4217">
      <a href="#L4217">4217</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@li_state</span> == <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4218">
      <a href="#L4218">4218</a>
    </th>
    <td class="line-code">
      <pre>                                        Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4219">
      <a href="#L4219">4219</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="instance-variable">@li_state</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4220">
      <a href="#L4220">4220</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4221">
      <a href="#L4221">4221</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4222">
      <a href="#L4222">4222</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">li</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4223">
      <a href="#L4223">4223</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@li_spacer</span> = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4224">
      <a href="#L4224">4224</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> <span class="instance-variable">@li_state</span> == <span class="predefined-constant">true</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4225">
      <a href="#L4225">4225</a>
    </th>
    <td class="line-code">
      <pre>                                        Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4226">
      <a href="#L4226">4226</a>
    </th>
    <td class="line-code">
      <pre>                                  <span class="instance-variable">@li_state</span> = <span class="predefined-constant">false</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4227">
      <a href="#L4227">4227</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4228">
      <a href="#L4228">4228</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4229">
      <a href="#L4229">4229</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">when</span> <span class="string"><span class="delimiter">'</span><span class="content">h1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h3</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h4</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h5</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h6</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4230">
      <a href="#L4230">4230</a>
    </th>
    <td class="line-code">
      <pre>                                SetFontSize(<span class="instance-variable">@tempfontsize</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4231">
      <a href="#L4231">4231</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@tempfontsize</span> = <span class="instance-variable">@font_size_pt</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4232">
      <a href="#L4232">4232</a>
    </th>
    <td class="line-code">
      <pre>                                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4233">
      <a href="#L4233">4233</a>
    </th>
    <td class="line-code">
      <pre>                                Ln();
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4234">
      <a href="#L4234">4234</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="instance-variable">@lasth</span> = <span class="instance-variable">@font_size</span> * <span class="class-variable">@@k_cell_height_ratio</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4235">
      <a href="#L4235">4235</a>
    </th>
    <td class="line-code">
      <pre>                                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4236">
      <a href="#L4236">4236</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h1</span><span class="delimiter">'</span></span> <span class="keyword">or</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span> <span class="keyword">or</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h3</span><span class="delimiter">'</span></span> <span class="keyword">or</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h4</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4237">
      <a href="#L4237">4237</a>
    </th>
    <td class="line-code">
      <pre>                                        margin = <span class="integer">1</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4238">
      <a href="#L4238">4238</a>
    </th>
    <td class="line-code">
      <pre>                                        hrWidth = <span class="instance-variable">@w</span> - <span class="instance-variable">@l_margin</span> - <span class="instance-variable">@r_margin</span> - margin;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4239">
      <a href="#L4239">4239</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">if</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h1</span><span class="delimiter">'</span></span> <span class="keyword">or</span> tag == <span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4240">
      <a href="#L4240">4240</a>
    </th>
    <td class="line-code">
      <pre>                                                SetLineWidth(<span class="float">0.2</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4241">
      <a href="#L4241">4241</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4242">
      <a href="#L4242">4242</a>
    </th>
    <td class="line-code">
      <pre>                                                SetLineWidth(<span class="float">0.1</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4243">
      <a href="#L4243">4243</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4244">
      <a href="#L4244">4244</a>
    </th>
    <td class="line-code">
      <pre>                                        Line(<span class="instance-variable">@x</span> + margin, <span class="instance-variable">@y</span>, <span class="instance-variable">@x</span> + hrWidth, <span class="instance-variable">@y</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4245">
      <a href="#L4245">4245</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4246">
      <a href="#L4246">4246</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4247">
      <a href="#L4247">4247</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4248">
      <a href="#L4248">4248</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4249">
      <a href="#L4249">4249</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4250">
      <a href="#L4250">4250</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Sets font style.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4251">
      <a href="#L4251">4251</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :tag tag name (in lowercase)</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4252">
      <a href="#L4252">4252</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param boolean :enable</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4253">
      <a href="#L4253">4253</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4254">
      <a href="#L4254">4254</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4255">
      <a href="#L4255">4255</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">SetStyle</span>(tag, enable)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4256">
      <a href="#L4256">4256</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Modify style and select corresponding font</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4257">
      <a href="#L4257">4257</a>
    </th>
    <td class="line-code">
      <pre>                [<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">i</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">d</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |s|
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4258">
      <a href="#L4258">4258</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">if</span> tag.downcase == s
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4259">
      <a href="#L4259">4259</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">if</span> enable
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4260">
      <a href="#L4260">4260</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@style</span> &lt;&lt; s <span class="keyword">if</span> ! <span class="instance-variable">@style</span>.include?(s)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4261">
      <a href="#L4261">4261</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4262">
      <a href="#L4262">4262</a>
    </th>
    <td class="line-code">
      <pre>                                        <span class="instance-variable">@style</span> = <span class="instance-variable">@style</span>.gsub(s,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4263">
      <a href="#L4263">4263</a>
    </th>
    <td class="line-code">
      <pre>                                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4264">
      <a href="#L4264">4264</a>
    </th>
    <td class="line-code">
      <pre>                        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4265">
      <a href="#L4265">4265</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4266">
      <a href="#L4266">4266</a>
    </th>
    <td class="line-code">
      <pre>                SetFont(<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>, <span class="instance-variable">@style</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4267">
      <a href="#L4267">4267</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4268">
      <a href="#L4268">4268</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4269">
      <a href="#L4269">4269</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4270">
      <a href="#L4270">4270</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Output anchor link.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4271">
      <a href="#L4271">4271</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :url link URL</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4272">
      <a href="#L4272">4272</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :name link name</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4273">
      <a href="#L4273">4273</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :fill Indicates if the cell background must be painted (1) or transparent (0). Default value: 0.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4274">
      <a href="#L4274">4274</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access public</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4275">
      <a href="#L4275">4275</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4276">
      <a href="#L4276">4276</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">addHtmlLink</span>(url, name, fill=<span class="integer">0</span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4277">
      <a href="#L4277">4277</a>
    </th>
    <td class="line-code">
      <pre>                <span class="comment">#Put a hyperlink</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4278">
      <a href="#L4278">4278</a>
    </th>
    <td class="line-code">
      <pre>                SetTextColor(<span class="integer">0</span>, <span class="integer">0</span>, <span class="integer">255</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4279">
      <a href="#L4279">4279</a>
    </th>
    <td class="line-code">
      <pre>                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4280">
      <a href="#L4280">4280</a>
    </th>
    <td class="line-code">
      <pre>                Write(<span class="instance-variable">@lasth</span>, name, url, fill);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4281">
      <a href="#L4281">4281</a>
    </th>
    <td class="line-code">
      <pre>                SetStyle(<span class="string"><span class="delimiter">'</span><span class="content">u</span><span class="delimiter">'</span></span>, <span class="predefined-constant">false</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4282">
      <a href="#L4282">4282</a>
    </th>
    <td class="line-code">
      <pre>                SetTextColor(<span class="integer">0</span>);
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4283">
      <a href="#L4283">4283</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4284">
      <a href="#L4284">4284</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4285">
      <a href="#L4285">4285</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4286">
      <a href="#L4286">4286</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Returns an associative array (keys: R,G,B) from </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4287">
      <a href="#L4287">4287</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># a hex html code (e.g. #3FE5AA).</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4288">
      <a href="#L4288">4288</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param string :color hexadecimal html color [#rrggbb]</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4289">
      <a href="#L4289">4289</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return array</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4290">
      <a href="#L4290">4290</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4291">
      <a href="#L4291">4291</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4292">
      <a href="#L4292">4292</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">convertColorHexToDec</span>(color = <span class="string"><span class="delimiter">&quot;</span><span class="content">#000000</span><span class="delimiter">&quot;</span></span>)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4293">
      <a href="#L4293">4293</a>
    </th>
    <td class="line-code">
      <pre>                tbl_color = {}
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4294">
      <a href="#L4294">4294</a>
    </th>
    <td class="line-code">
      <pre>                tbl_color[<span class="string"><span class="delimiter">'</span><span class="content">R</span><span class="delimiter">'</span></span>] = color[<span class="integer">1</span>,<span class="integer">2</span>].hex.to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4295">
      <a href="#L4295">4295</a>
    </th>
    <td class="line-code">
      <pre>                tbl_color[<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>] = color[<span class="integer">3</span>,<span class="integer">2</span>].hex.to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4296">
      <a href="#L4296">4296</a>
    </th>
    <td class="line-code">
      <pre>                tbl_color[<span class="string"><span class="delimiter">'</span><span class="content">B</span><span class="delimiter">'</span></span>] = color[<span class="integer">5</span>,<span class="integer">2</span>].hex.to_i;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4297">
      <a href="#L4297">4297</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> tbl_color;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4298">
      <a href="#L4298">4298</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4299">
      <a href="#L4299">4299</a>
    </th>
    <td class="line-code">
      <pre>        
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4300">
      <a href="#L4300">4300</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4301">
      <a href="#L4301">4301</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Converts pixels to millimeters in 72 dpi.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4302">
      <a href="#L4302">4302</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param int :px pixels</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4303">
      <a href="#L4303">4303</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return float millimeters</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4304">
      <a href="#L4304">4304</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @access private</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4305">
      <a href="#L4305">4305</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4306">
      <a href="#L4306">4306</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">pixelsToMillimeters</span>(px)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4307">
      <a href="#L4307">4307</a>
    </th>
    <td class="line-code">
      <pre>                <span class="keyword">return</span> px.to_f * <span class="float">25.4</span> / <span class="integer">72</span>;
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4308">
      <a href="#L4308">4308</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4309">
      <a href="#L4309">4309</a>
    </th>
    <td class="line-code">
      <pre>                
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4310">
      <a href="#L4310">4310</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4311">
      <a href="#L4311">4311</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Reverse function for htmlentities.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4312">
      <a href="#L4312">4312</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># Convert entities in UTF-8.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4313">
      <a href="#L4313">4313</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4314">
      <a href="#L4314">4314</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @param :text_to_convert Text to convert.</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4315">
      <a href="#L4315">4315</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment"># @return string converted</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4316">
      <a href="#L4316">4316</a>
    </th>
    <td class="line-code">
      <pre>        <span class="comment">#</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4317">
      <a href="#L4317">4317</a>
    </th>
    <td class="line-code">
      <pre>        <span class="keyword">def</span> <span class="function">unhtmlentities</span>(string)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4318">
      <a href="#L4318">4318</a>
    </th>
    <td class="line-code">
      <pre>          <span class="keyword">if</span> <span class="class-variable">@@decoder</span>.nil?
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4319">
      <a href="#L4319">4319</a>
    </th>
    <td class="line-code">
      <pre>      <span class="constant">CGI</span>.unescapeHTML(string)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4320">
      <a href="#L4320">4320</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">else</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4321">
      <a href="#L4321">4321</a>
    </th>
    <td class="line-code">
      <pre>            <span class="class-variable">@@decoder</span>.decode(string)
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4322">
      <a href="#L4322">4322</a>
    </th>
    <td class="line-code">
      <pre>    <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4323">
      <a href="#L4323">4323</a>
    </th>
    <td class="line-code">
      <pre>  <span class="keyword">end</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4324">
      <a href="#L4324">4324</a>
    </th>
    <td class="line-code">
      <pre>  
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4325">
      <a href="#L4325">4325</a>
    </th>
    <td class="line-code">
      <pre><span class="keyword">end</span> <span class="comment"># END OF CLASS</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4326">
      <a href="#L4326">4326</a>
    </th>
    <td class="line-code">
      <pre>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4327">
      <a href="#L4327">4327</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#TODO 2007-05-25 (EJM) Level=0 - </span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4328">
      <a href="#L4328">4328</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#Handle special IE contype request</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4329">
      <a href="#L4329">4329</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># if (!_SERVER['HTTP_USER_AGENT'].nil? and (_SERVER['HTTP_USER_AGENT']=='contype'))</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4330">
      <a href="#L4330">4330</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#         header('Content-Type: application/pdf');</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4331">
      <a href="#L4331">4331</a>
    </th>
    <td class="line-code">
      <pre><span class="comment">#         exit;</span>
</pre>
    </td>
  </tr>
  

  <tr>
    <th class="line-num" id="L4332">
      <a href="#L4332">4332</a>
    </th>
    <td class="line-code">
      <pre><span class="comment"># }</span>
</pre>
    </td>
  </tr>
  

</tbody>
</table>
</div>




        
        <div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>

<!-- Mirrored from redmine.ogf.org/projects/redmine-og/repository/revisions/e210c5613f4fa5a344165d062f2eedcec48fbab0/entry/vendor/plugins/rfpdf/lib/tcpdf.rb by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 13 Oct 2022 17:43:19 GMT -->
</html>
