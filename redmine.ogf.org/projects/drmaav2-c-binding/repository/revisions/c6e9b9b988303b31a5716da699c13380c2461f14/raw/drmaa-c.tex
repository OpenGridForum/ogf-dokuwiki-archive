% save trees by replacing OGF-mandated 12pt with 10pt
\documentclass{article}

\sloppy

% OGF-defined document template stuff
\usepackage{ifpdf}
\usepackage[utf8]{inputenc}
\usepackage{ifthen}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage[pdfborder={0 0 0}]{hyperref}
\usepackage{url}
\usepackage{authblk}
\usepackage[numbers]{natbib}
\bibliographystyle{plainnat}
\usepackage[sf,compact]{titlesec}
\usepackage[titles]{tocloft}
\usepackage{parskip}
\newcommand{\headerstyle}{\sffamily}
\usepackage{fancyhdr}
\addtolength{\headheight}{15pt}
\renewcommand{\headrulewidth}{0pt}
\setlength{\headsep}{20pt}
\usepackage[headings]{fullpage}
\graphicspath{{img/}{./}}
\renewcommand{\cftsecfont}{\sffamily}
\renewcommand{\cftsubsecfont}{\sffamily}
\renewcommand{\cftsubsubsecfont}{\sffamily}
\renewcommand{\cftsecpagefont}{\sffamily}
\renewcommand{\cftsubsecpagefont}{\sffamily}
\renewcommand{\cftsubsubsecpagefont}{\sffamily}
\renewcommand{\cftsecleader}{\cftdotfill{\cftsubsecdotsep}}
\setlength{\cftbeforesecskip}{0.5ex}
\newcommand{\ifnonempty}[2]{\ifthenelse{\isundefined{#1}}{}{\ifthenelse{\equal{#1}{}}{}{#2}}}
\pagestyle{fancyplain}
\fancyhf{}
\lhead{\fancyplain{}{\headerstyle\docseries}}
\rhead{\fancyplain{}{\headerstyle\ifthenelse{\isundefined{\revisiondate}}{\publicationdate}{\ifthenelse{\equal{\revisiondate}{}}{\publicationdate}{\revisiondate}}}}
\lfoot{\headerstyle\ifnonempty{\groupurl}{\groupurl}}
\rfoot{\headerstyle\thepage}
\thispagestyle{plain}

% OGF-defined meta data
\title{Distributed Resource Management Application API Version 2 (DRMAA) -\\C Language Binding}
\newcommand{\shortdoctitle}{DRMAA}
\newcommand{\authorsshort}{Peter Tröger, TU Chemnitz\footnotemark[1]\\Roger Brobst, Cadence Design Systems\\Daniel Gruber, Univa\footnotemark[1]\\Mariusz Mamoński, PSNC\\Andre Merzky, LSU}
\newcommand{\publicationdate}{November 2012}
\newcommand{\revisiondate}{July 2015}
\newcommand{\copyrightyears}{2012-2015}
\newcommand{\docseries}{GFD-R-P.198}  % GWD-R, GWD-I or GWD-C (for working drafts), GFD-I, GFD-R, or GFD-C
\newcommand{\groupname}{DRMAA-WG}
\newcommand{\groupurl}{\href{mailto:drmaa-wg@ogf.org}{drmaa-wg@ogf.org}}
\newcommand{\documenturl}{\href{http://www.drmaa.org/}}

% Our additional Latex stuff
\usepackage{todonotes}
\usepackage{listings}
\usepackage{tabularx}
\lstset{language=C, tabsize=2, keywordstyle=\bfseries, basicstyle=\ttfamily\scriptsize,  rangeprefix=////,rangesuffix=////,includerangemarker=false}
\newcommand{\h}[1]{\texttt{#1}}
\setcounter{tocdepth}{2}
\usepackage{csquotes}

%%%%%%%% Enable this block for the annotaed version
%\newcommand{\rat}[1]{ {\tiny(See footnote)}\footnote{#1} }
%\interfootnotelinepenalty=10000
%\newcommand{\tbd}[2][] {\todo[caption={#2}, size=\small, #1]{\renewcommand{\baselinestretch}{0.5}\selectfont#2\par}}
%\usepackage{lineno}
%\linenumbers
%%%%%%% Enable this block for the official version
\newcommand{\rat}[1]{}
\newcommand{\tbd}[2][] {}

\begin{document}

% OGF-defined title page rendering
{\noindent
\begin{minipage}[t]{3.0in}
\headerstyle
\docseries \\
\ifnonempty{\groupname}{\groupname \\}
\ifnonempty{\groupurl}{\groupurl \\}
\ifnonempty{\documenturl}{\documenturl \\}
\end{minipage}
\hfill
\raggedleft
\begin{minipage}[t]{3.0in}
\raggedleft
\headerstyle
\authorsshort \\
\publicationdate \\
\ifnonempty{\revisiondate}{Revised \revisiondate \\}
\end{minipage}
}

\begin{center}
\makeatletter
\Large\bf\textsf \@title
\makeatother
\end{center}

\vspace*{1em}
\subsection*{Status of This Document}

OGF Proposed Recommendation (GFD-R-P.198)\\

\rat{
This is the non-normative annotated version of the specification with line numbers. It includes historical information concerning the content and why features were included or discarded by the working group. It also emphasizes the consequences of some aspects that may not be immediately apparent. This document in only intended for internal working group discussions.
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% End of header, insert content below this line
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{Document Change History}
\vspace*{-1em}
\begin{table}[ht]
\centering
\begin{tabularx}{\textwidth}{XX}
\toprule
\emph{Date} & \emph{Notes} \\
\midrule
April     26th, 2012 & Submission to OGF Editor \\
September  4th, 2012 & Updates from public comment period \\
November   4th, 2012 & Publication as  GFD-R-P.198 \\
Juli      15th, 2015 & Document revision, see Annex \ref{sec:errata} \\
\bottomrule
\end{tabularx}
\end{table}
\vspace*{1em}


\subsection*{Copyright Notice}

Copyright \copyright \ Open Grid Forum (\copyrightyears).  Some Rights Reserved.
Distribution is unlimited.\\

\subsection*{Trademark}

All company, product or service names referenced in this document are used for identification purposes only and may be trademarks of their respective owners. \\

\section*{Abstract}

This document describes the C language binding for the \emph{Distributed Resource Management Application API Version 2 (DRMAA)}. The intended audience for this specification are DRMAA implementors. \\

\footnotetext[1]{Corresponding authors}
\newpage

\subsection*{Notational Conventions}
\label{sec:rfc2119}

In this document, C language elements and definitions are represented in a \h{fixed-width} font. 

The key words \enquote{MUST} \enquote{MUST NOT}, \enquote{REQUIRED}, \enquote{SHALL}, \enquote{SHALL NOT}, \enquote{SHOULD}, \enquote{SHOULD NOT}, \enquote{RECOMMENDED}, \enquote{MAY},  and \enquote{OPTIONAL} are to be interpreted as described in RFC 2119~\cite{rfc2119}. 

\newpage
\tableofcontents
\newpage

\section{Introduction}
\label{sec:introduction}

 The \emph{Distributed Resource Management Application API Version 2 (DRMAA)} specification defines an interface for tightly coupled, but still portable access to the majority of DRM systems. The scope is limited to job submission, job control, reservation management, and retrieval of job and machine monitoring information. 

The \emph{DRMAA root specification} \cite{gfd194} describes the abstract API concepts and the behavioral rules of a compliant implementation, while this document standardizes the representation of API concepts in the C programming language.

\section{General Design}
\label{sec:concepts}

Implementation-specific header informations MUST be stored in a file called \h{drmaa2\_impl.h}, which is included by the standardized header file. The \h{drmaa2.h} header file SHOULD remain unmodified accross different implementations.

The mapping of DRMAA root specification concepts to C follows a set of design principles. Implementation-specific extensions of the DRMAA C API SHOULD follow these conventions:

\begin{itemize}
\item Namespacing of the DRMAA API, as demanded by by the root specification, is realized with the \h{drmaa2\_} prefix for lower- and upper-case identifiers.
\item In identifier naming, "\h{job}" is shortened as "\h{j}" and "\h{reservation}" is shortened as "\h{r}" for improved readability.
\item The root specification demands a consistent parameter passing strategy for non-scalar values. All such values are passed as call-by-reference parameter in the C binding.
\item Structs and enums are typedef'ed for better readability.
\item Struct types have an \h{\_s} suffix with their name. Structures with a non-standardized layout are defined as forward references for the DRMAA library implementation. \rat{This avoids the usage of void* pointers, f.e. with dictionaries and lists.}
\item Functions with IDL return type \h{void} have \h{drmaa2\_error} as return type.
\item The IDL \h{boolean} type maps to the \h{drmaa2\_bool} type.
\item The IDL  \h{long} type maps to \h{long long} in C. One exception is the \h{exitStatus} variable, which is defined as \h{int} in order to provide a more natural mapping to existing operating system interfaces.
\item The IDL \h{string} type is mapped in two different ways. Attributes and parameters with string values typically created by the implementation are mapped to the \h{drmaa2\_string} type. The application frees such memory by calling the newly introduced function \h{drmaa2\_string\_free}. All other string parameters are mapped to the \h{const char *} type. Implementations MUST accept calls to \h{drmaa2\_string\_free} for all string pointers, regardless of their type. \rat{This means that even if the implementation returns string literal pointers at some occasions, \h{drmaa2\_string\_free} SHALL not fail for this. This may be realized by avoiding string literal pointers at all, or by maintaining a list of malloced pointers.}
\item The language binding defines one UNSET macro per utilized C data type (\h{DRMAA2\_UNSET\_*}). \rat{For UNSET values, the language binding adheres mainly to typical language conventions and not to GLUE as recommended in the root spec.}
\item The language binding defines separate \h{UNSET} members for each enumeration, to avoid C compiler complains when using a common UNSET value for enumerations. Their values MUST all equal to \h{DRMAA2\_UNSET\_ENUM}, so that both variants can be used.
\item  All numerical types are signed, in order to support \h{-1} as numerical UNSET value.
\item Both \h{AbsoluteTime} and \h{TimeAmount} map directly to \h{time\_t}. RFC 822 support as mandated by the root specification is given by the \h{\%z} formatter for \h{sprintf}.
\item Multiple output parameters are realized by declaring all but one of them as pointer variable. For this reason, the \h{substate} parameter in \h{drmaa2\_j\_get\_state} SHALL be interpreted as pointer to a string variable created by the DRMAA library.
\item The \h{const} declarator is used to mark parameters declared as \h{readonly} in the root specification.
\item The two string list types in DRMAA, ordered and unordered, are mapped to one ordered list with the \h{DRMAA2\_STRING\_LIST} type.
\item The \h{any} member for job sub-state information is defined as \h{drmaa2\_string} to achieve application portability.
\end{itemize}

Application-created structs should be allocated by the additional support methods (such as \h{drmaa2\_jinfo\_create}) to realize the necessary initialization to UNSET. This SHOULD be properly documented by the implementation.

The following structures are only used in result values. For this reason, the according allocation functions are not part of the API:

\begin{itemize}
\item \h{drmaa2\_string}
\item \h{drmaa2\_slotinfo}
\item \h{drmaa2\_rinfo}
\item \h{drmaa2\_notification}
\item \h{drmaa2\_queueinfo}
\item \h{drmaa2\_version}
\item \h{drmaa2\_machineinfo}
\end{itemize}

The interface membership of a function is sometimes expressed by an additional prefix, as shown in Table \ref{tab:naming}.

\begin{table}[ht]
\centering
\begin{tabularx}{\textwidth}{|X|X|l|X|}
\hline
DRMAA interface & C binding prefix \\
\hline
\h{DrmaaReflective} & \h{drmaa2\_} \\
\h{SessionManager} & \h{drmaa2\_} \\
\h{JobSession} & \h{drmaa2\_jsession\_} \\
\h{ReservationSession} & \h{drmaa2\_rsession\_} \\
\h{MonitoringSession}  & \h{drmaa2\_msession\_} \\
\h{Reservation} & \h{drmaa2\_r\_} \\
\h{Job} & \h{drmaa2\_j\_} \\
\h{JobArray} & \h{drmaa2\_jarray\_} \\
\h{JobTemplate} & \h{drmaa2\_jtemplate\_} \\
\h{ReservationTemplate} & \h{drmaa2\_rtemplate\_} \\
\hline
\end{tabularx}
\caption{Mapping of DRMAA interface name to C method prefix}
\label{tab:naming}
\end{table}

The C binding specifies the function pointer type \h{drmaa2\_callback} for a notification callback function. This represents the \h{DrmaaCallback} interface from the root specification. The new constant value \h{DRMAA2\_UNSET\_CALLBACK} can be used by the application for the de-registration of callback functions.

\subsection{Error Handling}

The list of exceptions in the DRMAA root specification is mapped to the new enumeration \h{drmaa2\_error}. The enumeration member \h{DRMAA2\_LASTERROR} is intended to ensure application portability while allowing additional implementation-specific error codes. It MUST always be the enumeration member with the highest value.

The language binding adds two new functions for fetching error number and error message of the last error that occurred: \h{drmaa2\_lasterror} and \h{drmaa2\_lasterror\_text}. These functions MUST operate in a thread-safe manner, meaning that both error informations are managed per application thread by the DRMAA implementation.

\subsection{Resource Limits}
\label{sec:resourcelimittype}

The DRMAA2 root specification demands the definition of a set of string constants, declared in the header file:

\begin{verbatim}
extern const char *const DRMAA2_CORE_FILE_SIZE;
extern const char *const DRMAA2_CPU_TIME;
extern const char *const DRMAA2_DATA_SIZE;
extern const char *const DRMAA2_FILE_SIZE;
extern const char *const DRMAA2_OPEN_FILES;
extern const char *const DRMAA2_STACK_SIZE;
extern const char *const DRMAA2_VIRTUAL_MEMORY;
extern const char *const DRMAA2_WALLCLOCK_TIME;
\end{verbatim}

The implementation part MUST initialize these variables as follows:

\begin{verbatim}
const char *const DRMAA2_CORE_FILE_SIZE = "CORE_FILE_SIZE";
const char *const DRMAA2_CPU_TIME = "DRMAA2_CPU_TIME";
const char *const DRMAA2_DATA_SIZE = "DRMAA2_DATA_SIZE";
const char *const DRMAA2_FILE_SIZE = "DRMAA2_FILE_SIZE";
const char *const DRMAA2_OPEN_FILES = "DRMAA2_OPEN_FILES";
const char *const DRMAA2_STACK_SIZE = "DRMAA2_STACK_SIZE";
const char *const DRMAA2_VIRTUAL_MEMORY = "DRMAA2_VIRTUAL_MEMORY";
const char *const DRMAA2_WALLCLOCK_TIME = "DRMAA2_WALLCLOCK_TIME";
\end{verbatim}

\subsection{Lists and Dictionaries}

The C language binding adds generic support functions for the collection data types used by the root specification. The newly defined \h{drmaa2\_lasterror} and \h{drmaa2\_lasterror\_text} functions MUST return according error information for these operations.

\rat{The definition of list operations in the language binding keeps the application code portable. The original DRMAA error codes are good enough to support them, there is no need for additional ones. DRMAA dictionaries are only used for strings, so we make the dictionary interface less general.}

Both \h{drmaa2\_list\_create} and \h{drmaa2\_dict\_create} have an optional parameter \h{callback}. It allows the application or the implementation to store a callback pointer to an element cleanup function. It MUST be allowed for the application to provide \h{DRMAA2\_UNSET\_CALLBACK} instead of a valid callback pointer. The implementation MUST provide a default callback implementation for all list and dictionary types. This can be used by both the application and the implementation itself.

The following list operations are defined:

\begin{description}
\item[\h{drmaa2\_list\_create}:] Creates a new list instance for the specified type of items. Returns a pointer to the list or NULL on error.
\item[\h{drmaa2\_list\_free}:] Frees the list and the contained members. If a callback function was provided on list creation, it SHALL be called once per list item.
\item[\h{drmaa2\_list\_get}:] Gets the list element at the indicated position. The element index starts at zero. If the index is invalid, the function returns NULL.
\item[\h{drmaa2\_list\_add}:] Adds a new item at the end of the list and returns a success indication. The list MUST contain only the provided pointer, not a deep copy of the provided data structure.
\item[\h{drmaa2\_list\_del}:] Removes the list element at the indicated position and returns a success indication. If a callback function was provided on list creation, it SHALL be called before this function returns.
\item[\h{drmaa2\_list\_size}:] Returns the number of elements in the list. If the list is empty, then the function returns 0, which SHALL NOT be treated as an error case.
\end{description}

Similarly, a set of new functions for dictionary handling is introduced:

\begin{description}
\item[\h{drmaa2\_dict\_create}:] Creates a new dictionary instance. Returns a pointer to the dictionary or NULL on error.
\item[\h{drmaa2\_dict\_free}:] Frees the dictionary and the contained members. If a callback function was provided on dictionary creation, it SHALL be called once per dictionary entry.
\item[\h{drmaa2\_dict\_list}:] Gets all dictionary keys as DRMAA \h{drmaa2\_string\_list}. If the dictionary is empty, a valid string list with zero elements SHALL be returned. The application is expected to use \h{drmaa2\_list\_free} for freeing the returned data structure.
\item[\h{drmaa2\_dict\_has}:] Returns a boolean indication if the given key exists in the dictionary. On error, the function SHALL return FALSE.
\item[\h{drmaa2\_dict\_get}:] Gets the dictionary value for the specified key. If the key is invalid, the function returns NULL.
\item[\h{drmaa2\_dict\_del}:] Removes the dictionary entry with the given key and returns a success indication. If a callback function was provided on dictionary creation, it SHALL be called before this function returns.
\item[\h{drmaa2\_dict\_set}:] Sets the specified dictionary key to the specified value. Key and value strings MUST be stored as the provided character pointers. If the dictionary already has an entry for this name, the value is replaced and the old value is removed. If a callback was provided on dictionary creation, it SHALL be called with a NULL pointer for the key and the pointer of the previous value.

\end{description}

\section{Memory Management}
\label{sec:memorymanagement}

The majority of data structures returned by an implementation is newly created on the heap. All those structures need to be freed by a call to the according counterpart function (\h{drmaa2\_*\_free}) by the application. This should be clearly indicated in the end-user documentation, otherwise memory leaks may occur.

\rat{The deallocation functions are needed to make sure that the allocating entity (the library) also performs the freeing operation. This is needed for cases where the DRMAA library is compiled with a different heap allocator than the DRMAA-based application. It is mainly a problem with Windows-based implementations.}

The following functions are expected to return only pointers to existing data, which demands no subsequent freeing of the returned data:

\begin{itemize}
	\item \h{drmaa2\_dict\_get}
	\item \h{drmaa2\_list\_get}
	\item \h{drmaa2\_jsession\_wait\_any\_started}
	\item \h{drmaa2\_jsession\_wait\_any\_terminated}
\end{itemize}

The following functions, when successfully executed, return newly allocated data. Their results must either be free directly, or indirectly be freeing the surrounding wrapper structure.

Implementations MAY register their matching default callback for the returned data structure:

\begin{itemize}
	\item \h{drmaa2\_get\_drms\_name}
	\item \h{drmaa2\_get\_drms\_version}
	\item \h{drmaa2\_describe\_attribute }
	\item \h{drmaa2\_dict\_create}
	\item \h{drmaa2\_dict\_list }
	\item \h{drmaa2\_get\_instance\_value}
	\item \h{drmaa2\_get\_jsession\_names}
	\item \h{drmaa2\_get\_rsession\_names}
	\item \h{drmaa2\_jarray\_get\_id}
	\item \h{drmaa2\_jarray\_get\_jobs}
	\item \h{drmaa2\_jarray\_get\_jtemplate}
	\item \h{drmaa2\_jarray\_get\_session\_name}
	\item \h{drmaa2\_j\_get\_id}
	\item \h{drmaa2\_j\_get\_info}
	\item \h{drmaa2\_j\_get\_get\_jt}
	\item \h{drmaa2\_j\_get\_session\_name}
	\item \h{drmaa2\_jinfo\_create}
	\item \h{drmaa2\_jinfo\_impl\_spec}
	\item \h{drmaa2\_jsession\_get\_contact}
	\item \h{drmaa2\_jsession\_get\_jarray}
	\item \h{drmaa2\_jsession\_get\_job\_categories}
	\item \h{drmaa2\_jsession\_get\_jobs}
	\item \h{drmaa2\_jsession\_get\_session\_name}
	\item \h{drmaa2\_jsession\_run\_bulk\_jobs}
	\item \h{drmaa2\_jsession\_run\_job}
	\item \h{drmaa2\_jtemplate\_create}
	\item \h{drmaa2\_jtemplate\_impl\_spec}
	\item \h{drmaa2\_lasterror\_text}
	\item \h{drmaa2\_list\_create}
	\item \h{drmaa2\_machineinfo\_impl\_spec}
	\item \h{drmaa2\_msession\_get\_all\_jobs}
	\item \h{drmaa2\_msession\_get\_all\_machines}
	\item \h{drmaa2\_msession\_get\_all\_queues}
	\item \h{drmaa2\_msession\_get\_all\_reservations}
	\item \h{drmaa2\_notification\_impl\_spec}
	\item \h{drmaa2\_open\_jsession}
	\item \h{drmaa2\_open\_msession}
	\item \h{drmaa2\_open\_rsession}
	\item \h{drmaa2\_queueinfo\_impl\_spec}
	\item \h{drmaa2\_rinfo\_impl\_spec}
	\item \h{drmaa2\_rtemplate\_impl\_spec}
\end{itemize}

\section{Implementation-specific Extensions}
\label{sec:implspec}

The DRMAA root specification allows the product-specific extension of the DRMAA API in a standardized way.

New methods added to a DRMAA implementation SHOULD follow the conventions from Section \ref{sec:concepts}.

New attributes SHOULD use a product-specific prefix for a clear separation of non-portable and portable parts of the API. The \h{struct} definitions in \h{drmaa2.h} SHALL remain unmodified in all cases. Therefore, these attributes are expected to only be accessible through \h{drmaa2\_get\_instance\_value} and \h{drmaa2\_set\_instance\_value}. Implementations can store their specific additional attributes behind the standardized \h{implementationSpecific} pointer in \h{drmaa2\_jinfo\_s}, \h{drmaa2\_rinfo\_s}, \h{drmaa2\_slotinfo\_s}, \h{drmaa2\_jtemplate\_s}, \h{drmaa2\_rtemplate\_s}, \h{drmaa2\_notification\_s}, \h{drmaa2\_queueinfo\_s}, \h{drmaa2\_version\_s}, and \h{drmaa2\_machineinfo\_s}.

\section{Complete Header File}
\label{sec:idl}

The following text shows the complete C header file for the DRMAAv2 application programming interface. DRMAA-compliant C libraries MUST declare all functions and data structures described here. Implementations MAY add custom parts in adherence to the extensibility principles of this specification and the root specification.

The source file is also available at \url{http://www.drmaa.org}.

\lstinputlisting{drmaa2.h}

\section{Security Considerations}
\label{sec:security}

The DRMAA root specification \cite{gfd194}  describes the behavioral aspects of a standard-compliant implementation. This includes also security aspects.

Software written in C language has well-known security attack vectors, especially with memory handling. Implementors MUST clarify in their documentation which kind of memory management is expected by the application. Implementations MUST also consider the possibility for multi-threaded applications performing re-entrant calls to the library. The root specification clarifies some of these scenarios.

\newpage

\section{Contributors}

\textbf{Roger Brobst}\\
Cadence Design Systems, Inc.\\
555 River Oaks Parkway \\
San Jose, CA 95134, United States\\
Email: rbrobst@cadence.com\\

\textbf{Daniel Gruber}\\
Univa GmbH\\
c/o Rüter und Partner\\
Prielmayerstr. 3\\
80335 München, Germany\\
Email: dgruber@univa.com\\

\textbf{Mariusz Mamoński}\\
Poznań Supercomputing and Networking Center\\
ul. Noskowskiego 10\\
61-704 Poznań, Poland\\
Email: mamonski@man.poznan.pl\\

\textbf{Andre Merzky}\\
Center for Computation and Technology\\
Louisiana State University\\
216 Johnston Hall\\
70803 Baton Rouge,  Louisiana, USA\\
Email:  andre@merzky.net\\

\textbf{Peter Tröger (Corresponding Author)} \\
TU Chemnitz\\
Email: peter@troeger.eu \\

Special thanks go to \emph{Stefan Klauck (Hasso Plattner Institute)} for the DRMAA C binding reference implementation and the  debugging of the implementation-related language binding issues.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Insert content above this line
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Intellectual Property Statement}

 The OGF takes no position regarding the validity or scope of any
 intellectual property or other rights that might be claimed to
 pertain to the implementation or use of the technology described in
 this document or the extent to which any license under such rights
 might or might not be available; neither does it represent that it
 has made any effort to identify any such rights.  Copies of claims of
 rights made available for publication and any assurances of licenses
 to be made available, or the result of an attempt made to obtain a
 general license or permission for the use of such proprietary rights
 by implementers or users of this specification can be obtained from
 the OGF Secretariat.

 The OGF invites any interested party to bring to its attention any
 copyrights, patents or patent applications, or other proprietary
 rights which may cover technology that may be required to practice
 this recommendation.  Please address the information to the OGF
 Executive Director.


\section{Disclaimer}

 This document and the information contained herein is provided on an
 ``As Is'' basis and the OGF disclaims all warranties, express or
 implied, including but not limited to any warranty that the use of
 the information herein will not infringe any rights or any implied
 warranties of merchantability or fitness for a particular purpose.


\section{Full Copyright Notice}

 Copyright \copyright \ Open Grid Forum (\copyrightyears). Some Rights
 Reserved.

 This document and translations of it may be copied and furnished to
 others, and derivative works that comment on or otherwise explain it
 or assist in its implementation may be prepared, copied, published
 and distributed, in whole or in part, without restriction of any
 kind, provided that the above copyright notice and this paragraph are
 included as references to the derived portions on all such copies and
 derivative works. The published OGF document from which such works
 are derived, however, may not be modified in any way, such as by
 removing the copyright notice or references to the OGF or other
 organizations, except as needed for the purpose of developing new or
 updated OGF documents in conformance with the procedures defined in
 the OGF Document Process, or as required to translate it into
 languages other than English. OGF, with the approval of its board,
 may remove this restriction for inclusion of OGF document content for
 the purpose of producing standards in cooperation with other
 international standards bodies.

 The limited permissions granted above are perpetual and will not be
 revoked by the OGF or its successors or assignees.


% \phantomsection\addcontentsline{toc}{section}{References}
\section{References}
\renewcommand{\refname}{}
\vspace*{-3em}
\bibliography{bibliography}

\newpage
\appendix

\section{Errata (July 2015)}
\label{sec:errata}

The following changes were applied in the July 2015 revision of this document:

\subsection*{General}

The author affiliations and dates were updated.

Section \ref{sec:memorymanagement} was introduced to describe the rules of memory management from the application point of view. This fixes Issue \#115 and \#104.

\subsection*{API changes}

\subsubsection*{Issue \#59}

The numeric parameters of \lstinline{drmaa2_jsession_run_bulk_jobs} are now \lstinline{const}.

The \lstinline{pos} parameter of \lstinline{drmaa2_list_del} ist now \lstinline{const}.

The \lstinline{pos} parameter of \lstinline{drmaa2_list_get} ist now \lstinline{const}.

This modification is backward-compatible.

\subsubsection*{Issue \#57}

\lstinline{drmaa2_limit} needed to be removed, since (numeric) enumeration members cannot become keys in dictionaries. Instead, a set of according constants was introduced, as explained in the newly introduced Section \ref{sec:resourcelimittype}. The text also explains how these constants must be initialized by the implementation code.

\rat{The issue text further discusses why the extern const approach was favoured over a simple macro definition. The main reason is convinience for C++ people.}

This modification is not backward-compatible, since the original version was not implementable.

\subsubsection*{Issue \#116}

\h{drmaa2\_dict\_default\_callback} and a set of default list callbacks were introduced.

This modification is backward-compatible.

\subsubsection*{Issue \#160, \#162}

All \h{struct} definitions got an additional \h{implementationSpecific} member. It is intended to store the implementation-specific attributes, as now explained in Section \ref{sec:implspec}.

In order to support a standardized inclusion of such extensions, without modifying \h{drmaa2.h}, the file now contains an \h{\#include \"drmaa2\_impl.h\"} statement. Section \ref{sec:introduction} was updated accordingly.

This modification is not backward-compatible, since the \h{drmaa2.h} header file changes. All relevant implementations are already updated.

\subsubsection*{Issue \#255}

All enumerations got an additional \h{UNSET} value. The motivation is now explained in \ref{sec:introduction}.

\h{drmaa2\_listtype} was completed with numeric defaults, similar to the other enumerations.

This modification is backward-compatible for the known implementations and their compilers.

\subsubsection*{Issue \#113}

\h{drmaa2\_get\_all\_machines()} returns a list of \h{drmaa2\_machineinfo\_s} instances, which contains a pointer to a \h{drmaa2\_version\_s} struct.

This demanded the addition of \h{DRMA2\_UNSET\_VERSION}.

This modification is backward-compatible.

\subsubsection*{Issue \#165}

The \h{allocatedMachines} attribute in \h{drmaa2\_jinfo\_s} has now the type \h{drmaa2\_slotinfo\_list}, in accordance to the root specification.

\subsubsection*{Issue \#114}

For consistency reasons, the following renaming took place:

\begin{itemize}
	\item \h{drmaa2\_jarray\_get\_job\_template} becomes \h{drmaa2\_jarray\_get\_jtemplate}
	\item \h{drmaa2\_j\_get\_jt} becomes \h{drmaa2\_j\_get\_jtemplate}
\end{itemize}

This modification is not backward-compatible, since the \h{drmaa2.h} header file changes. All relevant implementations are already updated.

\subsubsection*{Issue \#63}

All numerical types are signed, in order to support -1 as numerical \h{UNSET} value. For this reason, the numerical parameters of \h{drmaa2\_jsession\_run\_bulk\_jobs} were changed to \h{long long}

This modification is not backward-compatible, since the \h{drmaa2.h} header file changes. All relevant implementations are already updated.

\subsubsection*{Issue \#163}

The two new functions \h{drmaa2\_j\_reap} and \h{drmaa2\_jarray\_reap} were introduced, in accordance to the July 2015 errata of the root specification.

\subsubsection*{Issue \#102}

The July 2015 root specification errata adds \h{jobName} to the \h{JobInfo} structure, which is now also reflected in \h{drmaa2\_jinfo\_s}.

This modification is not backward-compatible, since the \h{drmaa2.h} header file changes. All relevant implementations are already updated.

\end{document}