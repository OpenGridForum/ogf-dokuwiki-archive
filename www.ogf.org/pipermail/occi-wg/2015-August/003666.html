<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 
<!-- Mirrored from www.ogf.org/pipermail/occi-wg/2015-August/003666.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Sep 2022 21:16:08 GMT -->
<HEAD>
   <TITLE> [occi-wg] Typed Link Kind
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:occi-wg%40ogf.org?Subject=Re%3A%20%5Bocci-wg%5D%20Typed%20Link%20Kind&In-Reply-To=%3C1438598764.3876.45.camel%40free.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003665.html">
   <LINK REL="Next"  HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[occi-wg] Typed Link Kind</H1>
    <B>Jean Parpaillon</B> 
    <A HREF="mailto:occi-wg%40ogf.org?Subject=Re%3A%20%5Bocci-wg%5D%20Typed%20Link%20Kind&In-Reply-To=%3C1438598764.3876.45.camel%40free.fr%3E"
       TITLE="[occi-wg] Typed Link Kind">jean.parpaillon at free.fr
       </A><BR>
    <I>Mon Aug  3 06:46:04 EDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003665.html">[occi-wg] opencontainers/specs
</A></li>
        <LI>Next message: <A HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003667.html">[occi-wg] Typed Link Kind
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/date.html#3666">[ date ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/thread.html#3666">[ thread ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/subject.html#3666">[ subject ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/author.html#3666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Boris,

Le vendredi 31 juillet 2015 &#224; 23:08 +0200, Boris Parak a &#233;crit :
&gt;<i> On Fri, Jul 31, 2015 at 5:01 PM, Jean Parpaillon
</I>&gt;<i> &lt;<A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">jean.parpaillon at free.fr</A>&gt; wrote:
</I>&gt;<i> &gt; Hi Boris,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Le vendredi 31 juillet 2015 &#224; 11:48 +0200, Boris Parak a &#233;crit :
</I>&gt;<i> &gt; &gt; Hi Jean,
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; On Fri, Jul 31, 2015 at 10:49 AM, Jean Parpaillon
</I>&gt;<i> &gt; &gt; &lt;<A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">jean.parpaillon at free.fr</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; Hi all,
</I>&gt;<i> &gt; &gt; &gt; With Olivier Barais, in CC, with which I am working on the 
</I>&gt;<i> &gt; &gt; &gt; OCCIware
</I>&gt;<i> &gt; &gt; &gt; project, we would like to enhance the core specification with a 
</I>&gt;<i> &gt; &gt; &gt; way
</I>&gt;<i> &gt; &gt; &gt; to
</I>&gt;<i> &gt; &gt; &gt; constrain the Category of resources pointed out by 
</I>&gt;<i> &gt; &gt; &gt; occi.core.src
</I>&gt;<i> &gt; &gt; &gt; and
</I>&gt;<i> &gt; &gt; &gt; occi.core.target attributes of a link.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; For instance, in the infrastructure extension, while it is
</I>&gt;<i> &gt; &gt; &gt; specified
</I>&gt;<i> &gt; &gt; &gt; (and easily make sense) a NetworkInterface link must be linked 
</I>&gt;<i> &gt; &gt; &gt; to a
</I>&gt;<i> &gt; &gt; &gt; compute and a network instance, there is no formal way to 
</I>&gt;<i> &gt; &gt; &gt; define
</I>&gt;<i> &gt; &gt; &gt; this
</I>&gt;<i> &gt; &gt; &gt; constraint.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; A proposal would be to add new type of Category, sub-type of 
</I>&gt;<i> &gt; &gt; &gt; Kind,
</I>&gt;<i> &gt; &gt; &gt; with
</I>&gt;<i> &gt; &gt; &gt; following attributes:
</I>&gt;<i> &gt; &gt; &gt; - parent: instantiated as <A HREF="http://schemas.ogf.org/occi/core#link">http://schemas.ogf.org/occi/core#link</A>
</I>&gt;<i> &gt; &gt; &gt; - occi.core.src.type: additional attribute, type category id
</I>&gt;<i> &gt; &gt; &gt; - occi.core.target.type: additional attribute, type category id
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; The name of this type of Category could be &quot;TypedLinkKind&quot;.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; What do you think of this ?
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; at first glance, it looks like a reasonable request ... it would
</I>&gt;<i> &gt; &gt; definitely improve automated validation and modeling in OCCI.
</I>&gt;<i> &gt; &gt; Especially with previously unknown extensions.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 'occi.core.target' will be a bit problematic, because it can 
</I>&gt;<i> &gt; &gt; point
</I>&gt;<i> &gt; &gt; &quot;outside&quot; the local domain. But we could easily cover that by 
</I>&gt;<i> &gt; &gt; making
</I>&gt;<i> &gt; &gt; these attributes optional.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; So, I would consider dropping the TypedLinkKind and include these 
</I>&gt;<i> &gt; &gt; two
</I>&gt;<i> &gt; &gt; attributes in the existing Link kind, as optional. That way we 
</I>&gt;<i> &gt; &gt; get a
</I>&gt;<i> &gt; &gt; typed link, partially typed link and &quot;legacy&quot; link all-in-one. 
</I>&gt;<i> &gt; &gt; While
</I>&gt;<i> &gt; &gt; keeping it all backwards compatible. If the type attribute is
</I>&gt;<i> &gt; &gt; present,
</I>&gt;<i> &gt; &gt; you can use it, if not ... well ... you are out of luck :-)
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; As a side note, I would very much like to avoid introducing 
</I>&gt;<i> &gt; &gt; attribute
</I>&gt;<i> &gt; &gt; names with matching prefixes:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; occi.core.target = &quot;value&quot;
</I>&gt;<i> &gt; &gt; occi.core.target.type = &quot;value&quot;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; This makes JSON rendering really difficult. Would you be OK with
</I>&gt;<i> &gt; &gt; &quot;target_type&quot; &amp; &quot;source_type&quot;?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I would prefer the former one, but I can accept the second one.
</I>&gt;<i> 
</I>&gt;<i> I know ... 'target.type' makes more sense and is much prettier to 
</I>&gt;<i> look at.
</I>&gt;<i> 
</I>&gt;<i> &gt; BTW, here is the algortihm I use for inserting any dot-separated
</I>&gt;<i> &gt; attribute name into the JSON tree of attributes, would you be
</I>&gt;<i> &gt; interested in implementing it into rocci:
</I>&gt;<i> &gt; <A HREF="https://github.com/erocci/erocci/blob/master/apps/erocci_core/src/r">https://github.com/erocci/erocci/blob/master/apps/erocci_core/src/r</A>
</I>&gt;<i> &gt; ende
</I>&gt;<i> &gt; ring/occi_renderer_json.erl#L194
</I>&gt;<i> 
</I>&gt;<i> I have to admit that my basic understanding of functional languages 
</I>&gt;<i> is
</I>&gt;<i> a problem here :-)
</I>
The occi_rendering_json.code file contains a &quot;pseudo-code&quot; version of
the algorithm, without pattern matching, which is maybe what's
confusion there. 

&gt;<i> 
</I>&gt;<i> How do you deal with complex attribute values? Let's say we have an 
</I>&gt;<i> attribute
</I>&gt;<i> 
</I>&gt;<i> occi.test.target = { ... Hash Here ... } // hash has &quot;type&quot; =&gt;
</I>&gt;<i> &quot;StringHere&quot; inside it
</I>&gt;<i> 
</I>&gt;<i> and an attribute
</I>&gt;<i> 
</I>&gt;<i> occi.test.target.type = &quot;StringHere&quot;
</I>&gt;<i> 
</I>&gt;<i> How would you distinguish between the value for key 'type' in the
</I>&gt;<i> attribute value (Hash) of 'occi.test.target' and the attribute value
</I>&gt;<i> of 'occi.test.target.type'? How would these be rendered in JSON
</I>&gt;<i> together?
</I>
I suppose it is related in some way to the discussion we've had in
January 2014 ;)
<A HREF="https://www.ogf.org/pipermail/occi-wg/2014-January/003438.html">https://www.ogf.org/pipermail/occi-wg/2014-January/003438.html</A>

You will find in attachment an XML description of such complex
attributes with the JSON output from erocci. Would you like to test
other cases, you can use the erocci docker, as described here,
replacing occi.xml with your own schema (like ext1.xml in attachment):
<A HREF="https://github.com/erocci/docker-erocci">https://github.com/erocci/docker-erocci</A>

Rendering the JSON is fine with the above algorithm. Parsing is
unambiguous but parsing may be tough to implement: 
- when parsing the attribute definition, if &quot;type&quot; value is a string,
it is the type of the attribute, if &quot;type&quot; value is an object, it is a
component of the attribute name.
- when parsing the attribute instance, &quot;type&quot; can be only an attribute
name component.

At the end, implementation concerns may be a valid reason for
forbidding some attribute names, but we must explicit it in the
specification.

&gt;<i> 
</I>&gt;<i> Could you give me the rendered JSON as an example?
</I>
See attachment.

&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Also, could you, please, include this as a comment here [1], then 
</I>&gt;<i> &gt; &gt; we
</I>&gt;<i> &gt; &gt; can discuss it as a part of public comment on OCCI 1.2 and 
</I>&gt;<i> &gt; &gt; possibly
</I>&gt;<i> &gt; &gt; include it :-)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Done, last minute before end of comments ;)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Thanks!
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; You're welcome.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Jean
</I>&gt;<i> 
</I>&gt;<i> Cheers, Boris
</I>
Cheers,
Jean


&gt;<i> 
</I>&gt;<i> &gt; &gt; [1] <A HREF="https://redmine.ogf.org/boards/26/topics/429">https://redmine.ogf.org/boards/26/topics/429</A>
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Regards,
</I>&gt;<i> &gt; &gt; &gt; --
</I>&gt;<i> &gt; &gt; &gt; Jean Parpaillon
</I>&gt;<i> &gt; &gt; &gt; --
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Cheers, Boris
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Open Source Consultant
</I>&gt;<i> &gt; &gt; &gt; OW2 Technology Council Chairman
</I>&gt;<i> &gt; &gt; &gt; Director @ OW2 Consortium
</I>&gt;<i> &gt; &gt; &gt; OCCIware Strategic Orientation Committee Chairman
</I>&gt;<i> &gt; &gt; &gt; Research Engineer @ Inria
</I>&gt;<i> &gt; &gt; &gt; --
</I>&gt;<i> &gt; &gt; &gt; Phone: +33 6 30 10 92 86
</I>&gt;<i> &gt; &gt; &gt; im: <A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">jean.parpaillon at gmail.com</A>
</I>&gt;<i> &gt; &gt; &gt; skype: jean.parpaillon
</I>&gt;<i> &gt; &gt; &gt; linkedin: <A HREF="http://www.linkedin.com/in/jeanparpaillon/en">http://www.linkedin.com/in/jeanparpaillon/en</A>
</I>&gt;<i> &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; occi-wg mailing list
</I>&gt;<i> &gt; &gt; &gt; <A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">occi-wg at ogf.org</A>
</I>&gt;<i> &gt; &gt; &gt; <A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">https://www.ogf.org/mailman/listinfo/occi-wg</A>
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Jean Parpaillon
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Open Source Consultant
</I>&gt;<i> &gt; OW2 Technology Council Chairman
</I>&gt;<i> &gt; Director @ OW2 Consortium
</I>&gt;<i> &gt; OCCIware Strategic Orientation Committee Chairman
</I>&gt;<i> &gt; Research Engineer @ Inria
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Phone: +33 6 30 10 92 86
</I>&gt;<i> &gt; im: <A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">jean.parpaillon at gmail.com</A>
</I>&gt;<i> &gt; skype: jean.parpaillon
</I>&gt;<i> &gt; linkedin: <A HREF="http://www.linkedin.com/in/jeanparpaillon/en">http://www.linkedin.com/in/jeanparpaillon/en</A>
</I>-- 
Jean Parpaillon
--
Open Source Consultant
OW2 Technology Council Chairman
Director @ OW2 Consortium
OCCIware Strategic Orientation Committee Chairman
Research Engineer @ Inria
--
Phone: +33 6 30 10 92 86
im: <A HREF="https://www.ogf.org/mailman/listinfo/occi-wg">jean.parpaillon at gmail.com</A>
skype: jean.parpaillon
linkedin: <A HREF="http://www.linkedin.com/in/jeanparpaillon/en">http://www.linkedin.com/in/jeanparpaillon/en</A>
-------------- next part --------------
$ curl -v -H 'accept: application/json' <A HREF="http://localhost:32770/-/">http://localhost:32770/-/</A>
*   Trying ::1...
* Connected to localhost (::1) port 32770 (#0)
&gt;<i> GET /-/ HTTP/1.1
</I>&gt;<i> Host: localhost:32770
</I>&gt;<i> User-Agent: curl/7.43.0
</I>&gt;<i> accept: application/json
</I>&gt;<i> 
</I>&lt; HTTP/1.1 200 OK
&lt; connection: keep-alive
&lt; date: Mon, 03 Aug 2015 09:24:30 GMT
&lt; content-length: 1187
&lt; server: erocci OCCI/1.1
&lt; content-type: application/json
&lt; vary: accept
&lt; 
{
  &quot;kinds&quot; : [
    {
      &quot;term&quot; : &quot;compute&quot;,
      &quot;scheme&quot; : &quot;<A HREF="http://example.org/occi/#">http://example.org/occi/#</A>&quot;,
      &quot;class&quot; : &quot;kind&quot;,
      &quot;title&quot; : &quot;A Resource Kind&quot;,
      &quot;parent&quot; : &quot;<A HREF="http://schemas.ogf.org/occi/core#resource">http://schemas.ogf.org/occi/core#resource</A>&quot;,
      &quot;attributes&quot; : {
        &quot;occi&quot; : {
          &quot;example&quot; : {
            &quot;attr1&quot; : {
              &quot;mutable&quot; : true,
              &quot;title&quot; : &quot;Attribute 1&quot;,
              &quot;required&quot; : false,
              &quot;type&quot; : &quot;string&quot;
            },
            &quot;attr1&quot; : {
              &quot;type&quot; : {
                &quot;mutable&quot; : true,
                &quot;title&quot; : &quot;Attribute 2&quot;,
                &quot;required&quot; : false,
                &quot;type&quot; : &quot;string&quot;
              }
            },
            &quot;attr2&quot; : {
              &quot;with&quot; : {
                &quot;additionale&quot; : {
                  &quot;namespace&quot; : {
                    &quot;mutable&quot; : true,
                    &quot;title&quot; : &quot;Attribute 1&quot;,
                    &quot;required&quot; : false,
                    &quot;type&quot; : &quot;string&quot;
                  }
                }
              }
            }
          }
        }
      },
      &quot;location&quot; : &quot;<A HREF="http://localhost:32770/collections/compute/">http://localhost:32770/collections/compute/</A>&quot;
    }
  ],
  &quot;mixins&quot; : [
    
  ],
  &quot;actions&quot; : [
    
  ]
}
* Connection #0 to host localhost left intact

-------------- next part --------------
A non-text attachment was scrubbed...
Name: ext1.xml
Type: application/xml
Size: 838 bytes
Desc: not available
URL: &lt;<A HREF="http://www.ogf.org/pipermail/occi-wg/attachments/20150803/abe0dfb0/attachment.xml">http://www.ogf.org/pipermail/occi-wg/attachments/20150803/abe0dfb0/attachment.xml</A>&gt;
-------------- next part --------------
# The function takes as input an attribute name, as a list of name's components,
# and the value of the attribute.
# The accumulator is used for recursion.
#
# It returns the tree representation of the JSON object representing the lsit of attributes
# eg:
#  Given the following attributes:
#  {&quot;occi.example.attr1&quot;, &quot;value1&quot;}
#  {&quot;occi.example.attr2.with.additional.namespace&quot;, &quot;value2&quot;}
#  {&quot;occi.example.attr1.type&quot;, &quot;value3&quot;}
#
#  1/ attributes names are splitted:
#    {[ &quot;occi&quot;, &quot;example&quot;, &quot;attr1&quot; ], &quot;value1&quot;}
#    {[ &quot;occi&quot;, &quot;example&quot;, &quot;attr2&quot;, &quot;with&quot;, &quot;additional&quot;, &quot;namespace&quot; ], &quot;value2&quot;}
#    {[ &quot;occi&quot;, &quot;example&quot;, &quot;attr1&quot;, &quot;type&quot; ], &quot;value3&quot;}
#
#  2/ this pair list is given to insert_attr and should output:
# {[
#    { &quot;occi&quot;, [
#          { &quot;example&quot;, [
#                { &quot;attr1&quot;, &quot;value },
#                { &quot;attr2&quot;, [
#                      { &quot;with&quot;, [
#                          { &quot;additional&quot;, [
#                              {&quot;namespace&quot;, &quot;value2&quot;}
#                             ]}
#                        ]}
#                   ]},
#                { &quot;attr1&quot;, [
#                    { &quot;type&quot;: &quot;value3&quot; }
#                 ]}
#              ]}
#        ]}
#  ]}
#
# This structure of tuple and lists is then transformed into JSON syntax with a pretty
# straightforward algorithm: 
#  { &quot;key&quot;, &quot;value&quot; }  -&gt; &quot;key&quot;: &quot;value&quot;
#  [ {&quot;key1&quot;, &quot;value1&quot;}, {&quot;key2&quot;, &quot;value2&quot;}] -&gt; { &quot;key1&quot;: &quot;value1&quot;, &quot;key2&quot;: &quot;value2&quot; }
# etc.
#

# Name: list of attribute name components
# Value: any object
# Acc: a list of { Key, Value } pairs
function insert_attr(Name, Value, Acc):
  if length(Name) == 1:
    # Last name component, we insert the value
    return prepend({Name, Value}, Acc);

  { ActualNS, Children } = first(Acc);
  if first(Name) == ActualNS:
    # This name component is already present in Acc,
    # insert attribute in the existing tree
    Tree = insert_attr(tail(Name), Value, Children);
    return prepend({Name, Tree}, tail(Acc));
  else:
    # This name component does not exist in Acc,
    # creates a new branch
    Tree = insert_attr(tail(Name), Value, []);
    return prepend({Name, Tree}, Acc);

   
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003665.html">[occi-wg] opencontainers/specs
</A></li>
	<LI>Next message: <A HREF="https://www.ogf.org/pipermail/occi-wg/2015-August/003667.html">[occi-wg] Typed Link Kind
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/date.html#3666">[ date ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/thread.html#3666">[ thread ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/subject.html#3666">[ subject ]</a>
              <a href="https://www.ogf.org/pipermail/occi-wg/2015-August/author.html#3666">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://www.ogf.org/mailman/listinfo/occi-wg">More information about the occi-wg
mailing list</a><br>
</body>
<!-- Mirrored from www.ogf.org/pipermail/occi-wg/2015-August/003666.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Sep 2022 21:16:08 GMT -->
</html>
